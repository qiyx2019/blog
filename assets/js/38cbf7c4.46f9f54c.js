"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8264],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=a.createContext({}),d=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=d(e.components);return a.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},k=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),k=d(n),m=r,s=k["".concat(p,".").concat(m)]||k[m]||u[m]||o;return n?a.createElement(s,i(i({ref:t},c),{},{components:n})):a.createElement(s,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=k;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var d=2;d<o;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}k.displayName="MDXCreateElement"},7773:function(e,t,n){n.r(t),n.d(t,{contentTitle:function(){return p},default:function(){return k},frontMatter:function(){return l},metadata:function(){return d},toc:function(){return c}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=["components"],l={sidebar_position:0,id:"redux.index"},p="Redux \u7b80\u660e\u6559\u7a0b",d={unversionedId:"redux/redux.index",id:"redux/redux.index",title:"Redux \u7b80\u660e\u6559\u7a0b",description:"&sect; Store",source:"@site/docs/redux/README.md",sourceDirName:"redux",slug:"/redux/",permalink:"/blog/docs/redux/",tags:[],version:"current",sidebarPosition:0,frontMatter:{sidebar_position:0,id:"redux.index"},sidebar:"redux",next:{title:"Redux \u8fdb\u9636\u6559\u7a0b",permalink:"/blog/docs/redux/redux.index1"}},c=[{value:"\xa7 Store",id:"-store",children:[],level:2},{value:"\xa7 Action",id:"-action",children:[{value:"\u2299 Action Creator",id:"-action-creator",children:[],level:3}],level:2},{value:"\xa7 Reducer",id:"-reducer",children:[],level:2},{value:"\xa7 \u603b\u7ed3",id:"-\u603b\u7ed3",children:[{value:"\u2299 Redux \u4e0e\u4f20\u7edf\u540e\u7aef MVC \u7684\u5bf9\u7167",id:"-redux-\u4e0e\u4f20\u7edf\u540e\u7aef-mvc-\u7684\u5bf9\u7167",children:[],level:3}],level:2},{value:"\xa7 \u6700\u7b80\u5355\u7684\u4f8b\u5b50",id:"-\u6700\u7b80\u5355\u7684\u4f8b\u5b50",children:[],level:2}],u={toc:c};function k(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"redux-\u7b80\u660e\u6559\u7a0b"},"Redux \u7b80\u660e\u6559\u7a0b"),(0,o.kt)("h2",{id:"-store"},"\xa7"," Store"),(0,o.kt)("p",null,"\u9996\u5148\u8981\u533a\u5206 ",(0,o.kt)("inlineCode",{parentName:"p"},"store")," \u548c ",(0,o.kt)("inlineCode",{parentName:"p"},"state")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"state")," \u662f\u5e94\u7528\u7684\u72b6\u6001\uff0c\u4e00\u822c\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u666e\u901a",(0,o.kt)("strong",{parentName:"p"},"\u5bf9\u8c61"),(0,o.kt)("br",{parentName:"p"}),"\n","\u4f8b\u5982\uff0c\u6211\u4eec\u6709\u4e00\u4e2a Web APP\uff0c\u5305\u542b \u8ba1\u6570\u5668 \u548c \u5f85\u529e\u4e8b\u9879 \u4e24\u5927\u529f\u80fd",(0,o.kt)("br",{parentName:"p"}),"\n","\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4e3a\u8be5\u5e94\u7528\u8bbe\u8ba1\u51fa\u5bf9\u5e94\u7684\u5b58\u50a8\u6570\u636e\u7ed3\u6784\uff08\u5e94\u7528\u521d\u59cb\u72b6\u6001\uff09\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"/** \u5e94\u7528\u521d\u59cb state\uff0c\u672c\u4ee3\u7801\u5757\u8bb0\u4e3a code-1 **/\n{\n  counter: 0,\n  todos: []\n}\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"store")," \u662f\u5e94\u7528\u72b6\u6001 ",(0,o.kt)("inlineCode",{parentName:"p"},"state")," \u7684\u7ba1\u7406\u8005\uff0c\u5305\u542b\u4e0b\u5217\u56db\u4e2a\u51fd\u6570\uff1a"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"getState()                  # \u83b7\u53d6\u6574\u4e2a state")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"dispatch(action)            # \u203b \u89e6\u53d1 state \u6539\u53d8\u7684\u3010\u552f\u4e00\u9014\u5f84\u3011\u203b")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"subscribe(listener)         # \u60a8\u53ef\u4ee5\u7406\u89e3\u6210\u662f DOM \u4e2d\u7684 addEventListener")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"replaceReducer(nextReducer) # \u4e00\u822c\u5728 Webpack Code-Splitting \u6309\u9700\u52a0\u8f7d\u7684\u65f6\u5019\u7528"))),(0,o.kt)("p",null,"\u4e8c\u8005\u7684\u5173\u7cfb\u662f\uff1a",(0,o.kt)("inlineCode",{parentName:"p"},"state === store.getState()")),(0,o.kt)("p",null,"Redux \u89c4\u5b9a\uff0c\u4e00\u4e2a\u5e94\u7528\u53ea\u5e94\u6709\u4e00\u4e2a\u5355\u4e00\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"store"),"\uff0c\u5176\u7ba1\u7406\u7740\u552f\u4e00\u7684\u5e94\u7528\u72b6\u6001 ",(0,o.kt)("inlineCode",{parentName:"p"},"state"),(0,o.kt)("br",{parentName:"p"}),"\n","Redux \u8fd8\u89c4\u5b9a\uff0c\u4e0d\u80fd\u76f4\u63a5\u4fee\u6539\u5e94\u7528\u7684\u72b6\u6001 ",(0,o.kt)("inlineCode",{parentName:"p"},"state"),"\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0b\u9762\u7684\u884c\u4e3a\u662f\u4e0d\u5141\u8bb8\u7684\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"var state = store.getState()\nstate.counter = state.counter + 1 // \u7981\u6b62\u5728\u4e1a\u52a1\u903b\u8f91\u4e2d\u76f4\u63a5\u4fee\u6539 state\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u82e5\u8981\u6539\u53d8 ",(0,o.kt)("inlineCode",{parentName:"strong"},"state"),"\uff0c\u5fc5\u987b ",(0,o.kt)("inlineCode",{parentName:"strong"},"dispatch")," \u4e00\u4e2a ",(0,o.kt)("inlineCode",{parentName:"strong"},"action"),"\uff0c\u8fd9\u662f\u4fee\u6539\u5e94\u7528\u72b6\u6001\u7684\u4e0d\u4e8c\u6cd5\u95e8"),"  "),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u73b0\u5728\u60a8\u53ea\u9700\u8981\u8bb0\u4f4f ",(0,o.kt)("inlineCode",{parentName:"p"},"action")," \u53ea\u662f\u4e00\u4e2a\u5305\u542b ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"type"))," \u5c5e\u6027\u7684\u666e\u901a",(0,o.kt)("strong",{parentName:"p"},"\u5bf9\u8c61"),"\u5373\u53ef",(0,o.kt)("br",{parentName:"p"}),"\n","\u4f8b\u5982 ",(0,o.kt)("inlineCode",{parentName:"p"},"{ type: 'INCREMENT' }"))),(0,o.kt)("p",null,"\u4e0a\u9762\u63d0\u5230\uff0c",(0,o.kt)("inlineCode",{parentName:"p"},"state")," \u662f\u901a\u8fc7 ",(0,o.kt)("inlineCode",{parentName:"p"},"store.getState()")," \u83b7\u53d6\uff0c\u90a3\u4e48 ",(0,o.kt)("inlineCode",{parentName:"p"},"store")," \u53c8\u662f\u600e\u4e48\u6765\u7684\u5462\uff1f",(0,o.kt)("br",{parentName:"p"}),"\n","\u60f3\u751f\u6210\u4e00\u4e2a ",(0,o.kt)("inlineCode",{parentName:"p"},"store"),"\uff0c\u6211\u4eec\u9700\u8981\u8c03\u7528 Redux \u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"createStore"),"\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import { createStore } from 'redux'\n...\nconst store = createStore(reducer, initialState) // store \u662f\u9760\u4f20\u5165 reducer \u751f\u6210\u7684\u54e6\uff01\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u73b0\u5728\u60a8\u53ea\u9700\u8981\u8bb0\u4f4f ",(0,o.kt)("inlineCode",{parentName:"p"},"reducer")," \u662f\u4e00\u4e2a ",(0,o.kt)("strong",{parentName:"p"},"\u51fd\u6570"),"\uff0c\u8d1f\u8d23",(0,o.kt)("strong",{parentName:"p"},"\u66f4\u65b0"),"\u5e76\u8fd4\u56de\u4e00\u4e2a",(0,o.kt)("strong",{parentName:"p"},"\u65b0\u7684")," ",(0,o.kt)("inlineCode",{parentName:"p"},"state"),(0,o.kt)("br",{parentName:"p"}),"\n","\u800c ",(0,o.kt)("inlineCode",{parentName:"p"},"initialState")," \u4e3b\u8981\u7528\u4e8e\u524d\u540e\u7aef\u540c\u6784\u7684\u6570\u636e\u540c\u6b65\uff08\u8be6\u60c5\u8bf7\u5173\u6ce8 React \u670d\u52a1\u7aef\u6e32\u67d3\uff09   ")),(0,o.kt)("h2",{id:"-action"},"\xa7"," Action"),(0,o.kt)("p",null,"\u4e0a\u9762\u63d0\u5230\uff0c",(0,o.kt)("inlineCode",{parentName:"p"},"action"),"\uff08\u52a8\u4f5c\uff09\u5b9e\u8d28\u4e0a\u662f\u5305\u542b ",(0,o.kt)("inlineCode",{parentName:"p"},"type")," \u5c5e\u6027\u7684\u666e\u901a\u5bf9\u8c61\uff0c\u8fd9\u4e2a ",(0,o.kt)("inlineCode",{parentName:"p"},"type")," \u662f\u6211\u4eec\u5b9e\u73b0\u7528\u6237\u884c\u4e3a\u8ffd\u8e2a\u7684\u5173\u952e",(0,o.kt)("br",{parentName:"p"}),"\n","\u4f8b\u5982\uff0c\u589e\u52a0\u4e00\u4e2a\u5f85\u529e\u4e8b\u9879 \u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"action")," \u53ef\u80fd\u662f\u50cf\u4e0b\u9762\u4e00\u6837\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"/** \u672c\u4ee3\u7801\u5757\u8bb0\u4e3a code-2 **/\n{\n  type: 'ADD_TODO',\n  payload: {\n    id: 1,\n    content: '\u5f85\u529e\u4e8b\u98791',\n    completed: false\n  }\n}\n")),(0,o.kt)("p",null,"\u5f53\u7136\uff0c",(0,o.kt)("inlineCode",{parentName:"p"},"action")," \u7684\u5f62\u5f0f\u662f\u591a\u79cd\u591a\u6837\u7684\uff0c\u552f\u4e00\u7684\u7ea6\u675f\u4ec5\u4ec5\u5c31\u662f\u5305\u542b\u4e00\u4e2a ",(0,o.kt)("inlineCode",{parentName:"p"},"type")," \u5c5e\u6027\u7f62\u4e86",(0,o.kt)("br",{parentName:"p"}),"\n","\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0b\u9762\u8fd9\u4e9b ",(0,o.kt)("inlineCode",{parentName:"p"},"action")," \u90fd\u662f\u5408\u6cd5\u7684\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"/** \u5982\u4e0b\u90fd\u662f\u5408\u6cd5\u7684\uff0c\u4f46\u5c31\u662f\u4e0d\u591f\u89c4\u8303 **/\n{\n  type: 'ADD_TODO',\n  id: 1,\n  content: '\u5f85\u529e\u4e8b\u98791',\n  completed: false\n}\n\n{\n  type: 'ADD_TODO',\n  abcdefg: {\n    id: 1,\n    content: '\u5f85\u529e\u4e8b\u98791',\n    completed: false\n  }\n}\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u867d\u8bf4\u6ca1\u6709\u7ea6\u675f\uff0c\u4f46\u6700\u597d\u8fd8\u662f\u9075\u5faa",(0,o.kt)("a",{parentName:"p",href:"https://github.com/acdlite/flux-standard-action"},"\u89c4\u8303"))),(0,o.kt)("p",null,"\u5982\u679c\u9700\u8981\u65b0\u589e\u4e00\u4e2a\u4ee3\u529e\u4e8b\u9879\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u5c06 ",(0,o.kt)("inlineCode",{parentName:"p"},"code-2")," \u4e2d\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"payload")," ",(0,o.kt)("strong",{parentName:"p"},"\u201c\u5199\u5165\u201d")," \u5230 ",(0,o.kt)("inlineCode",{parentName:"p"},"state.todos")," \u6570\u7ec4\u4e2d\uff08\u5982\u4f55\u201c\u5199\u5165\u201d\uff1f\u5728\u6b64\u7559\u4e2a\u60ac\u5ff5\uff09\uff1a  "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"/** \u672c\u4ee3\u7801\u5757\u8bb0\u4e3a code-3 **/\n{\n  counter: 0,\n  todos: [{\n    id: 1,\n    content: '\u5f85\u529e\u4e8b\u98791',\n    completed: false\n  }]\n}\n")),(0,o.kt)("p",null,"\u5228\u6839\u95ee\u5e95\uff0c",(0,o.kt)("inlineCode",{parentName:"p"},"action")," \u662f\u8c01\u751f\u6210\u7684\u5462\uff1f"),(0,o.kt)("h3",{id:"-action-creator"},"\u2299 Action Creator"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Action Creator \u53ef\u4ee5\u662f\u540c\u6b65\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u5f02\u6b65\u7684")),(0,o.kt)("p",null,"\u987e\u540d\u601d\u4e49\uff0cAction Creator \u662f ",(0,o.kt)("inlineCode",{parentName:"p"},"action")," \u7684\u521b\u9020\u8005\uff0c\u672c\u8d28\u4e0a\u5c31\u662f\u4e00\u4e2a",(0,o.kt)("strong",{parentName:"p"},"\u51fd\u6570"),"\uff0c\u8fd4\u56de\u503c\u662f\u4e00\u4e2a ",(0,o.kt)("inlineCode",{parentName:"p"},"action"),"\uff08",(0,o.kt)("strong",{parentName:"p"},"\u5bf9\u8c61"),"\uff09",(0,o.kt)("br",{parentName:"p"}),"\n","\u4f8b\u5982\u4e0b\u9762\u5c31\u662f\u4e00\u4e2a \u201c\u65b0\u589e\u4e00\u4e2a\u5f85\u529e\u4e8b\u9879\u201d \u7684 Action Creator\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"/** \u672c\u4ee3\u7801\u5757\u8bb0\u4e3a code-4 **/\nvar id = 1\nfunction addTodo(content) {\n  return {\n    type: 'ADD_TODO',\n    payload: {\n      id: id++,\n      content: content, // \u5f85\u529e\u4e8b\u9879\u5185\u5bb9\n      completed: false  // \u662f\u5426\u5b8c\u6210\u7684\u6807\u8bc6\n    }\n  }\n}\n")),(0,o.kt)("p",null,"\u5c06\u8be5\u51fd\u6570\u5e94\u7528\u5230\u4e00\u4e2a\u8868\u5355\uff08\u5047\u8bbe ",(0,o.kt)("inlineCode",{parentName:"p"},"store")," \u4e3a\u5168\u5c40\u53d8\u91cf\uff0c\u5e76\u5f15\u5165\u4e86 jQuery \uff09\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},"\x3c!-- \u672c\u4ee3\u7801\u5757\u8bb0\u4e3a code-5 --\x3e\n<input type=\"text\" id=\"todoInput\" />\n<button id=\"btn\">\u63d0\u4ea4</button>\n\n<script>\n$('#btn').on('click', function() {\n  var content = $('#todoInput').val() // \u83b7\u53d6\u8f93\u5165\u6846\u7684\u503c\n  var action = addTodo(content) // \u6267\u884c Action Creator \u83b7\u5f97 action\n  store.dispatch(action) // \u6539\u53d8 state \u7684\u4e0d\u4e8c\u6cd5\u95e8\uff1adispatch \u4e00\u4e2a action\uff01\uff01\uff01\n})\n<\/script>\n")),(0,o.kt)("p",null,"\u5728\u8f93\u5165\u6846\u4e2d\u8f93\u5165 \u201c\u5f85\u529e\u4e8b\u98792\u201d \u540e\uff0c\u70b9\u51fb\u4e00\u4e0b\u63d0\u4ea4\u6309\u94ae\uff0c\u6211\u4eec\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"state")," \u5c31\u53d8\u6210\u4e86\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"/** \u672c\u4ee3\u7801\u5757\u8bb0\u4e3a code-6 **/\n{\n  counter: 0,\n  todos: [{\n    id: 1,\n    content: '\u5f85\u529e\u4e8b\u98791',\n    completed: false\n  }, {\n    id: 2,\n    content: '\u5f85\u529e\u4e8b\u98792',\n    completed: false\n  }]\n}\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u901a\u4fd7\u70b9\u8bb2\uff0cAction Creator \u7528\u4e8e\u7ed1\u5b9a\u5230\u7528\u6237\u7684\u64cd\u4f5c\uff08\u70b9\u51fb\u6309\u94ae\u7b49\uff09\uff0c\u5176\u8fd4\u56de\u503c ",(0,o.kt)("inlineCode",{parentName:"p"},"action")," \u7528\u4e8e\u4e4b\u540e\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"dispatch(action)"))),(0,o.kt)("p",null,"\u521a\u521a\u63d0\u5230\u8fc7\uff0c",(0,o.kt)("inlineCode",{parentName:"p"},"action")," \u660e\u660e\u5c31\u6ca1\u6709\u5f3a\u5236\u7684\u89c4\u8303\uff0c\u4e3a\u4ec0\u4e48 ",(0,o.kt)("inlineCode",{parentName:"p"},"store.dispatch(action)")," \u4e4b\u540e\uff0c",(0,o.kt)("br",{parentName:"p"}),"\n","Redux \u4f1a\u660e\u786e\u77e5\u9053\u662f\u63d0\u53d6 ",(0,o.kt)("inlineCode",{parentName:"p"},"action.payload"),"\uff0c\u5e76\u4e14\u662f\u5bf9\u5e94\u5199\u5165\u5230 ",(0,o.kt)("inlineCode",{parentName:"p"},"state.todos")," \u6570\u7ec4\u4e2d\uff1f",(0,o.kt)("br",{parentName:"p"}),"\n","\u53c8\u662f\u8c01\u8d1f\u8d23\u201c\u5199\u5165\u201d\u7684\u5462\uff1f\u60ac\u5ff5\u5373\u5c06\u63ed\u6653..."),(0,o.kt)("h2",{id:"-reducer"},"\xa7"," Reducer"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Reducer \u5fc5\u987b\u662f\u540c\u6b65\u7684\u7eaf\u51fd\u6570  ")),(0,o.kt)("p",null,"\u7528\u6237\u6bcf\u6b21 ",(0,o.kt)("inlineCode",{parentName:"p"},"dispatch(action)")," \u540e\uff0c\u90fd\u4f1a\u89e6\u53d1 ",(0,o.kt)("inlineCode",{parentName:"p"},"reducer"),"  \u7684\u6267\u884c",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("inlineCode",{parentName:"p"},"reducer")," \u7684\u5b9e\u8d28\u662f\u4e00\u4e2a",(0,o.kt)("strong",{parentName:"p"},"\u51fd\u6570"),"\uff0c\u6839\u636e ",(0,o.kt)("inlineCode",{parentName:"p"},"action.type")," \u6765",(0,o.kt)("strong",{parentName:"p"},"\u66f4\u65b0")," ",(0,o.kt)("inlineCode",{parentName:"p"},"state")," \u5e76\u8fd4\u56de ",(0,o.kt)("inlineCode",{parentName:"p"},"nextState"),(0,o.kt)("br",{parentName:"p"}),"\n","\u6700\u540e\u4f1a\u7528 ",(0,o.kt)("inlineCode",{parentName:"p"},"reducer")," \u7684\u8fd4\u56de\u503c ",(0,o.kt)("inlineCode",{parentName:"p"},"nextState")," ",(0,o.kt)("strong",{parentName:"p"},"\u5b8c\u5168\u66ff\u6362\u6389"),"\u539f\u6765\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"state")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u6ce8\u610f\uff1a\u4e0a\u9762\u7684\u8fd9\u4e2a \u201c\u66f4\u65b0\u201d \u5e76\u4e0d\u662f\u6307 ",(0,o.kt)("inlineCode",{parentName:"p"},"reducer")," \u53ef\u4ee5\u76f4\u63a5\u5bf9 ",(0,o.kt)("inlineCode",{parentName:"p"},"state")," \u8fdb\u884c\u4fee\u6539",(0,o.kt)("br",{parentName:"p"}),"\n","Redux \u89c4\u5b9a\uff0c\u987b\u5148\u590d\u5236\u4e00\u4efd ",(0,o.kt)("inlineCode",{parentName:"p"},"state"),"\uff0c\u5728\u526f\u672c ",(0,o.kt)("inlineCode",{parentName:"p"},"nextState")," \u4e0a\u8fdb\u884c\u4fee\u6539\u64cd\u4f5c",(0,o.kt)("br",{parentName:"p"}),"\n","\u4f8b\u5982\uff0c\u53ef\u4ee5\u4f7f\u7528 lodash \u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"cloneDeep"),"\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 ",(0,o.kt)("inlineCode",{parentName:"p"},"Object.assign / map / filter/ ...")," \u7b49\u8fd4\u56de\u526f\u672c\u7684\u51fd\u6570")),(0,o.kt)("p",null,"\u5728\u4e0a\u9762 Action Creator \u4e2d\u63d0\u5230\u7684 \u5f85\u529e\u4e8b\u9879\u7684 ",(0,o.kt)("inlineCode",{parentName:"p"},"reducer")," \u5927\u6982\u662f\u957f\u8fd9\u4e2a\u6837\u5b50 (\u4e3a\u4e86\u5bb9\u6613\u7406\u89e3\uff0c\u5728\u6b64\u4e0d\u4f7f\u7528 ES6 / ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/facebook/immutable-js"},"Immutable.js"),")\uff1a"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"/** \u672c\u4ee3\u7801\u5757\u8bb0\u4e3a code-7 **/\nvar initState = {\n  counter: 0,\n  todos: []\n}\n\nfunction reducer(state, action) {\n  // \u203b \u5e94\u7528\u7684\u521d\u59cb\u72b6\u6001\u662f\u5728\u7b2c\u4e00\u6b21\u6267\u884c reducer \u65f6\u8bbe\u7f6e\u7684 \u203b\n  if (!state) state = initState\n  \n  switch (action.type) {\n    case 'ADD_TODO':\n      var nextState = _.cloneDeep(state) // \u7528\u5230\u4e86 lodash \u7684\u6df1\u514b\u9686\n      nextState.todos.push(action.payload) \n      return nextState\n\n    default:\n    // \u7531\u4e8e nextState \u4f1a\u628a\u539f state \u6574\u4e2a\u66ff\u6362\u6389\n    // \u82e5\u65e0\u4fee\u6539\uff0c\u5fc5\u987b\u8fd4\u56de\u539f state\uff08\u5426\u5219\u5c31\u662f undefined\uff09\n      return state\n  }\n}\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u901a\u4fd7\u70b9\u8bb2\uff0c\u5c31\u662f ",(0,o.kt)("inlineCode",{parentName:"p"},"reducer")," \u8fd4\u56de\u5565\uff0c",(0,o.kt)("inlineCode",{parentName:"p"},"state")," \u5c31\u88ab\u66ff\u6362\u6210\u5565")),(0,o.kt)("h2",{id:"-\u603b\u7ed3"},"\xa7"," \u603b\u7ed3"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"store")," \u7531 Redux \u7684 ",(0,o.kt)("inlineCode",{parentName:"li"},"createStore(reducer)")," \u751f\u6210"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"state")," \u901a\u8fc7 ",(0,o.kt)("inlineCode",{parentName:"li"},"store.getState()")," \u83b7\u53d6\uff0c\u672c\u8d28\u4e0a\u4e00\u822c\u662f\u4e00\u4e2a\u5b58\u50a8\u7740\u6574\u4e2a\u5e94\u7528\u72b6\u6001\u7684",(0,o.kt)("strong",{parentName:"li"},"\u5bf9\u8c61")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"action")," \u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u5305\u542b ",(0,o.kt)("inlineCode",{parentName:"li"},"type")," \u5c5e\u6027\u7684\u666e\u901a",(0,o.kt)("strong",{parentName:"li"},"\u5bf9\u8c61"),"\uff0c\u7531 Action Creator (",(0,o.kt)("strong",{parentName:"li"},"\u51fd\u6570"),") \u4ea7\u751f"),(0,o.kt)("li",{parentName:"ul"},"\u6539\u53d8 ",(0,o.kt)("inlineCode",{parentName:"li"},"state")," \u5fc5\u987b ",(0,o.kt)("inlineCode",{parentName:"li"},"dispatch")," \u4e00\u4e2a ",(0,o.kt)("inlineCode",{parentName:"li"},"action")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"reducer")," \u672c\u8d28\u4e0a\u662f\u6839\u636e ",(0,o.kt)("inlineCode",{parentName:"li"},"action.type")," \u6765\u66f4\u65b0 ",(0,o.kt)("inlineCode",{parentName:"li"},"state")," \u5e76\u8fd4\u56de ",(0,o.kt)("inlineCode",{parentName:"li"},"nextState")," \u7684",(0,o.kt)("strong",{parentName:"li"},"\u51fd\u6570")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"reducer")," \u5fc5\u987b\u8fd4\u56de\u503c\uff0c\u5426\u5219 ",(0,o.kt)("inlineCode",{parentName:"li"},"nextState")," \u5373\u4e3a ",(0,o.kt)("inlineCode",{parentName:"li"},"undefined")),(0,o.kt)("li",{parentName:"ul"},"\u5b9e\u9645\u4e0a\uff0c",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"state")," \u5c31\u662f\u6240\u6709 ",(0,o.kt)("inlineCode",{parentName:"strong"},"reducer")," \u8fd4\u56de\u503c\u7684\u6c47\u603b"),"\uff08\u672c\u6559\u7a0b\u53ea\u6709\u4e00\u4e2a ",(0,o.kt)("inlineCode",{parentName:"li"},"reducer"),"\uff0c\u4e3b\u8981\u662f\u5e94\u7528\u573a\u666f\u6bd4\u8f83\u7b80\u5355\uff09")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Action Creator => ",(0,o.kt)("inlineCode",{parentName:"p"},"action")," => ",(0,o.kt)("inlineCode",{parentName:"p"},"store.dispatch(action)")," => ",(0,o.kt)("inlineCode",{parentName:"p"},"reducer(state, action)")," => ",(0,o.kt)("del",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"del"},"\u539f state"))," ",(0,o.kt)("inlineCode",{parentName:"p"},"state = nextState"))),(0,o.kt)("h3",{id:"-redux-\u4e0e\u4f20\u7edf\u540e\u7aef-mvc-\u7684\u5bf9\u7167"},"\u2299 Redux \u4e0e\u4f20\u7edf\u540e\u7aef MVC \u7684\u5bf9\u7167"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Redux"),(0,o.kt)("th",{parentName:"tr",align:null},"\u4f20\u7edf\u540e\u7aef MVC"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"store")),(0,o.kt)("td",{parentName:"tr",align:null},"\u6570\u636e\u5e93\u5b9e\u4f8b")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"state")),(0,o.kt)("td",{parentName:"tr",align:null},"\u6570\u636e\u5e93\u4e2d\u5b58\u50a8\u7684\u6570\u636e")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"dispatch(action)")),(0,o.kt)("td",{parentName:"tr",align:null},"\u7528\u6237\u53d1\u8d77\u8bf7\u6c42")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"action: { type, payload }")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"type")," \u8868\u793a\u8bf7\u6c42\u7684 URL\uff0c",(0,o.kt)("inlineCode",{parentName:"td"},"payload")," \u8868\u793a\u8bf7\u6c42\u7684\u6570\u636e")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"reducer")),(0,o.kt)("td",{parentName:"tr",align:null},"\u8def\u7531 + \u63a7\u5236\u5668\uff08handler\uff09")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"reducer")," \u4e2d\u7684 ",(0,o.kt)("inlineCode",{parentName:"td"},"switch-case")," \u5206\u652f"),(0,o.kt)("td",{parentName:"tr",align:null},"\u8def\u7531\uff0c\u6839\u636e ",(0,o.kt)("inlineCode",{parentName:"td"},"action.type")," \u8def\u7531\u5230\u5bf9\u5e94\u7684\u63a7\u5236\u5668")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"reducer")," \u5185\u90e8\u5bf9 ",(0,o.kt)("inlineCode",{parentName:"td"},"state")," \u7684\u5904\u7406"),(0,o.kt)("td",{parentName:"tr",align:null},"\u63a7\u5236\u5668\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u589e\u5220\u6539\u64cd\u4f5c")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"reducer")," \u8fd4\u56de ",(0,o.kt)("inlineCode",{parentName:"td"},"nextState")),(0,o.kt)("td",{parentName:"tr",align:null},"\u5c06\u4fee\u6539\u540e\u7684\u8bb0\u5f55\u5199\u56de\u6570\u636e\u5e93")))),(0,o.kt)("h2",{id:"-\u6700\u7b80\u5355\u7684\u4f8b\u5b50"},"\xa7"," \u6700\u7b80\u5355\u7684\u4f8b\u5b50"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},"<!DOCTYPE html>\n<html>\n<head>\n  <script src=\"//cdn.bootcss.com/redux/3.5.2/redux.min.js\"><\/script>\n</head>\n<body>\n<script>\n/** Action Creators */\nfunction inc() {\n  return { type: 'INCREMENT' };\n}\nfunction dec() {\n  return { type: 'DECREMENT' };\n}\n\nfunction reducer(state, action) {\n  // \u9996\u6b21\u8c03\u7528\u672c\u51fd\u6570\u65f6\u8bbe\u7f6e\u521d\u59cb state\n  state = state || { counter: 0 };\n\n  switch (action.type) {\n    case 'INCREMENT':\n      return { counter: state.counter + 1 };\n    case 'DECREMENT':\n      return { counter: state.counter - 1 };\n    default:\n      return state; // \u65e0\u8bba\u5982\u4f55\u90fd\u8fd4\u56de\u4e00\u4e2a state\n  }\n}\n\nvar store = Redux.createStore(reducer);\n\nconsole.log( store.getState() ); // { counter: 0 }\n\nstore.dispatch(inc());\nconsole.log( store.getState() ); // { counter: 1 }\n\nstore.dispatch(inc());\nconsole.log( store.getState() ); // { counter: 2 }\n\nstore.dispatch(dec());\nconsole.log( store.getState() ); // { counter: 1 }\n<\/script>\n</body>\n</html>\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"\u7531\u4e0a\u53ef\u77e5\uff0cRedux \u5e76\u4e0d\u4e00\u5b9a\u8981\u642d\u914d React \u4f7f\u7528\u3002Redux \u7eaf\u7cb9\u53ea\u662f\u4e00\u4e2a\u72b6\u6001\u7ba1\u7406\u5e93\uff0c\u51e0\u4e4e\u53ef\u4ee5\u642d\u914d\u4efb\u4f55\u6846\u67b6\u4f7f\u7528  ")))}k.isMDXComponent=!0}}]);