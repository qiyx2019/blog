"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7691],{3905:function(e,n,l){l.d(n,{Zo:function(){return c},kt:function(){return m}});var a=l(7294);function t(e,n,l){return n in e?Object.defineProperty(e,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[n]=l,e}function s(e,n){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),l.push.apply(l,a)}return l}function o(e){for(var n=1;n<arguments.length;n++){var l=null!=arguments[n]?arguments[n]:{};n%2?s(Object(l),!0).forEach((function(n){t(e,n,l[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):s(Object(l)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(l,n))}))}return e}function r(e,n){if(null==e)return{};var l,a,t=function(e,n){if(null==e)return{};var l,a,t={},s=Object.keys(e);for(a=0;a<s.length;a++)l=s[a],n.indexOf(l)>=0||(t[l]=e[l]);return t}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)l=s[a],n.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(e,l)&&(t[l]=e[l])}return t}var i=a.createContext({}),p=function(e){var n=a.useContext(i),l=n;return e&&(l="function"==typeof e?e(n):o(o({},n),e)),l},c=function(e){var n=p(e.components);return a.createElement(i.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef((function(e,n){var l=e.components,t=e.mdxType,s=e.originalType,i=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),u=p(l),m=t,k=u["".concat(i,".").concat(m)]||u[m]||d[m]||s;return l?a.createElement(k,o(o({ref:n},c),{},{components:l})):a.createElement(k,o({ref:n},c))}));function m(e,n){var l=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var s=l.length,o=new Array(s);o[0]=u;var r={};for(var i in n)hasOwnProperty.call(n,i)&&(r[i]=n[i]);r.originalType=e,r.mdxType="string"==typeof e?e:t,o[1]=r;for(var p=2;p<s;p++)o[p]=l[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,l)}u.displayName="MDXCreateElement"},1101:function(e,n,l){l.r(n),l.d(n,{contentTitle:function(){return i},default:function(){return u},frontMatter:function(){return r},metadata:function(){return p},toc:function(){return c}});var a=l(7462),t=l(3366),s=(l(7294),l(3905)),o=["components"],r={},i="\u91cd\u5b66webpack",p={unversionedId:"webpack/second",id:"webpack/second",title:"\u91cd\u5b66webpack",description:"1\u3011\u5165\u53e3\u51fa\u53e3\u914d\u7f6e",source:"@site/docs/webpack/second.md",sourceDirName:"webpack",slug:"/webpack/second",permalink:"/blog/docs/webpack/second",tags:[],version:"current",frontMatter:{},sidebar:"webpack",previous:{title:"webpack\uff1a\u4f18\u5316\u6253\u5305CSS\u6587\u4ef6",permalink:"/blog/docs/webpack/2018-10-10-webpack-css-extract"}},c=[{value:"1\u3011\u5165\u53e3\u51fa\u53e3\u914d\u7f6e",id:"1\u5165\u53e3\u51fa\u53e3\u914d\u7f6e",children:[],level:2},{value:"2\u3011loader",id:"2loader",children:[{value:"babel-loader",id:"babel-loader",children:[{value:"\u600e\u4e48\u5728webpack\u4e2d\u4f7f\u7528babel\u5462?",id:"\u600e\u4e48\u5728webpack\u4e2d\u4f7f\u7528babel\u5462",children:[],level:5},{value:"\u4f7f\u7528babel-polyfill\uff08\u57ab\u7247\uff09\u8865\u5145ES6\u4ee3\u7801\u7684\u5b9e\u73b0",id:"\u4f7f\u7528babel-polyfill\u57ab\u7247\u8865\u5145es6\u4ee3\u7801\u7684\u5b9e\u73b0",children:[],level:5}],level:3},{value:"file-loader",id:"file-loader",children:[],level:3},{value:"url-loader",id:"url-loader",children:[],level:3},{value:"css-loader\u3001style-loader",id:"css-loaderstyle-loader",children:[],level:3},{value:"sass-loader\u3001less-loader\u3001postcss-loader",id:"sass-loaderless-loaderpostcss-loader",children:[],level:3},{value:"cssModule\u542f\u7528",id:"cssmodule\u542f\u7528",children:[{value:"\u652f\u6301<code>css module</code>\u6a21\u5f0f\u548c\u666e\u901a\u6a21\u5f0f\u6df7\u7528",id:"\u652f\u6301css-module\u6a21\u5f0f\u548c\u666e\u901a\u6a21\u5f0f\u6df7\u7528",children:[],level:4}],level:3},{value:"file-loader\u6253\u5305\u5b57\u4f53\u56fe\u6807",id:"file-loader\u6253\u5305\u5b57\u4f53\u56fe\u6807",children:[],level:3},{value:"\u5b9e\u73b0\u4e00\u4e2ababel-loader\uff1a",id:"\u5b9e\u73b0\u4e00\u4e2ababel-loader",children:[{value:"\u6b65\u9aa4\u4e00\uff1a",id:"\u6b65\u9aa4\u4e00",children:[],level:4},{value:"\u6b65\u9aa4\u4e8c\uff1a",id:"\u6b65\u9aa4\u4e8c",children:[],level:4}],level:3}],level:2},{value:"3\u3011SourceMap",id:"3sourcemap",children:[{value:"\u5f00\u542fSourceMap",id:"\u5f00\u542fsourcemap",children:[],level:4},{value:"\u914d\u7f6eSourceMap",id:"\u914d\u7f6esourcemap",children:[],level:4}],level:2},{value:"4\u3011WebpackDevServer",id:"4webpackdevserver",children:[{value:"\u65b9\u5f0f\u4e00\uff1a\u547d\u4ee4\u884c",id:"\u65b9\u5f0f\u4e00\u547d\u4ee4\u884c",children:[],level:4},{value:"\u65b9\u5f0f\u4e8c\uff1a\u4f7f\u7528webpack-dev-server",id:"\u65b9\u5f0f\u4e8c\u4f7f\u7528webpack-dev-server",children:[{value:"\u8bf7\u6c42\u8f6c\u53d1\uff08\u53cd\u5411\u4ee3\u7406\uff09",id:"\u8bf7\u6c42\u8f6c\u53d1\u53cd\u5411\u4ee3\u7406",children:[],level:5},{value:"HMR\u6a21\u5757\u70ed\u66ff\u6362",id:"hmr\u6a21\u5757\u70ed\u66ff\u6362",children:[{value:"JS\u72b6\u6001\u7684HMR\uff1a",id:"js\u72b6\u6001\u7684hmr",children:[],level:6}],level:5}],level:4}],level:2},{value:"5\u3011plugin",id:"5plugin",children:[{value:"\u5e38\u7528plugin",id:"\u5e38\u7528plugin",children:[],level:3},{value:"\u624b\u5199plugin",id:"\u624b\u5199plugin",children:[{value:"\u2460\u540c\u6b65\u89e6\u53d1",id:"\u540c\u6b65\u89e6\u53d1",children:[],level:4},{value:"\u2461\u5f02\u6b65\u89e6\u53d1\u94a9\u5b50",id:"\u5f02\u6b65\u89e6\u53d1\u94a9\u5b50",children:[],level:4}],level:3},{value:"FileListPlugin",id:"filelistplugin",children:[],level:3},{value:"InlineSourcePlugin",id:"inlinesourceplugin",children:[],level:3},{value:"UploadPlugin",id:"uploadplugin",children:[],level:3}],level:2},{value:"6\u3011webpack\u6253\u5305\u4f18\u5316",id:"6webpack\u6253\u5305\u4f18\u5316",children:[{value:"\u539f\u7406\u5206\u6790\uff1a",id:"\u539f\u7406\u5206\u6790",children:[],level:3},{value:"webpack\u81ea\u5e26\u7684\u4f18\u5316\uff1a",id:"webpack\u81ea\u5e26\u7684\u4f18\u5316",children:[{value:"1\u3001tree-sharking",id:"1tree-sharking",children:[],level:4},{value:"2\u3001scope-hoisting",id:"2scope-hoisting",children:[],level:4}],level:3},{value:"\u901f\u5ea6\u7684\u4f18\u5316\uff1a",id:"\u901f\u5ea6\u7684\u4f18\u5316",children:[{value:"1\u3001happypack",id:"1happypack",children:[],level:4},{value:"2\u3001Dll\u52a8\u6001\u94fe\u63a5\u5e93",id:"2dll\u52a8\u6001\u94fe\u63a5\u5e93",children:[{value:"\u6b65\u9aa4\u4e00\uff1a",id:"\u6b65\u9aa4\u4e00-1",children:[],level:5},{value:"\u6b65\u9aa4\u4e8c\uff1a",id:"\u6b65\u9aa4\u4e8c-1",children:[],level:5},{value:"\u6b65\u9aa4\u4e09\uff1a",id:"\u6b65\u9aa4\u4e09",children:[],level:5},{value:"\u6b65\u9aa4\u56db\uff1a",id:"\u6b65\u9aa4\u56db",children:[],level:5}],level:4},{value:"3\u3001Externals\u914d\u7f6e\u9879\u5ffd\u7565\u6253\u5305",id:"3externals\u914d\u7f6e\u9879\u5ffd\u7565\u6253\u5305",children:[],level:4}],level:3},{value:"\u4f53\u79ef\u7684\u4f18\u5316\uff1a",id:"\u4f53\u79ef\u7684\u4f18\u5316",children:[{value:"1\u3001webpack.IgnorePlugin()",id:"1webpackignoreplugin",children:[],level:4},{value:"2\u3001\u62bd\u79bb\u516c\u5171\u4ee3\u7801\u5757",id:"2\u62bd\u79bb\u516c\u5171\u4ee3\u7801\u5757",children:[],level:4}],level:3},{value:"\u61d2\u52a0\u8f7d\u6a21\u5757\uff08\u6309\u9700\u52a0\u8f7d\uff09",id:"\u61d2\u52a0\u8f7d\u6a21\u5757\u6309\u9700\u52a0\u8f7d",children:[],level:3},{value:"React\u61d2\u52a0\u8f7d",id:"react\u61d2\u52a0\u8f7d",children:[],level:3}],level:2},{value:"7\u3011resolve\u914d\u7f6e",id:"7resolve\u914d\u7f6e",children:[],level:2},{value:"8\u3011localStorage\u7f13\u5b58js\u5b9e\u8df5",id:"8localstorage\u7f13\u5b58js\u5b9e\u8df5",children:[{value:"dll\u6253\u5305",id:"dll\u6253\u5305",children:[],level:3},{value:"BundleNamePlugin",id:"bundlenameplugin",children:[],level:3},{value:"\u7f13\u5b58\u5224\u65ad\u811a\u672c",id:"\u7f13\u5b58\u5224\u65ad\u811a\u672c",children:[],level:3}],level:2}],d={toc:c};function u(e){var n=e.components,l=(0,t.Z)(e,o);return(0,s.kt)("wrapper",(0,a.Z)({},d,l,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"\u91cd\u5b66webpack"},"\u91cd\u5b66webpack"),(0,s.kt)("h2",{id:"1\u5165\u53e3\u51fa\u53e3\u914d\u7f6e"},"1\u3011\u5165\u53e3\u51fa\u53e3\u914d\u7f6e"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"const path = require('path')\nconst webpack = require('webpack')\n\n//\u751f\u6210\u4e00\u4e2ahtml\u6a21\u677f\nconst HtmlWebpackPlugin = require('html-webpack-plugin')\n//\u542f\u52a8\u65f6\u6e05\u7a7adist\u6587\u4ef6\u5939\nconst { CleanWebpackPlugin } = require('clean-webpack-plugin')\n//\u5355\u72ec\u6253\u5305css\uff0c\u4e0d\u4f7f\u7528style\u6807\u7b7e\uff0c\u81ea\u52a8\u4f7f\u7528Link\u6807\u7b7e\nconst MiniCssExtractPlugin = require('mini-css-extract-plugin')\nmodule.exports = {\n  entry: {\n    index: './src/index.js',//\u57fa\u7840\u914d\u7f6e\n    // theory_analysis: './src/theory_analysis.js'//\u6253\u5305\u4f18\u5316\uff0cdll\n    // lazyLoad: './src/lazyLoad.js'//\u8def\u7531\u61d2\u52a0\u8f7d\u3001\u6309\u9700\u52a0\u8f7d\n  },\n  devtool:'eval-source-map',//\u5f00\u542fSourceMap\u4ee3\u7801\u6620\u5c04//\u9ed8\u8ba4\u662feval\n  //\u914d\u7f6e\u544a\u8bc9devServer\uff0c\u6253\u5305\u597d\u7684\u6587\u4ef6\u8be5\u5230dist\u6587\u4ef6\u5939\u4e0b\u53bb\u53d6\n  devServer: { \n    contentBase: './dist',//\u5728webpack4+\u8be5\u5b57\u6bb5\u4e5f\u53ef\u4ee5\u7528static\n    hot:true,//\u542f\u52a8\u70ed\u6a21\u5757\u66f4\u65b0webpack-dev-server3\u9ed8\u8ba4\u4e0d\u542f\u52a8\uff0c4+\u9ed8\u8ba4\u542f\u52a8\n    proxy:{//\u914d\u7f6e\u53cd\u5411\u4ee3\u7406\n      '/api':{//\u53ea\u8981\u662f\u9047\u5230\u57df\u540d\u540e\u9762\u662f/api\u5f00\u5934\u7684\u8bf7\u6c42\u90fd\u8f6c\u53d1\u5230target\u53bb\n        target:'http://www.baidu.com/',  \n        pathRewrite: {//\u5c06/api\u5f00\u5934\u7684\uff0c'/api'\u6539\u6210'api'\n          '^/api': '/api'\n        },\n        changeOrigin:true//\u8de8\u57df\u8bf7\u6c42\n      }\n    }\n  },\n  mode: 'development',\n  output: {\n    //publicPath: 'http://cdn.xxx.com',\n    //\u6dfb\u52a0src\u65f6\uff0c\u7684\u6839\u8def\u5f84\u6bd4\u5982\u73b0\u5728\u5c31\u662fsrc='http://cdn.xxx.com/[name].bundle.js'\n    filename: '[name]_[hash].bundle.js',\n    /*[name]\u5bf9\u5e94\u7684\u662fentry\u4e2d\u7684\u540d\u5b57;\u8fd9\u91cc\u7684'[name]'\u7684\u89c4\u5219\u547d\u540d\u79f0\u4e3a\u5360\u4f4d\u7b26\u3002\n      \u4e5f\u53ef\u4ee5\u4f7f\u7528[ext]\u3001[hash]\uff1b\u6765\u4f7f\u7528\u5360\u4f4d\u7b26\u3002\u8fd9\u91cc\u7684hash\u662f\u6839\u636e\u6587\u4ef6\u5185\u5bb9\u6765\u751f\u6210hash\u503c\uff08\u53ef\u4ee5\u7528\u4e8e\u7f51\u7edc\u8d44\u6e90\u8bf7\u6c42\u7684\u7f13\u5b58\uff09*/\n    path: path.join(__dirname, 'dist')//\u6253\u5305\u5230\u7684\u6587\u4ef6\u5939\n  },\n  resolve: {\n    extensions: ['.tsx', '.jsx', '.js'],//\u4e0d\u9700\u8981\u5199\u540e\u7f00\u540d\uff0c\u6309\u987a\u5e8f\u53bb\u627e\u6587\u4ef6\n    alias: {//\u522b\u540d\n      '@': path.resolve(__dirname, 'src')\n    },\n    modules: [path.resolve(__dirname, \"./src/\"), \"node_modules\"]\n    //\u544a\u8bc9 webpack \u89e3\u6790\u6a21\u5757\u65f6\u5e94\u8be5\u641c\u7d22\u7684\u76ee\u5f55\uff0c\u5373 require \u6216 import \u6a21\u5757\u7684\u65f6\u5019\uff0c\u53ea\u5199\u6a21\u5757\u540d\u7684\u65f6\u5019\uff0c\u5230\u54ea\u91cc\u53bb\u627e\uff0c\u5176\u5c5e\u6027\u503c\u4e3a\u6570\u7ec4\uff0c\u56e0\u4e3a\u53ef\u914d\u7f6e\u591a\u4e2a\u6a21\u5757\u641c\u7d22\u8def\u5f84\uff0c\u5176\u641c\u7d22\u8def\u5f84\u5fc5\u987b\u4e3a\u7edd\u5bf9\u8def\u5f84\uff0c\n  },\n  plugins: [//\u4f7f\u7528\u63d2\u4ef6\n    new HtmlWebpackPlugin({\n      template: './src/index.html'\n    }),\n    new CleanWebpackPlugin(),\n    //\u5f15\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u63d2\u4ef6(\u544a\u8bc9webpack\u6211\u4eec\u7528\u4e86\u54ea\u4e9b\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u8be5\u600e\u4e48\u4f7f\u7528\u8fd9\u4e9bdll)\n    new webpack.DllReferencePlugin({//\u8981\u4f7f\u7528Dll\u7684\u8bdd\u8fd8\u9700\u8981\u5355\u72ec\u6253\u5305\u52a8\u6001\u94fe\u63a5\u5e93\n      //\u9700\u8981\u627e\u5230\u751f\u6210\u7684dll\u52a8\u6001\u94fe\u63a5\u5e93\u7684manifest\u6620\u5c04\u6587\u4ef6\n      manifest: path.resolve(__dirname, 'dll', 'react.manifest.json')\n      //manifest: require('./dll/react.manifest.json'),//\u8fd9\u6837\u4e5f\u53ef\u4ee5\n    })\n  ],  \n  resolveLoader: {//\u914d\u7f6eloader\u5b58\u5728\u7684\u6587\u4ef6\u5939\uff0c\u9ed8\u8ba4\u53ea\u6709node_modules\uff08\u81ea\u5b9a\u4e49loader\uff09\n    modules: ['node_modules', path.resolve(__dirname, 'custom-loader')]\n  },\n  module: {//\u4f7f\u7528loader\n    rules: [\n      {\n        test: /\\.js$/,\n        exclude: /node_modules/,\n        use: {\n          loader: 'babel-loader',\n          options: { /*\u914d\u7f6e\u9879\u5728\u8fd9\u91cc*/ }\n        },\n      },\n      // {\n      //   test: /\\.(jpg|jpeg|png|gif)$/,\n      //   exclude: /node_modules/,\n      //   use: {\n      //     loader: 'file-loader',\n      //     options: { // \u914d\u7f6e\u9879\u5728\u8fd9\u91cc\n      //       name: '[name]_[hash].[ext]',//\u4f7f\u7528\u539f\u5148\u7684\u6587\u4ef6\u540d\u548c\u540e\u7f00\u540d\n      //       outputPath: 'images/'//\uff08\u5339\u914d\u5230\u7684\u9759\u6001\u56fe\u7247\u653e\u5230dist\u76ee\u5f55\u7684imges\u4e0b\uff09\n      //     }\n      //   },\n      // },\n   /*url-loader\u548cfile-loader\u4e24\u8005\u4e0d\u80fd\u540c\u65f6\u4f7f\u7528\uff1a\n    - url-loader\u5185\u7f6e\u4e86file-loader\uff08\u53ef\u4ee5\u76f4\u63a5\u5b89\u88c5url-loader\u4f7f\u7528\uff09\n    - \u53ef\u4ee5\u8bbe\u7f6efile-loader\u7684\u6240\u6709\u914d\u7f6e\u9009\u9879\n    - \u4f7f\u7528limit\u5c5e\u6027\u6765\u9650\u5236\u8d85\u8fc7\u591a\u5927\u7684\u56fe\u7247\uff0c\u5c31\u4e0d\u4f7f\u7528base64\u6765\u6253\u5305\u56fe\u7247\n    - \u6240\u6709\u63a8\u8350\u4f7f\u7528url-loader\uff08\u4e5f\u53ef\u4ee5\u5904\u7406css\u4e2d\u7684background-image:url()\u56fe\u7247\uff09*/\n      {\n        test: /\\.(jpg|jpeg|png)$/,\n        exclude: /node_modules/,\n        use: {//\u4f7f\u7528url-loader\uff0c\u81ea\u52a8\u628a\u56fe\u7247\u8f6c\u6210base64\u7684\u6587\u4ef6\u683c\u5f0f\n          loader: 'url-loader',\n          options: {\n            limit: 100,\n            name: '[name]_[hash].[ext]',//\u4f7f\u7528\u539f\u5148\u7684\u6587\u4ef6\u540d\u548c\u540e\u7f00\u540d\n            outputPath: 'images/'//\uff08\u5339\u914d\u5230\u7684\u9759\u6001\u56fe\u7247\u653e\u5230dist\u76ee\u5f55\u7684imges\u4e0b\uff09\n          }\n        },\n      },\n      {\n        test: /\\.css$/,\n        exclude: /node_modules/,\n        //use\u7684\u6570\u7ec4\u91cc\u9762\u662f\u4ece\u540e\u5f80\u524d\u52a0\u8f7d\uff0c\u6211\u4eec\u9700\u8981\u5148\u89e3\u6790css\u4ee3\u7801\u4ee5\u53ca\u6587\u4ef6\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u518d\u5c06style\u6807\u7b7e\u63d2\u5165head\u4e2d\n        //\u5199\u6cd5\u4e00\uff1ause: ['style-loader', 'css-loader']\n        //\u5199\u6cd5\u4e8c\uff1a\u4ece\u540e\u5f80\u524d\u7684\u987a\u5e8f\u8fdb\u884c\u8bfb\u53d6\uff1a\n        use: [\n        //  { loader: \"style-loader\" },\n          MiniCssExtractPlugin.loader,//\u5355\u72ec\u6253\u5305css\uff0c\u4e0d\u4f7f\u7528style\u6807\u7b7e\uff0c\u81ea\u52a8\u4f7f\u7528Link\u6807\u7b7e\n          { loader: \"css-loader\",\n           options:{//\u5f00\u542fcssmodule\n             modules: { localIdentName: '[name][hash:base64:6]' }\n           } \n          },\n          { loader: \"postcss-loader\" }\n        ]\n      },\n      {//\u524d\u63d0\u662f\u5b89\u88c5sass\u9884\u5904\u7406\u5668\n        test: /\\.scss$/,\n        exclude: /node_modules/,\n        //\u4ece\u540e\u5f80\u524d\u7684\u987a\u5e8f\u8fdb\u884c\u8bfb\u53d6\uff1a\n        use: [\n          //'style-loader',\n          MiniCssExtractPlugin.loader,//\u5355\u72ec\u6253\u5305css\uff0c\u4e0d\u4f7f\u7528style\u6807\u7b7e\uff0c\u81ea\u52a8\u4f7f\u7528Link\u6807\u7b7e\n          'css-loader', 'sass-loader','postcss-loader']\n      },\n      {//\u524d\u63d0\u662f\u5b89\u88c5less\u9884\u5904\u7406\u5668\n        test: /\\.less$/,\n        exclude: /node_modules/,\n        //\u4ece\u540e\u5f80\u524d\u7684\u987a\u5e8f\u8fdb\u884c\u8bfb\u53d6\uff1a\n        use: [\n          //'style-loader',\n          MiniCssExtractPlugin.loader,//\u5355\u72ec\u6253\u5305css\uff0c\u4e0d\u4f7f\u7528style\u6807\u7b7e\uff0c\u81ea\u52a8\u4f7f\u7528Link\u6807\u7b7e\n          'css-loader', 'less-loader','postcss-loader']\n      },\n      /*\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1apostcss\u7684\u76ee\u7684\u662f\u8ba9css3\u7684\u5c5e\u6027\u901a\u8fc7\u811a\u672c\u7684\u65b9\u5f0f\u751f\u6210\u5382\u5546\u524d\u7f00\u7684\u5de5\u5177\uff0c\n      \u4f7f\u7528\u65b9\u5f0f\u7c7b\u4f3c\u4e8ebabel\uff0c\u4e5f\u9700\u8981\u5b89\u88c5\u76f8\u5e94\u60f3\u8981\u4f7f\u7528\u7684\u63d2\u4ef6\uff0c\n      \u5728`postcss.config.js`\u4e2d\u8fdb\u884c\u914d\u7f6e\uff0c\u5728`packege.json`\u4e2d\u6709browerslist\u5b57\u6bb5\u8bbe\u7f6e\u3002*/\n      {//\u89e3\u6790\u52a0\u8f7diconfont\u9700\u8981\u7684\u6587\u4ef6\u5e76\u6253\u5305\n        test: /\\.(eot|woff|ttf|svg)/,\n        include: [path.resolve(__dirname, 'src/font')],\n        //\u53ea\u5904\u7406src\u4e0b\u7684font\u6587\u4ef6\u5939\n        use: {\n          loader: 'file-loader',\n          options: { outputPath: 'font/' },//\u6253\u5305\u5230dist\u4e0b\u7684font\u6587\u4ef6\u5939\n        }\n      }\n    ]\n  }\n}\n")),(0,s.kt)("h2",{id:"2loader"},"2\u3011loader"),(0,s.kt)("p",null,"loader\u7684\u6267\u884c\u987a\u5e8f\u662f",(0,s.kt)("strong",{parentName:"p"},"\u4ece\u4e0b\u5230\u4e0a\uff0c\u4ece\u53f3\u5230\u5de6"),"\u3002"),(0,s.kt)("h3",{id:"babel-loader"},"babel-loader"),(0,s.kt)("h5",{id:"\u600e\u4e48\u5728webpack\u4e2d\u4f7f\u7528babel\u5462"},"\u600e\u4e48\u5728webpack\u4e2d\u4f7f\u7528babel\u5462?"),(0,s.kt)("p",null,"\u2460\u9996\u5148\u5b89\u88c5babel-loader"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"npm i babel-loader --save-dev\n")),(0,s.kt)("p",null,"\u2461webpack\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6eloader\uff08module\u7684\u914d\u7f6e\u9879\u4e2d\uff09"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//\u5199\u6cd5\u4e00\uff1a\nmodule: {\n  rules: [{\n    test: /\\.js$/,\n    use: 'babel-loader',//\u8fd9\u6837\u4e5f\u53ef\u4ee5\uff1aloader:'babel-loader'\n    exclude: /node_modules/\n  }]\n}\n//\u5199\u6cd5\u4e8c\uff1a\uff08\u5982\u679c\u9700\u8981\u914d\u7f6eloader\uff09\nmodule: {\n  rules: [{\n    test: /\\.js$/,\n    exclude: /node_modules/,\n    use: {\n      loader: 'babel-loader',\n      options: {\n        // \u914d\u7f6e\u9879\u5728\u8fd9\u91cc\n      }\n    },\n  }]\n}\n")),(0,s.kt)("p",null,"\u2462\u5c06babel\u63d2\u4ef6\u7684\u540d\u5b57\u589e\u52a0\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d (\u6839\u76ee\u5f55\u4e0b\u521b\u5efa .babelrc\u3001.babelrc.js \u3001babel.config.js\u6216\u8005 package.json \u7684 ",(0,s.kt)("inlineCode",{parentName:"p"},"babel")," \u91cc\u9762\u6765\u8fdb\u884c\u914d\u7f6e)"),(0,s.kt)("p",null,"\u8fd9\u91cc\u4f7f\u7528\u7684\u662f.babelrc\u7684\u5f62\u5f0f\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "presets": ["@babel/preset-env"]\n}\n')),(0,s.kt)("p",null,"\u2463\u518d\u5b89\u88c5\u6211\u4eec\u6211\u4eec\u9700\u8981\u4f7f\u7528\u7684babel\u63d2\u4ef6\u548c\u9884\u8bbe"),(0,s.kt)("p",null,"\u8fd9\u91cc\u4f7f\u7528\u7684\u9884\u8bbe\u662fenv\u9884\u8bbe\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"npm i @babel/preset-env --save-dev\n")),(0,s.kt)("h5",{id:"\u4f7f\u7528babel-polyfill\u57ab\u7247\u8865\u5145es6\u4ee3\u7801\u7684\u5b9e\u73b0"},"\u4f7f\u7528babel-polyfill\uff08\u57ab\u7247\uff09\u8865\u5145ES6\u4ee3\u7801\u7684\u5b9e\u73b0"),(0,s.kt)("p",null,"\u4f4e\u7248\u672c\u7684\u6d4f\u89c8\u5668\u6ca1\u6709\u65b0\u7248\u672c\u7684API\uff0c\u5982\uff1apromise\u3001Array.from\u3001Map\u7b49\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4f7f\u7528babel-polyfill\u6765\u5728\u4ee3\u7801\u4e2d\u8865\u5145\u8fd9\u4e9b\u7f3a\u5c11\u7684api\u7684\u5b9e\u73b0\u3002"),(0,s.kt)("p",null,"\u2460\u5b89\u88c5",(0,s.kt)("inlineCode",{parentName:"p"},"npm i --save @babel/polyfill"),"\uff0c\u5b83\u4e0d\u662f\u5f00\u53d1\u65f6\u4f9d\u8d56\uff0c\u662f\u751f\u4ea7\u73af\u5883\u4e5f\u9700\u8981\u7684\u4f9d\u8d56\u3002"),(0,s.kt)("p",null,"\u2461\u5728\u9879\u76ee\u5165\u53e3\u6587\u4ef6\u4e2d\u5bfc\u5165\u57ab\u7247"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//index.js\nimport '@babel/polyfill'\n\nconst promiseArray = [\n  new Promise(()=>{}),\n  new Promise(()=>{})\n]\n\npromiseArray.map(promise=>promise)\n")),(0,s.kt)("p",null,"\u2462\u5728presets\u7684\u8bbe\u7f6e\u4e2d\u8fdb\u884c\u914d\u7f6e\uff08\u544a\u8bc9babel\u6211\u4eec\u53ea\u9700\u8981\u4f7f\u7528\u5230\u7684ES6+\u7684api\u7684\u5b9e\u73b0\uff0c\u51cf\u5c11\u6ca1\u5fc5\u8981\u7684\u591a\u4f59\u4ee3\u7801\uff09"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'//.babelrc\n{\n  "presets": [\n    [\n      "@babel/preset-env",\n      {\n        "useBuiltIns": "usage"\n      }\n    ]\n  ]\n}\n\n\n//webpack.config.js\n{\n  test: /\\.js$/,\n    exclude: /node_modules/,\n      use: {\n        loader: \'babel-loader\',\n          options: { /*\u914d\u7f6e\u9879\u5728\u8fd9\u91cc*/\n            presets: [\n              [\n                \'@babel/preset-env\',\n                {//\u57ab\u7247polyfill\uff08\u544a\u8bc9babel\u6211\u4eec\u53ea\u9700\u8981\u4f7f\u7528\u5230\u7684ES6+\u7684api\u7684\u5b9e\u73b0\uff0c\u51cf\u5c11\u6ca1\u5fc5\u8981\u7684\u591a\u4f59\u4ee3\u7801\uff09\n                  useBuiltIns: \'usage\'\n                }\n              ]\n            ]\n          }\n        },\n      },\n')),(0,s.kt)("h3",{id:"file-loader"},"file-loader"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"module: {//\u4f7f\u7528loader\n    rules: [\n      {\n        test: /\\.(jpg|jpeg|png|gif)$/,\n        exclude: /node_modules/,\n        use: {\n          loader: 'file-loader',\n          options: { // \u914d\u7f6e\u9879\u5728\u8fd9\u91cc\uff1a\uff08\u4e00\u822c\u7684\u6253\u5305name\u89c4\u5219\u90fd\u652f\u6301\u5360\u4f4d\u7b26[]\uff09\n            name: '[name]_[hash].[ext]',//\u4f7f\u7528\u539f\u5148\u7684\u6587\u4ef6\u540d\u548c\u540e\u7f00\u540d\n            outputPath: 'images/'\n            //\uff08\u5339\u914d\u5230\u7684\u9759\u6001\u56fe\u7247\u653e\u5230dist\u76ee\u5f55\u7684imges\u4e0b\uff09\n          }\n        },\n      }\n    ]\n  }\n")),(0,s.kt)("h3",{id:"url-loader"},"url-loader"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"module: {//\u4f7f\u7528loader\n    rules: [\n      {\n        test: /\\.(jpg|jpeg|png)$/,\n        exclude: /node_modules/,\n        use: {//\u4f7f\u7528url-loader\uff0c\u81ea\u52a8\u628a\u56fe\u7247\u8f6c\u6210base64\u7684\u6587\u4ef6\u683c\u5f0f\n          loader: 'url-loader',\n        },\n      }\n    ]\n  }\n")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"url-loader"),"\u548c",(0,s.kt)("strong",{parentName:"p"},"file-loader"),"\u4e24\u8005",(0,s.kt)("strong",{parentName:"p"},"\u4e0d\u80fd\u540c\u65f6\u4f7f\u7528"),"\uff1a"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"url-loader\u5185\u7f6e\u4e86file-loader\uff08\u53ef\u4ee5\u76f4\u63a5\u5b89\u88c5url-loader\u4f7f\u7528\uff09"),(0,s.kt)("li",{parentName:"ul"},"\u53ef\u4ee5\u8bbe\u7f6efile-loader\u7684\u6240\u6709\u914d\u7f6e\u9009\u9879"),(0,s.kt)("li",{parentName:"ul"},"\u4f7f\u7528limit\u5c5e\u6027\u6765\u9650\u5236\u8d85\u8fc7\u591a\u5927\u7684\u56fe\u7247\uff0c\u5c31\u4e0d\u4f7f\u7528base64\u6765\u6253\u5305\u56fe\u7247"),(0,s.kt)("li",{parentName:"ul"},"\u6240\u6709",(0,s.kt)("strong",{parentName:"li"},"\u63a8\u8350\u4f7f\u7528url-loader"),"\uff08\u4e5f\u53ef\u4ee5\u5904\u7406css\u4e2d\u7684",(0,s.kt)("inlineCode",{parentName:"li"},"background-image:url()"),"\u56fe\u7247\uff09")),(0,s.kt)("h3",{id:"css-loaderstyle-loader"},"css-loader\u3001style-loader"),(0,s.kt)("p",null,"\u6ce8\u610f\uff1ause\u7684\u6570\u7ec4\u91cc\u9762\u662f",(0,s.kt)("strong",{parentName:"p"},"\u4ece\u540e\u5f80\u524d\u52a0\u8f7d"),"\uff0c\u6211\u4eec\u9700\u8981\u5148\u89e3\u6790css\u3001\u518d\u5c06style\u6807\u7b7e\u63d2\u5165\u5230\u6a21\u677f\u4e2d\uff08\u4f7f\u7528js\u63d2\u5165\u8fd0\u884c\u65f6\uff09\uff0c\u6240\u4ee5\u5199\u6cd5\u5fc5\u987b\u662f",(0,s.kt)("inlineCode",{parentName:"p"},"use:['style-loader','css-loader']")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"module: {//\u4f7f\u7528loader\n  rules: [\n    {\n      test: /\\.css$/,\n      exclude: /node_modules/,\n      //use\u7684\u6570\u7ec4\u91cc\u9762\u662f\u4ece\u540e\u5f80\u524d\u52a0\u8f7d\uff0c\u6211\u4eec\u9700\u8981\u5148\u89e3\u6790css\u4ee3\u7801\u4ee5\u53ca\u6587\u4ef6\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u518d\u5c06style\u6807\u7b7e\u63d2\u5165head\u4e2d\n      //\u5199\u6cd5\u4e00\uff1ause: ['style-loader', 'css-loader']\n      //\u5199\u6cd5\u4e8c\uff1a\u4ece\u540e\u5f80\u524d\u7684\u987a\u5e8f\u8fdb\u884c\u8bfb\u53d6\uff1a\n      use: [{ loader: \"style-loader\" }, { loader: \"css-loader\" }]\n    }\n  ]\n} \n")),(0,s.kt)("h3",{id:"sass-loaderless-loaderpostcss-loader"},"sass-loader\u3001less-loader\u3001postcss-loader"),(0,s.kt)("p",null,"\u524d\u63d0\u9700\u8981\u5b89\u88c5sass\u6216\u8005less\u624d\u80fd\u4f7f\u7528\u54e6\uff01"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"#sass\u9884\u5904\u7406\u5668\u5199\u6837\u5f0f\uff0c\u4f7f\u7528sass-loader\u5904\u7406.scss\u6587\u4ef6\u89e3\u6790\nnpm i -D sass sass-loader \n#less\u9884\u5904\u7406\u5668\u5199\u6837\u5f0f\uff0c\u4f7f\u7528less-loader\u5904\u7406.less\u6587\u4ef6\nnpm i -D less less-loader \n#\u5b89\u88c5\nnpm i -D postcss postcss-loader\n")),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://www.postcss.com.cn/"},"postcss"),"\u7684\u76ee\u7684\u662f\u8ba9css3\u7684\u5c5e\u6027\u901a\u8fc7\u811a\u672c\u7684\u65b9\u5f0f\u751f\u6210\u5382\u5546\u524d\u7f00\u7684\u5de5\u5177\uff0c\u4f7f\u7528\u65b9\u5f0f\u7c7b\u4f3c\u4e8ebabel\uff0c\u4e5f\u9700\u8981\u5b89\u88c5\u76f8\u5e94\u60f3\u8981\u4f7f\u7528\u7684\u63d2\u4ef6\uff0c\u5728",(0,s.kt)("inlineCode",{parentName:"p"},"postcss.config.js"),"\u4e2d\u8fdb\u884c\u914d\u7f6e\uff0c\u5728",(0,s.kt)("inlineCode",{parentName:"p"},"packege.json"),"\u4e2d\u6709browerslist\u5b57\u6bb5\u8bbe\u7f6e\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'//package.json\n{\n  "name":"xxx",\n  "version":"1.0.0",\n  ...\n  "browerslist":[\n    "> 1%",//\u517c\u5bb9\u5e02\u573a\u4efd\u989d\u5927\u4e8e1%\u7684\u6d4f\u89c8\u5668\n    "last 2 versions"//\u5e76\u4e14\u8fd9\u4e9b\u6d4f\u89c8\u5668\u4e0a\u4e24\u4e2a\u7248\u672c\u90fd\u8981\u53bb\u517c\u5bb9\n  ],\n  ...\n}\n  \n//postcss.config.js\nmodule.exports = {\n  plugins: [\n    require(\'autoprefixer\')\n    ]\n}\n')),(0,s.kt)("p",null,"webpack\u914d\u7f6e\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"module: {//\u4f7f\u7528loader\n  rules: [\n    {//\u524d\u63d0\u662f\u5b89\u88c5sass\u9884\u5904\u7406\u5668\n      test: /\\.scss$/,\n      exclude: /node_modules/,\n      //\u4ece\u540e\u5f80\u524d\u7684\u987a\u5e8f\u8fdb\u884c\u8bfb\u53d6\uff1a\n      use: ['style-loader', 'css-loader', 'postcss-loader', 'sass-loader']\n    },\n    {//\u524d\u63d0\u662f\u5b89\u88c5less\u9884\u5904\u7406\u5668\n      test: /\\.less$/,\n      exclude: /node_modules/,\n      //\u4ece\u540e\u5f80\u524d\u7684\u987a\u5e8f\u8fdb\u884c\u8bfb\u53d6\uff1a\n      use: ['style-loader', 'css-loader', 'postcss-loader', 'less-loader']\n    } \n  ]\n} \n")),(0,s.kt)("h3",{id:"cssmodule\u542f\u7528"},"cssModule\u542f\u7528"),(0,s.kt)("p",null,"\u9700\u8981\u6ce8\u610f\u7684\u662f",(0,s.kt)("strong",{parentName:"p"},"\u5982\u679c\u542f\u7528\u4e86cssmodule\u7684\u8bdd\u5c31\u4e0d\u80fd\u4f7f\u7528\u666e\u901a\u7684\u65b9\u5f0f\u8fdb\u884c\u5bfc\u5165css"),"\uff0c\u56e0\u4e3acss\u6587\u4ef6\u6253\u5305\u540e\u7c7b\u540d\u53d8\u6210\u4e86hash\u503c\uff0c\u4e0d\u80fd\u7528\u6211\u4eec\u81ea\u5df1\u5b9a\u4e49\u7684\u7c7b\u540d\u53bb\u627e\u6837\u5f0f\u3002"),(0,s.kt)("p",null,"\u5982\u679c\u4e0d\u542f\u7528cssmodule\u7684\u8bdd\uff0c",(0,s.kt)("inlineCode",{parentName:"p"},"import './index.css'"),"\u662f\u5168\u5c40\u7684\u5f15\u5165\uff0c\u5728\u5168\u5c40\u90fd\u751f\u6548\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"module: {//\u4f7f\u7528loader\n  rules: [\n    {\n      test: /\\.css$/,\n      exclude:[path.resolve(__dirname, '..', 'node_modules')],\n      use: [\n        { loader: \"style-loader\" },\n        {\n          loader: \"css-loader\",\n            options:{\n            modules:true//css-module\u6253\u5f00\u3002\n          }\n        }\n      ]\n    },\n    //\u6b64\u65f6\u6211\u4eec\u7684\u914d\u7f6e\u662f\u9047\u5230.css\u6587\u4ef6\u5c31\u56de\u53bb\u5f00\u542f,\u800c\u5f15\u5165\u7684npm\u5305\u7684\u6837\u5f0f\u8fd8\u6ca1\u6709\u5904\u7406\u3002\u6240\u4ee5\u8fd8\u9700\u8981\u4e00\u4e2a\u914d\u7f6e\uff1a\u5355\u72ec\u5904\u7406node_module\u5185\u7684css\u6587\u4ef6\n\n    { \n      test: /\\.css$/,\n      use: ['style-loader','css-loader','postcss-loader'],\n    include:[path.resolve(__dirname, '..', 'node_modules')]\n}\n  ]\n}\n")),(0,s.kt)("p",null,"\u7136\u540e\u518d\u6bcf\u4e2a\u6a21\u5757\u4e2d\u5c31\u53ef\u4ee5\u4f7f\u7528cssmodule\u7684\u8bed\u6cd5\u4e86\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//index.css\n.avatar{\n  width:10;\n  height:10;\n}\n\n//index.js\nimport styles from './index.css\nconsole.log(styles)//{avatar: \"_1ofLYuuFNEe_WYUYkaG3VO\"}\n//import './index.css'//\u542f\u7528\u4e4b\u540e\u5c31\u4e0d\u80fd\u8fd9\u6837\u5bfc\u5165\uff0c\u56e0\u4e3acss\u6587\u4ef6\u6253\u5305\u540e\u7c7b\u540d\u53d8\u6210\u4e86hash\u503c\uff0c\u4e0d\u80fd\u7528.avatar\u627e\u5230\u76f8\u5e94\u7c7b\u540d\u3002\nconst App = document.getElementById('app')\nconst image = new Image()\nimage.src = avatar\nimage.className += styles.avatar//\u53ea\u80fd\u7531\u8fd9\u79cd\u65b9\u5f0f\u53bb\u4f7f\u7528\u7c7b\u540d\nApp.appendChild(image)\n")),(0,s.kt)("h4",{id:"\u652f\u6301css-module\u6a21\u5f0f\u548c\u666e\u901a\u6a21\u5f0f\u6df7\u7528"},"\u652f\u6301",(0,s.kt)("inlineCode",{parentName:"h4"},"css module"),"\u6a21\u5f0f\u548c\u666e\u901a\u6a21\u5f0f\u6df7\u7528"),(0,s.kt)("p",null,"1.\u7528\u6587\u4ef6\u540d\u533a\u5206\u4e24\u79cd\u6a21\u5f0f"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"*.global.css")," \u666e\u901a\u6a21\u5f0f"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"*.css")," css module\u6a21\u5f0f")),(0,s.kt)("p",null,"\u8fd9\u91cc\u7edf\u4e00\u7528 ",(0,s.kt)("inlineCode",{parentName:"p"},"global")," \u5173\u952e\u8bcd\u8fdb\u884c\u8bc6\u522b\u3002"),(0,s.kt)("p",null,"2.\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u6587\u4ef6"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-javascript"},"// css module\n{ \n    test: new RegExp(`^(?!.*\\\\.global).*\\\\.css`),\n    use: [\n        {\n            loader: 'style-loader'\n        }\uff0c\n        {\n            loader: 'css-loader',\n            options: {\n                modules: {  localIdentName: '[hash:base64:6]' },\n              }\n        },\n        {\n            loader: 'postcss-loader'\n        }\n    ],\n    exclude:[path.resolve(__dirname, '..', 'node_modules')]\n}\n\n// \u666e\u901a\u6a21\u5f0f\n{ \n    test: new RegExp(`^(.*\\\\.global).*\\\\.css`),\n    use: [\n        {\n            loader: 'style-loader'\n        }\uff0c\n        {\n            loader: 'css-loader',\n        },\n        {\n            loader: 'postcss-loader'\n        }\n    ],\n    exclude:[path.resolve(__dirname, '..', 'node_modules')]\n}\n")),(0,s.kt)("h3",{id:"file-loader\u6253\u5305\u5b57\u4f53\u56fe\u6807"},"file-loader\u6253\u5305\u5b57\u4f53\u56fe\u6807"),(0,s.kt)("p",null,"\u2460\u9996\u5148\u6211\u4eec\u5230iconfont\u53bb\u4e0b\u8f7d\u6211\u4eec\u9700\u8981\u7684\u5b57\u4f53\u548c\u56fe\u6807\u6e90\u6587\u4ef6\u3002\u5728\u628a\u4ed6\u4eec\u4fdd\u5b58\u5230\u524d\u7aef\u9879\u76ee\u7684\u9759\u6001\u8d44\u6e90\u6587\u4ef6\u5939font\u4e2d\u3002"),(0,s.kt)("p",null,"\u5176\u4e2d\u6709\u4e2acss\u6587\u4ef6\u5982\u4e0b\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-css"},'/*iconfont\u914d\u7f6e*/\n@font-face {\n  font-family: "iconfont";\n  src: url("./font/iconfont.eot?t=1619246879033"); /* IE9 */\n  src: url("./font/iconfont.eot?t=1619246879033#iefix")\n      format("embedded-opentype"),\n    /* IE6-IE8 */\n      url("data:application/x-font-woff2;charset=utf-8;base64,d09GMgABAAAAAAOUAAsAAAAAB/gAAANGAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHEIGVgCCcAqEAIMRATYCJAMICwYABCAFhG0HMRu4BhEVnBXIfhbGzosiSens4+dPubT5NJqhauz3iwiqtX97bvchqo/kQLMGFPKrkNFhIWM8sJGpSBY+9/dz+pIC/QxLdp1QRI7UXJGTmy8g/gwQhZ/RE256939qh32hA8rCPE+02/+4P5J9uS7bxiUqYAGbzuD9fxzutbGF5rvLc5xzURdgHFBAe2ObrED6YPyHsQta4nkCTXN2xOn6hgbqMnNaIB5sMk6oZ1RyQ3aoC9WKtRniNfDUizL5A7wKvh//TIYQFCoJzLwLes0Dh78dKy6l/m8sHgLY0xnANpGwg0zcVJrOIEWhHUlTDWVLbCs7+EmVpcfa7D8eQVTBzGyDGci6JrbDudS/LEBGD08BfBvUj157mCsUCYViWyDxDhE5aaxgWJm3L/X0oCKncTotqFJBisbRXoaWGuESLHdVjKY0K3FWt6UueJzYJQ6bPL2+zMlKxa7KjoIxpnpAL3EqkgKHt88qzNgwVYG72gdDSkoXHkOY5fKLm8Y9qaEvw5gws5cyr8Ms7oFBJtP03+7NzfCwo1aNBI4xPleV4Ytc1C3pZtypun47M5967kD71cr04qokEXG/qUfBjaCEJD4GK1EtHoeIEiKIUTV1UKlOtXCiVJBoMgQx7hYqj+zHE80M4M3bPpq/0uWjokh6Ilhl8SMl3BFkHKhbaGjF/UAlgP0nYtpn6pSHSqKi41rgjxLPBVj2kUI7BNRvfo4SCTgEKN+mT87Eb/uN/162Dy7/1VtcgO/XzQWO8m2GbhbqN2cOfhK7Y0vWuKa6yAq7MlZ4CoM3X9XURAnbhn4MtUxIDKHO2RAKNbOQ1K0gM3YHKlr2oKrudABN28rNLSNkKXIDW94AQt8HCl0fIen7IjP2BxVTf6jqxxKa7mK0Z8taBHFCKBkNqCsE3XfW1rIIszfojo2kNDcgH5Cm4IU0SvLREjukKRZMJ5cxW7DUt1CAy7Bpehior1Bz5JmHPI5t1Zsi3bcz4QRBEkMGUK5AoPU61uvMROHzG8g5akjU0FRlPkBkEnoHqUjSAVmKuk5Nt3LN5MTJMGYBi/RaoAAG1FihHhiqR1WQxiJ+QGCQi1E721UULS9p324XNJnyIqyhSe0eO6c9zmYAAA==")\n      format("woff2"),\n    url("./font/iconfont.woff?t=1619246879033") format("woff"),\n    url("./font/iconfont.ttf?t=1619246879033") format("truetype"),\n    /* chrome, firefox, opera, Safari, Android, iOS 4.2+ */\n      url("./font/iconfont.svg?t=1619246879033#iconfont") format("svg"); /* iOS 4.1- */\n}\n\n.iconfont {\n  font-family: "iconfont" !important;\n  font-size: 16px;\n  font-style: normal;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.icon-fengche:before {\n  content: "\\e60d";\n}\n')),(0,s.kt)("p",null,"\u2461\u4f7f\u7528file-loader\u89e3\u6790\u8fd9\u4e9b\u540e\u7f00\u540d\u7684\u6587\u4ef6"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"module: {//\u4f7f\u7528loader\n  rules: [\n    {\n      test: /\\.(eot|woff|ttf|svg)/,\n      include: [path.resolve(__dirname, 'src/font')],//\u53ea\u5904\u7406src\u4e0b\u7684font\u6587\u4ef6\u5939\n      use: {\n        loader: 'file-loader',\n        options: { outputPath: 'font/' },//\u6253\u5305\u5230dist\u4e0b\u7684font\u6587\u4ef6\u5939\n      }\n    }\n  ]\n} \n")),(0,s.kt)("p",null,"\u7136\u540e\u5c31\u53ef\u4ee5\u4f7f\u7528\u5bf9\u5e94\u7684\u7c7b\u540d\u52a0\u8f7d\u56fe\u6807\u4e86"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"const App = document.getElementById('app')\n//\u5f15\u5165\u5b57\u4f53\u56fe\u6807\nApp.innerHTML = '<div class=\"iconfont icon-fengche\"></div>';\n")),(0,s.kt)("h3",{id:"\u5b9e\u73b0\u4e00\u4e2ababel-loader"},"\u5b9e\u73b0\u4e00\u4e2ababel-loader\uff1a"),(0,s.kt)("h4",{id:"\u6b65\u9aa4\u4e00"},"\u6b65\u9aa4\u4e00\uff1a"),(0,s.kt)("p",null,"\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6custom-loader/babel-loader.js"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//babel-loader.js\nconst babel = require('@babel/core')//\u4ee3\u7801\u7f16\u5199babel\u8f6c\u6362\nconst loaderUtils = require('loader-utils')//\u83b7\u53d6webpack\u914d\u7f6e\u4e2d\u7684\u4f20\u53c2\nconst validateOptions = require('schema-utils')//\u7528\u4e8e\u9a8c\u8bc1loader\u914d\u7f6e\u4e2d\u4f20\u7684option\u7684\u5408\u6cd5\u6027(\u7c7b\u4f3c\u4e8emongoose)\n\nfunction babel_loader(source) {//this--\x3eloaderContext\uff08\u8fd9\u91cc\u662f\u4f7f\u7528bind\u53bb\u6267\u884c\u7684\u8fd9\u4e2aloader\uff09\n  let options = loaderUtils.getOptions(this)//\u83b7\u53d6webpack\u914d\u7f6eloader\u65f6\u7684options\u914d\u7f6e  \n /* \u9a8c\u8bc1\u4f20\u53c2\u5408\u6cd5\u6027\n    let schema = { type:'object',\n                properties:{\n                  text:{ type:'string' },\n                  filename:{ type:'string' }\n                }}\n   validateOptions(schema,options,'babel-loader')\n */\n  let cb = this.async()//\u8c03\u7528cb\u51fd\u6570\u7528\u6765\u7ed3\u675f\u5f53\u524dloader\u6267\u884c\n  babel.transform(source, {//\u5f02\u6b65\u64cd\u4f5c\n    ...options,\n    sourceMap: true,//\u5f00\u542fsourcemap\n    filename: this.resourcePath.split('/').pop()//\u7ed9sourcemap\u5bf9\u5e94\u6587\u4ef6\u540d\n  }, (err, res) => {\n    cb(err, res.code, res.map)//\u5f02\u6b65\u7ed3\u675f\n  })\n}\n\nmodule.exports = babel_loader\n")),(0,s.kt)("h4",{id:"\u6b65\u9aa4\u4e8c"},"\u6b65\u9aa4\u4e8c\uff1a"),(0,s.kt)("p",null,"\u5b89\u88c5@babel/core\uff08babel\u63d0\u4f9b\u7684\u7f16\u7a0b\u8f6c\u6362\u529f\u80fd\uff09\u548cloader-utils\uff08\u7528\u4e8e\u83b7\u53d6webpack\u4e2dloader\u914d\u7f6e\u9879\u7684\u4f20\u53c2\uff09"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"npm i -D @babel/core loader-utils"))),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//webpack.config.js\nresolveLoader: {//\u914d\u7f6eloader\u5b58\u5728\u7684\u6587\u4ef6\u5939\uff0c\u9ed8\u8ba4\u53ea\u6709node_modules\n    modules: ['node_modules', path.resolve(__dirname, 'custom-loader')]\n},\n")),(0,s.kt)("h2",{id:"3sourcemap"},"3\u3011SourceMap"),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"\u5c06dist\u6587\u4ef6\u5939\u4e0b\u6253\u5305\u597d\u7684\u4ee3\u7801\u76ee\u5f55\u7ed3\u6784"),"\u548c",(0,s.kt)("inlineCode",{parentName:"p"},"\u6e90\u4ee3\u7801\u76ee\u5f55\u7ed3\u6784"),"\u8054\u7cfb\u8d77\u6765\uff0c\u5c31\u662fSourceMap"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//\u4e3e\u4f8b\uff1a\u6bd4\u5982\u8bf4\uff0c\u5728src/index.js\u7684\u7b2c\u4e00\u884c\uff0c\u5199\u4e86\u4e00\u53e5console.logg('\u4e0b\u6b21\u4e00\u5b9a\uff01')\n/*\u5f88\u660e\u663e\u5728\u6253\u5305\u597d\u4e4b\u540e\u6267\u884c\u662f\u6709\u95ee\u9898\u7684\uff0c\u5728\u6d4f\u89c8\u5668\u4e0a\u70b9\u5f00\u9519\u8bef\uff0c\u6211\u4eec\u53d1\u73b0\u662fdist/bundle.js\u7684\u7b2c\u4e03\u884c\u3002\n\u6211\u4eec\u9700\u8981\u5f88\u5feb\u5b9a\u4f4d\u5230\u6e90\u6587\u4ef6\u4e2d\u4ee3\u7801\u7684\u95ee\u9898\uff0c\u5c31\u9700\u8981SourceMap\n*/\ndist/bundle.js\u7684\u7b2c\u4e03\u884c --\x3e src/index.js\u7684\u7b2c\u4e00\u884c\n")),(0,s.kt)("h4",{id:"\u5f00\u542fsourcemap"},"\u5f00\u542fSourceMap"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n  mode: 'development',\n  entry:{...},\n  output:{...},\n  devtool:'eval-source-map',//\u5f00\u542fSourceMap\u4ee3\u7801\u6620\u5c04\uff0c\u5982\u679c\u4e0d\u4f7f\u7528\u5c31\u586bfalse\n  ...\n}\n")),(0,s.kt)("h4",{id:"\u914d\u7f6esourcemap"},"\u914d\u7f6eSourceMap"),(0,s.kt)("p",null,"\u8fd9\u4e2adevtool\u5c5e\u6027\u6709\u5f88\u591a\u53d6\u503c\uff0c\u53c2\u8003\u5b98\u7f51\uff1a",(0,s.kt)("a",{parentName:"p",href:"https://v4.webpack.docschina.org/configuration/devtool/#devtool"},"https://v4.webpack.docschina.org/configuration/devtool/#devtool")),(0,s.kt)("p",null,"\u6ce8\u610f\uff1a\u4e0d\u540c\u7684\u503c",(0,s.kt)("strong",{parentName:"p"},"\u4f1a\u660e\u663e\u5f71\u54cd\u5230\u6784\u5efa"),"(build)\u548c\u91cd\u65b0\u6784\u5efa(rebuild)\u7684\u901f\u5ea6\u3002"),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"SourceMapDevToolPlugin"),(0,s.kt)("em",{parentName:"p"},"/"),(0,s.kt)("inlineCode",{parentName:"p"},"EvalSourceMapDevToolPlugin"),"\u63d2\u4ef6\u6765\u4f7f\u7528sourcemap\u914d\u7f6e\u9879\u66f4\u4e30\u5bcc\u3002"),(0,s.kt)("p",null,(0,s.kt)("em",{parentName:"p"},"\u5207\u52ff\u540c\u65f6\u4f7f\u7528")," ",(0,s.kt)("inlineCode",{parentName:"p"},"devtool")," ",(0,s.kt)("em",{parentName:"p"},"\u9009\u9879\u548c")," ",(0,s.kt)("inlineCode",{parentName:"p"},"SourceMapDevToolPlugin"),(0,s.kt)("em",{parentName:"p"},"/"),(0,s.kt)("inlineCode",{parentName:"p"},"EvalSourceMapDevToolPlugin")," ",(0,s.kt)("em",{parentName:"p"},"\u63d2\u4ef6")),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},"\u5e38\u7528\u7684\u914d\u7f6e\uff1a"),(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("inlineCode",{parentName:"p"},"eval"),"\uff1a\u6253\u5305\u662f\u6700\u5feb\u7684\u3002\u4f7f\u7528\u7684\u662f\uff1ajs\u7684eval\u6765\u6267\u884c\u3002\uff08\u4f46\u662f\u4ee3\u7801\u591a\u4e86\u4e4b\u540e\u4e0d\u662f\u5f88\u51c6\u786e\uff09")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("inlineCode",{parentName:"p"},"inline-source-map"),"\uff1a\u4e0d\u4f1a\u751f\u6210.map\u6587\u4ef6\uff0c\u800c\u662f\u5c06sourcemap\u653e\u5728bundle.js\u6700\u540e\u4e00\u884c\u7528",(0,s.kt)("strong",{parentName:"p"},"base64\u683c\u5f0f\u50a8\u5b58"),"\u3002\uff08",(0,s.kt)("strong",{parentName:"p"},"\u5b8c\u6574\u4ee3\u7801"),"\u6620\u5c04\u5173\u7cfb\uff09")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("inlineCode",{parentName:"p"},"inline-cheap-source-map"),"\uff1a\u751f\u6210\u65b9\u5f0f\u548c\ud83d\udc46\u7684\u4e00\u6837\uff0c\u4f46\u662f\u8fd9\u4e2a\u66f4\u7c97\u7565\uff0c\u6240\u4ee5\u6784\u5efa\u66f4\u5feb\u4e00\u70b9\uff08",(0,s.kt)("strong",{parentName:"p"},"\u884c\u7684\u4ee3\u7801\u6620\u5c04\u3001\u53ea\u4f1a\u8bb0\u5f55\u4e1a\u52a1\u4ee3\u7801\u7684\u6620\u5c04"),"\uff09\u3002")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("inlineCode",{parentName:"p"},"inline-cheap-module-source-map"),"\uff1a\u751f\u6210\u65b9\u5f0f\u548c\ud83d\udc46\u7684\u4e00\u6837\uff0c\uff08",(0,s.kt)("strong",{parentName:"p"},"\u4e5f\u662f\u884c\u4ee3\u7801\u6620\u5c04\uff0c\u4f46\u4e0d\u4ec5\u4f1a\u8bb0\u5f55\u4e1a\u52a1\u4ee3\u7801\u6620\u5c04\uff0c\u800c\u4e14\u4f1a\u8bb0\u5f55\u7b2c\u4e09\u65b9\u5e93\u7684\u4ee3\u7801\u6620\u5c04"),"\uff09")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("inlineCode",{parentName:"p"},"eval-cheap-module-source-map"),"\uff1a\u6700\u4f73\u5b9e\u8df5\u5f00\u53d1\u7684\u73af\u5883\u7528\u8fd9\u4e2a\u3002")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("inlineCode",{parentName:"p"},"cheap-module-source-map"),"\uff1a\u751f\u4ea7\u73af\u5883\u7528\u8fd9\u4e2a\uff08\u7ebf\u4e0a\u53d1\u751f\u9519\u8bef\u7684\u65f6\u5019\u63d0\u793a\u66f4\u5168\u9762\uff09"))))),(0,s.kt)("h2",{id:"4webpackdevserver"},"4\u3011WebpackDevServer"),(0,s.kt)("h4",{id:"\u65b9\u5f0f\u4e00\u547d\u4ee4\u884c"},"\u65b9\u5f0f\u4e00\uff1a\u547d\u4ee4\u884c"),(0,s.kt)("p",null,"\u4f7f\u7528webpack-cli\u547d\u4ee4\u884c\u4e2d\u7684\u53c2\u6570--watch\uff0c\u8bb0\u5f97\u5728HtmlWebpackPlugin\u63d2\u4ef6\u4e2d\u5173\u6389\u7f13\u5b58\u3002"),(0,s.kt)("p",null,"\u5f0a\u7aef\uff1a\u6bcf\u6b21\u4fdd\u5b58\u4ee3\u7801\u4e4b\u540e\uff0c\u9700\u8981\u624b\u52a8\u5237\u65b0\u6d4f\u89c8\u5668\uff08\u800c\u4e14\u6ca1\u6709\u6a21\u5757\u70ed\u66f4\u65b0\u529f\u80fd\uff09\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'//package.json\n{\n  "name": "webpacktest",\n  "scripts": {\n    "test": "echo \\"Error: no test specified\\" && exit 1",\n    "watch": "webpack --watch"\n  }\n  ...\n}\n//webpack.config.js\n new HtmlWebpackPlugin({\n   template: \'./src/index.html\',\n   cache: false//\u5173\u95ed\u7f13\u5b58\n }),\n')),(0,s.kt)("h4",{id:"\u65b9\u5f0f\u4e8c\u4f7f\u7528webpack-dev-server"},"\u65b9\u5f0f\u4e8c\uff1a\u4f7f\u7528webpack-dev-server"),(0,s.kt)("p",null,"\u4f18\u70b9\uff1a\u4fdd\u5b58\u6587\u4ef6\u540e\u4f1a\u76f4\u63a5\u6267\u884c\u91cd\u65b0\u6253\u5305\uff0c\u5e76\u5237\u65b0\u670d\u52a1\u5668\uff08\u6709\u6a21\u5757\u70ed\u66f4\u65b0\u3001\u53ef\u4ee5\u8bf7\u6c42\u8f6c\u53d1\u4ee3\u7406\uff09"),(0,s.kt)("p",null,"\u5206\u4e3a\u4e09\u6b65\uff1a"),(0,s.kt)("p",null,"\u2460\u5b89\u88c5\u5f00\u53d1\u8005\u670d\u52a1\u5668"),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"npm i -D webpack-dev-server")),(0,s.kt)("p",null,"\u2461\u914d\u7f6ewebpack.config.js\u7684devServer\u5c5e\u6027"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//webpack.config.js\nmodule.exports = {\n  entry: {...},\n  //\u914d\u7f6e\u544a\u8bc9devServer\uff0c\u6253\u5305\u597d\u7684\u6587\u4ef6\u8be5\u5230dist\u6587\u4ef6\u5939\u4e0b\u53bb\u53d6\n  devServer: { contentBase: './dist' },\n  mode: 'development',\n  output: {...},\n  ...\n}\n")),(0,s.kt)("p",null,"\u2462\u4f7f\u7528\u547d\u4ee4\u884c\u542f\u52a8"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"webpack serve\n")),(0,s.kt)("h5",{id:"\u8bf7\u6c42\u8f6c\u53d1\u53cd\u5411\u4ee3\u7406"},"\u8bf7\u6c42\u8f6c\u53d1\uff08\u53cd\u5411\u4ee3\u7406\uff09"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//webpack.config.js\nmodule.exports = {\n  entry: {...},\n  devServer: { \n    //\u914d\u7f6e\u544a\u8bc9devServer\uff0c\u6253\u5305\u597d\u7684\u6587\u4ef6\u8be5\u5230dist\u6587\u4ef6\u5939\u4e0b\u53bb\u53d6\n    contentBase: './dist',//\u5728webpack4+\u8be5\u5b57\u6bb5\u4e5f\u53ef\u4ee5\u7528static\n    hot:true,//\u542f\u52a8\u70ed\u6a21\u5757\u66f4\u65b0webpack-dev-server3\u9ed8\u8ba4\u4e0d\u542f\u52a8\uff0c4+\u9ed8\u8ba4\u542f\u52a8\n    proxy:{//\u914d\u7f6e\u53cd\u5411\u4ee3\u7406\n      '/api':{//\u53ea\u8981\u662f\u9047\u5230\u57df\u540d\u540e\u9762\u662f/api\u5f00\u5934\u7684\u8bf7\u6c42\u90fd\u8f6c\u53d1\u5230target\u53bb\n        target:'http://www.baidu.com/',\n        pathRewrite: {//\u5c06/api\u5f00\u5934\u7684\uff0c'/api'\u6539\u6210'api'\n          '^/api': '/api'\n        },\n        changeOrigin:true//\u8de8\u57df\u8bf7\u6c42\n      }\n    }\n  },\n  mode: 'development',\n  output: {...},\n  ...\n};\n\n//index.js\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528fetch\u6765\u8bf7\u6c42\u4e00\u4e2a\u63a5\u53e3\u8bd5\u8bd5\n//\u5176\u5b9e\u63a5\u53e3\u5730\u5740\u662f\uff1ahttp://www.weshineapp.com/api/v1/index/package/3454?offset=0&limit=18\nfetch('/api/v1/index/package/3454?offset=0&limit=18')\n.then(d => d.json()).then(d => console.log(d))\n")),(0,s.kt)("h5",{id:"hmr\u6a21\u5757\u70ed\u66ff\u6362"},"HMR\u6a21\u5757\u70ed\u66ff\u6362"),(0,s.kt)("p",null,"\u9ed8\u8ba4\u662f\u4e0d\u542f\u52a8\u70ed\u6a21\u5757\u66ff\u6362\u7684\uff0c\u9700\u8981\u5728devServer\u914d\u7f6e\u4e2d\u52a0\u4e0a",(0,s.kt)("inlineCode",{parentName:"p"},"hot:true"),"\u3002"),(0,s.kt)("p",null,"\u70ed\u66ff\u6362\u4f1a\u8ba9\u9875\u9762\u4e0d\u4f1a\u8fdb\u884c\u5237\u65b0\uff0c\u800c\u662f",(0,s.kt)("strong",{parentName:"p"},"\u4f1a\u4fdd\u7559\u4fdd\u5b58\u4ee3\u7801\u4e4b\u524d\u7684\u9875\u9762\u8fd0\u884c\u4e2d\u7684\u72b6\u6001"),"\u3002"),(0,s.kt)("p",null,"\u5149\u5149\u5728devServer\u4e2d\u914d\u7f6e",(0,s.kt)("inlineCode",{parentName:"p"},"hot:true"),"\uff0c\u53ea\u80fd\u4fdd\u8bc1\u4e00\u4e9bcss\u4ee3\u7801\u6539\u53d8\u4e4b\u540e\u518d\u4fdd\u5b58\uff0c\u9875\u9762\u7684\u51fd\u6570\u6267\u884c\u72b6\u6001\u4fdd\u7559\u4e0d\u53d8\u3002\uff08\u56e0\u4e3aHMR\u4fee\u6539css\u7684\u65f6\u5019\u4f7f\u7528\u4e86",(0,s.kt)("inlineCode",{parentName:"p"},"style-loader"),"\uff0c\u5e76\u6ca1\u6709\u89e6\u53d1js\u6587\u4ef6\u89e3\u6790\uff0c\u800c\u8fd9\u4e9b\u72b6\u6001\u90fd\u662fJS\u6267\u884c\u4ea7\u751f\u7684\u3002css\u7684HMR\u4e5f\u5c31\u6ca1\u6709JS\u72b6\u6001\u70ed\u66f4\u65b0\u9ebb\u70e6\uff09"),(0,s.kt)("p",null,"\u5982\u679cjs\u4e2d\u4e00\u4e2a\u6a21\u5757\u4ee3\u7801\u6539\u53d8\u4e4b\u540e\u4fdd\u5b58\uff0c\u60f3\u8981\u4e0d\u4e22\u5931\u53e6\u5916\u7684\u6a21\u5757\u7684\u72b6\u6001\uff0c\u8fd8\u9700\u8981\u4e00\u4e9b\u6df1\u5c42\u6b21\u7684\u914d\u7f6e\u3002"),(0,s.kt)("h6",{id:"js\u72b6\u6001\u7684hmr"},"JS\u72b6\u6001\u7684HMR\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"/*\u4e3e\u4e2a\u6817\u5b50\uff1a\n\u4e00\u4e2a\u6a21\u5757\u4e2d\u4f9d\u8d56\u4e86\u4e24\u4e2a\u5b50\u7ec4\u4ef6\uff0c\u6b64\u65f6\u6211\u4eec\u5728\u9875\u9762\u4e0a\u53ef\u4ee5\u70b9\u51fbmodule1\u7ec4\u4ef6\u8fdb\u884c\u8ba1\u6570\u3002\n\u518d\u4fee\u6539module2\u7684\u503c\uff0c\u4fdd\u5b58\u4ee3\u7801\uff0c\u4f1a\u53d1\u73b0HMR\u4e22\u5931\u4e86module1\u7684\u72b6\u6001*/\n\n//index.js\nimport module1 from './module/module1.js'\nimport module2 from './module/module2.js'\n//\u52a0\u8f7d\u6a21\u5757\u4e00\u548c\u6a21\u5757\u4e8c\uff08js\u7684HMR\uff09\nmodule1()\nmodule2()\n\n//module/module1.js\nfunction module1() {\n  const Div = document.createElement('div');\n  Div.innerText = 0\n  Div.setAttribute('id', 'module1')\n  Div.addEventListener('click', () => {\n    Div.innerText++\n  })\n  document.body.appendChild(Div);\n}\nexport default module1\n\n//module/module2.js\nfunction module2() {\n  const Div = document.createElement('div');\n  Div.setAttribute('id', 'module2')\n  Div.innerText = 3000//\u89e6\u53d1\u70b9\u51fb\u6539\u53d8\u4e86module1\u7684\u72b6\u6001\uff0c\u518d\u4fee\u6539module2\u7684\u72b6\u6001\uff0c\u4fdd\u5b58\u4ee3\u7801\uff0c\u4f1a\u53d1\u73b0HMR\u4e22\u5931\u4e86module1\u7684\u72b6\u6001\n  document.body.appendChild(Div);\n}\nexport default module2\n")),(0,s.kt)("p",null,"\u6b64\u65f6\u5982\u679c\u6211\u4eec\u60f3\u8981\u5b9e\u73b0\u66f4\u6539module2\u7684\u4ee3\u7801\uff0c\u4f46\u662fmodule1\u4e2d\u7684\u6267\u884c\u72b6\u6001\u4e0d\u6539\u53d8\uff0c\u5c31\u9700\u8981\u4f7f\u7528module.hot\u8fdb\u884c\u62e6\u622a\u4e00\u4e0b\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//index.js\nimport module1 from './module/module1.js'\nimport module2 from './module/module2.js'\n\n//HMR\u62e6\u622a\nif (module.hot) {\n  //\u4f46\u6211\u4eec\u63a5\u6536\u5230module2.js\u4ee3\u7801\u6539\u53d8\u65f6\u505a\u51fa\u62e6\u622a\uff0c\u53ea\u4f1a\u6267\u884c\u56de\u8c03\u4e2d\u7684\u4ee3\u7801\uff0c\u4e0d\u8fdb\u884c\u5176\u4ed6\u5237\u65b0\n  module.hot.accept('./module/module2.js', () => {\n    //\u5c06\u4e4b\u524d\u7684dom\u5220\u9664\n    document.body.removeChild(document.getElementById('module2'));\n    module2()//\u91cd\u65b0\u6267\u884cmodule2.js\n  })\n}\n\n//\u52a0\u8f7d\u6a21\u5757\u4e00\u548c\u6a21\u5757\u4e8c\uff08js\u7684HMR\uff09\nmodule1()\nmodule2()\n")),(0,s.kt)("h2",{id:"5plugin"},"5\u3011plugin"),(0,s.kt)("h3",{id:"\u5e38\u7528plugin"},"\u5e38\u7528plugin"),(0,s.kt)("p",null,"\u603b\u7ed3\u4e00\u53e5\u8bdd\u5c31\u662f\uff1a\u63d2\u4ef6\u53ef\u4ee5\u5728webpack\u8fd0\u884c\u5728\u67d0\u4e2a\u9636\u6bb5\uff08\u751f\u547d\u5468\u671f\uff09\u505a\u4e00\u4e9b\u4e8b\u60c5\u3002"),(0,s.kt)("p",null,"\u6bd4\u5982\uff1ahtml-webpack-plugin\u5c31\u662f\u5728\u6253\u5305\u7ed3\u675f\u7684\u65f6\u5019\uff0c\u5c06\u6253\u5305\u597d\u7684js\u6587\u4ef6\u5f15\u7528\u5230\u6307\u5b9a\u6a21\u677fhtml\u6587\u4ef6\u4e2d\u3002"),(0,s.kt)("p",null,"\u518d\u6bd4\u5982\uff1a clean-webpack-plugin\u5c31\u662f\u5728\u521a\u5f00\u59cbwebpack\u542f\u52a8\u7684\u65f6\u5019\uff0c\u5c06dist\u6587\u4ef6\u5939\u6e05\u7a7a\u3002"),(0,s.kt)("p",null,"TerserPlugin\uff1a\u9996\u5148\u4e86\u89e3\u4e0b webpack \u4e2d\u7528\u4e8e\u4ee3\u7801\u5220\u9664\u548c\u538b\u7f29\u7684\u4e00\u4e2a\u63d2\u4ef6\uff0cTerserPlugin\u3002 Webpack4.0 \u9ed8\u8ba4\u4f7f\u7528 terser-webpack-plugin \u538b\u7f29\u63d2\u4ef6\uff0c\u5728\u6b64\u4e4b\u524d\u662f\u4f7f\u7528 uglifyjs-webpack-plugin\uff0c\u5176\u4e2d\u7684\u533a\u522b\u662f\u5185\u7f6e\u5bf9 ES6 \u7684\u538b\u7f29\u4e0d\u662f\u5f88\u597d\uff0c\u540c\u65f6\u6211\u4eec\u53ef\u4ee5\u6253\u5f00 parallel \u53c2\u6570\uff0c\u4f7f\u7528\u591a\u8fdb\u7a0b\u538b\u7f29\uff0c\u52a0\u5feb\u538b\u7f29\u3002"),(0,s.kt)("p",null,"webpack-bundle-analyzer\u53ef\u89c6\u5316\u5206\u6790\u6253\u5305\u5927\u5c0f\u3002"),(0,s.kt)("p",null,"mini-css-extract-plugin\u662f\u7528\u6765\u5355\u72ec\u6253\u5305css\uff0c\u7528\u6cd5\u5982\u4e0b"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'plugins: [\n  new MiniCssExtractPlugin({\n    filename: "[name].[chunkhash:8].css",\n    chunkFilename: "[id].css"\n  })\n],\nmodule: {\n  rules: [{\n    test: /\\.css$/,\n    use: [\n      MiniCssExtractPlugin.loader,//\u8fd9\u91cc\u5c31\u4e0d\u4f7f\u7528\'style-loader\'\uff0c\u56e0\u4e3a\u6211\u4eec\u4e0d\u9700\u8981\u4f7f\u7528style\u6807\u7b7e\uff0c\u81ea\u52a8\u4f7f\u7528link\u6807\u7b7e\u94fe\u63a5\u6253\u5305\u597d\u7684css\n      "css-loader"\n    ]\n  }]\n}\n')),(0,s.kt)("h3",{id:"\u624b\u5199plugin"},"\u624b\u5199plugin"),(0,s.kt)("p",null,"\u5728webpack\u7684npm\u4f9d\u8d56\u5305\u4e2d\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u540d\u53ebCompiler.js\u7684\u6587\u4ef6\uff0c\u91cc\u9762\u6709\u6240\u6240\u6709\u7684\u94a9\u5b50\u3002"),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://webpack.docschina.org/api/compiler-hooks/"},"webpack\u63d0\u4f9b\u4e86\u5f88\u591a\u94a9\u5b50"),"\uff0c\u8fd9\u91cc\u7b80\u5355\u4ecb\u7ecd\u51e0\u4e2a\uff1a"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"entryOption : \u5728 webpack \u9009\u9879\u4e2d\u7684 entry \u914d\u7f6e\u9879 \u5904\u7406\u8fc7\u4e4b\u540e\uff0c\u6267\u884c\u63d2\u4ef6\u3002"),(0,s.kt)("li",{parentName:"ul"},"afterPlugins : \u8bbe\u7f6e\u5b8c\u521d\u59cb\u63d2\u4ef6\u4e4b\u540e\uff0c\u6267\u884c\u63d2\u4ef6\u3002"),(0,s.kt)("li",{parentName:"ul"},"compilation : \u7f16\u8bd1\u521b\u5efa\u4e4b\u540e\uff0c\u751f\u6210\u6587\u4ef6\u4e4b\u524d\uff0c\u6267\u884c\u63d2\u4ef6\u3002\u3002"),(0,s.kt)("li",{parentName:"ul"},"emit : \u751f\u6210\u8d44\u6e90\u5230 output \u76ee\u5f55\u4e4b\u524d\u3002"),(0,s.kt)("li",{parentName:"ul"},"done : \u7f16\u8bd1\u5b8c\u6210\u3002")),(0,s.kt)("p",null,"\u5728 ",(0,s.kt)("inlineCode",{parentName:"p"},"compiler.hooks")," \u4e0b\u6307\u5b9a\u4e8b\u4ef6\u94a9\u5b50\u51fd\u6570\uff0c\u4fbf\u4f1a\u89e6\u53d1\u94a9\u5b50\u65f6\uff0c\u6267\u884c\u56de\u8c03\u51fd\u6570\u3002\nWebpack \u63d0\u4f9b","[\u4e09\u79cd\u89e6\u53d1\u94a9\u5b50\u7684\u65b9\u6cd5]","\uff1a"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"tap")," \uff1a\u4ee5",(0,s.kt)("strong",{parentName:"li"},"\u540c\u6b65\u65b9\u5f0f"),"\u89e6\u53d1\u94a9\u5b50\uff1b",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\u56de\u8c03\u65b9\u5f0f:",(0,s.kt)("inlineCode",{parentName:"li"},"(compilation)=>{}")),(0,s.kt)("li",{parentName:"ul"},"\u540c\u6b65\u6267\u884c\u3002"))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"tapAsync")," \uff1a\u4ee5",(0,s.kt)("strong",{parentName:"li"},"\u5f02\u6b65\u65b9\u5f0f"),"\u89e6\u53d1\u94a9\u5b50\uff1b",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\u56de\u8c03\u65b9\u5f0f:",(0,s.kt)("inlineCode",{parentName:"li"},"(compilation,end)=>{end()}")),(0,s.kt)("li",{parentName:"ul"},"\u5fc5\u987b\u4f7f\u7528\u7b2c\u4e8c\u4e2a\u53c2\u6570\u6765\u6267\u884c\uff0c\u7ed3\u675f\u8be5\u56de\u8c03\uff0cwebpack\u624d\u80fd\u7ee7\u7eed\u6267\u884c\u3002"))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"tapPromise")," \uff1a\u4ee5",(0,s.kt)("strong",{parentName:"li"},"\u5f02\u6b65\u65b9\u5f0f"),"\u89e6\u53d1\u94a9\u5b50\uff0c\u8fd4\u56de Promise\uff1b",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\u56de\u8c03\u65b9\u5f0f:",(0,s.kt)("inlineCode",{parentName:"li"},"(compilation)=>Promise")),(0,s.kt)("li",{parentName:"ul"},"\u5fc5\u987b\u4f7f\u7528Promise\u63d0\u4f9b\u7684resolve\u6216\u8005reject\u624d\u80fd\u7ed3\u675f\u56de\u8c03\uff0cwebpack\u624d\u80fd\u7ee7\u7eed\u3002")))),(0,s.kt)("h4",{id:"\u540c\u6b65\u89e6\u53d1"},"\u2460\u540c\u6b65\u89e6\u53d1"),(0,s.kt)("p",null,"\u9700\u8981\u5728\u6211\u4eec\u5199\u7684\u63d2\u4ef6\u7684\u7c7b\u4e2d\u5199\u4e00\u4e2a\u539f\u578b\u65b9\u6cd5apply\u5e76\u4f20\u5165\u4e00\u4e2a\u4e0a\u4e0b\u6587\u5f62\u53c2\u3002"),(0,s.kt)("p",null,"\u56e0\u4e3a\u5728\u5728webpack\u8fc7\u7a0b\u4e2d\uff0c\u4f7f\u7528\u6211\u4eec\u63d2\u4ef6\u7684\u65f6\u5019\uff0c\u4f1a\u8c03\u7528\u6267\u884c\u63d2\u4ef6\u539f\u578b\u4e0a\u7684apply\u65b9\u6cd5\uff0c\u5e76\u5c06\u4e0a\u4e0b\u6587\u5b9e\u4f53\u4f20\u5165\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//CustomPlugin.js\nclass CustomPlugin {\n  apply(compiler) {//compiler.hooks\n    //\u8c03\u7528\u6211\u4eec\u9700\u8981\u4f7f\u7528\u7684\u94a9\u5b50\uff0c\u5e76\u5199\u5165\u56de\u8c03\n    compiler.hooks.done.tap('Hello Custom Plugin', (\n      compilation /* \u5728 hook \u88ab\u89e6\u53ca\u65f6\uff0c\u4f1a\u5c06 compilation \u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u3002 */\n    ) => {\n      console.log(compilation)\n      console.log('Hello Custom Plugin!');\n    });\n  }\n}\nmodule.exports = CustomPlugin\n\n//webpack.config.js\nconst CustomPlugin = require('CustomPlugin');\nmodule.exports={\n  ...//\u4f20\u5165\u7684\u662f\u63d2\u4ef6\u5b9e\u4f8b\n  plugins:[new CustomPlugin()],\n  ...\n}\n")),(0,s.kt)("h4",{id:"\u5f02\u6b65\u89e6\u53d1\u94a9\u5b50"},"\u2461\u5f02\u6b65\u89e6\u53d1\u94a9\u5b50"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"class AsyncPlugin {\n  apply(compiler) {//compiler.hooks\n    //\u4e0b\u9762\u662f\u6307\uff1a\u5f02\u6b65\u8c03\u7528compiler\u7684emit\u94a9\u5b50\n    compiler.hooks.emit.tapAsync('AsyncPlugin', (compilation, end) => {\n      console.log('\u5f00\u59cb\u7b2c\u4e00\u6b21\u7b49\u5f85~~~~~~~~', new Date());\n      setTimeout(() => {\n        console.log('\u7b2c\u4e00\u6b21\u7b49\u5f85\u7ed3\u675f~~~~~~~~', new Date());\n        end()\n      }, 3000)\n    })\n\n    //\u4e0b\u9762\u662f\u6307\uff1a\u5f02\u6b65promise\u8c03\u7528compiler\u7684emit\u94a9\u5b50\n    compiler.hooks.emit.tapPromise('AsyncPlugin', (compilation) => {\n      return new Promise((resolve, reject) => {\n        console.log('\u5f00\u59cb\u7b2c\u4e8c\u6b21\u7b49\u5f85~~~~~~~~', new Date())\n        setTimeout(() => {\n          console.log('\u7b2c\u4e8c\u6b21\u7b49\u5f85\u7ed3\u675f~~~~~~~~', new Date())\n          resolve('')\n        }, 3000)\n      })\n    })\n  }\n}\n\nmodule.exports = AsyncPlugin\n\n/*\u6b64\u65f6\u6267\u884c\u7684\u6253\u5305\u4f1a\u5728\u63a7\u5236\u53f0\u8f93\u51fa\u4e00\u4e0b\u5185\u5bb9\uff1a\n\u5f00\u59cb\u7b2c\u4e00\u6b21\u7b49\u5f85~~~~~~~~ 2021-05-01T04:18:57.491Z\n\u7b2c\u4e00\u6b21\u7b49\u5f85\u7ed3\u675f~~~~~~~~ 2021-05-01T04:19:00.495Z\n\u5f00\u59cb\u7b2c\u4e8c\u6b21\u7b49\u5f85~~~~~~~~ 2021-05-01T04:19:00.496Z\n\u7b2c\u4e8c\u6b21\u7b49\u5f85\u7ed3\u675f~~~~~~~~ 2021-05-01T04:19:03.499Z\n\u7f16\u8bd1\u5b8c\u6210~~~~\n....\nwebpack 5.35.0 compiled successfully in 7078 ms\n*/\n")),(0,s.kt)("h3",{id:"filelistplugin"},"FileListPlugin"),(0,s.kt)("p",null,"\u9996\u5148\u660e\u786e\u9700\u6c42\uff0c\u6211\u4eec\u60f3\u8981\u83b7\u53d6webpack\u6253\u5305\u597d\u7684\u5404\u6587\u4ef6\u7684\u540d\u5b57\u548c\u5927\u5c0f\uff0c\u7136\u540e\u521b\u5efa\u4e00\u4e2amd\u683c\u5f0f\u7684\u6587\u4ef6\u5e76\u8f93\u51fa\u3002\u7ed3\u679c\u9884\u89c8\uff1a\u4ee5\u4e0b\u662f\u6253\u5305\u51fa\u6765\u7684list.md\u6587\u4ef6"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-md"},"## \u6587\u4ef6\u540d    \u8d44\u6e90\u5927\u5c0f\n- lazyLoad_e5d002d4cb2150bdd8ce.bundle.js    13544\n- src_module_module1_js_e5d002d4cb2150bdd8ce.bundle.js    2243\n- index.html    426\n")),(0,s.kt)("p",null,"\u6211\u4eec\u5148\u6765\u770b\u770b\u8be5\u600e\u4e48\u7528\u6211\u4eec\u5199\u7684\u8fd9\u4e2a\u63d2\u4ef6\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//webpack.config.js\nconst FileListPlugin = require('FileListPlugin')\nmodule.exports={\n  ...\n  plugins:[\n    new FileListPlugin({\n      filename:'list.md'\n    })\n  ],\n  ...\n}\n")),(0,s.kt)("p",null,"\u5f00\u59cb\u5199\u4ee3\u7801FileListPlugin.js"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"class FileListPlugin {\n  constructor({ filename }) {\n    this.filename = filename\n  }\n  apply(compiler) {//webpack\u4f1a\u8c03\u7528apply\n    compiler.hooks.emit.tap(//\u540c\u6b65\u5904\u7406\u3002\u4e0d\u9700\u8981\u7ed3\u675f\u56de\u8c03\n      'FileListPlugin',\n      (compilation) => {\n        //\u6211\u4eec\u9700\u8981\u4f7f\u7528assets\u8d44\u6e90\u5bf9\u8c61\u83b7\u53d6\u6253\u5305\u597d\u7684\u6587\u4ef6\u660e\u7ec6\n        const assets = compilation.assets\n        let content = `## \u6587\u4ef6\u540d    \u8d44\u6e90\u5927\u5c0f\\n`\n        Object.entries(assets).forEach(([filename, statObj]) => {\n          //\u83b7\u53d6\u6587\u4ef6\u540d\u548c\u5bf9\u5e94\u6587\u4ef6\u7684\u5927\u5c0f\n          content += `- ${filename}    ${statObj.size()}\\n`\n        })\n        //\u8fd9\u6837\u4f7f\u7528source\u548csize\u5c31\u53ef\u4ee5\u5199\u5165\u5185\u5bb9\u5230\u76f8\u5e94\u6587\u4ef6\n        assets[this.filename] = {\n          source() { return content },\n          size() { return content.length }\n        }\n      })\n  }\n}\nmodule.exports = FileListPlugin\n")),(0,s.kt)("h3",{id:"inlinesourceplugin"},"InlineSourcePlugin"),(0,s.kt)("p",null,"\u9996\u5148\u660e\u786e\u9700\u6c42\uff1a\u5e38\u89c4\u7684\u64cd\u4f5c\u662f\u4f7f\u7528html-webpack-plugin\u5c06\u6253\u5305\u597d\u7684js\u6587\u4ef6\u4ee5\u5916\u94fesrc\u7684\u5f62\u5f0f\u5bfc\u5165html\uff0ccss\u6587\u4ef6\u4e5f\u662f\u4f7f\u7528Link\u5916\u94fe\u7684\u5f62\u5f0f\u53bb\u5bfc\u5165\uff1b\u800c\u6211\u4eec\u73b0\u5728\u7684\u9700\u6c42\u662f\u8981\u628a\u6253\u5305\u597d\u7684",(0,s.kt)("strong",{parentName:"p"},"js\u6587\u4ef6\u5185\u5bb9\u548ccss\u6587\u4ef6\u5185\u5bb9"),"\u76f4\u63a5\u4ee5script\u548cstyle\u6807\u7b7e\u7684\u5f62\u5f0f\u63d2\u5230html\u4e2d\u3002"),(0,s.kt)("p",null,"\u9700\u8981\u914d\u5408html-webpack-plugin\u4e00\u8d77\u4f7f\u7528\uff0c\u56e0\u4e3a\u9700\u8981\u4f7f\u7528\u5230",(0,s.kt)("a",{parentName:"p",href:"https://github.com/jantimon/html-webpack-plugin#events"},"html-webpack-plugin"),"\u7684\u94a9\u5b50api\u5bf9HtmlWebpackPlugin\u6267\u884c\u8fc7\u7a0b\u8fdb\u884c\u5904\u7406\u3002\uff08\u8fd9\u91cc\u6ce8\u610f\u4f7f\u7528alterAssetTagGroups\u94a9\u5b50\uff0c",(0,s.kt)("strong",{parentName:"p"},"\u628a\u4f7f\u7528\u4e86HtmlWebpackPlugin\u63d2\u4ef6\u4e14\u5373\u5c06\u63d2\u5165html\u7684\u6807\u7b7e\u90fd\u8fdb\u884c\u9884\u5904\u7406\u4e00\u4e0b"),"\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u5c06\u5916\u94fe\u7684\u6587\u4ef6\u653e\u5230",(0,s.kt)("strong",{parentName:"p"},"cdn\u8fdb\u884c\u6253\u5305\u4f18\u5316"),"\uff09"),(0,s.kt)("p",null,"\u8fd8\u662f\u6211\u4eec\u5148\u770b\u4e0b\u8be5\u600e\u4e48\u7528\u8fd9\u4e2a\u63d2\u4ef6\u518d\u53bb\u5199\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//webpack.config.js\nconst InlineSourcePlugin = require('InlineSourcePlugin')\nmodule.exports = {\n  ...\n  plugins:[\n    new InlineSourcePlugin({\n      /*\u9700\u8981\u4f20\u5165\u4e00\u4e2a\u6b63\u5219\uff0c\u5224\u65ad\u9700\u8981\u4fee\u6539\u7684\u6807\u7b7e\u4e2d\u5916\u94fe\u6587\u4ef6\u7684\u540e\u7f00\uff0c\n      \u56e0\u4e3a\u4e5f\u6709\u53ef\u80fdlink\u4e00\u4e9bjson\u7b49\u6587\u4ef6\u5230html\u4e2d\uff0c\n      \u76ee\u7684\u662f\u5904\u7406\u5916\u94fe\u6587\u4ef6\u662f.js\u7ed3\u5c3e\u7684script\u6807\u7b7e\u548c\u5916\u94fe\u6587\u4ef6\u662f.css\u7ed3\u5c3e\u7684link\u6807\u7b7e*/\n      match: /\\.(js|css)/\n    })\n  ],\n  ...\n}\n")),(0,s.kt)("p",null,"\u5177\u4f53\u5b9e\u73b0\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"const HtmlWebpackPlugin = require('html-webpack-plugin')\n\n/**\n * \u9996\u5148\u660e\u786e\u9700\u6c42\uff1a\n * \u5e38\u89c4\u7684\u64cd\u4f5c\u662f\u4f7f\u7528html-webpack-plugin\u5c06\u6253\u5305\u597d\u7684js\u6587\u4ef6\u4ee5\u5916\u94fesrc\u7684\u5f62\u5f0f\u5bfc\u5165html\uff0ccss\u6587\u4ef6\u4e5f\u662f\u4f7f\u7528Link\u5916\u94fe\u7684\u5f62\u5f0f\u53bb\u5bfc\u5165\uff1b\n * \u800c\u6211\u4eec\u73b0\u5728\u7684\u9700\u6c42\u662f\u8981\u628a\u6253\u5305\u597d\u7684js\u6587\u4ef6\u5185\u5bb9\u548ccss\u6587\u4ef6\u5185\u5bb9\u76f4\u63a5\u4ee5script\u548cstyle\u6807\u7b7e\u7684\u5f62\u5f0f\u63d2\u5230html\u4e2d\u3002\n */\nclass InlineSourcePlugin {\n  constructor({ match }) {\n    //\u9700\u8981\u4f20\u5165\u4e00\u4e2a\u6b63\u5219\uff0c\u5224\u65ad\u9700\u8981\u5185\u8054\u7684\u6587\u4ef6\u7c7b\u578b\n    this.regex = match\n  }\n  apply(compiler) {\n    //\u9700\u8981\u4f7f\u7528\u5230HtmlWebpackPlugin\u7684\u94a9\u5b50api\u5bf9HtmlWebpackPlugin\u6267\u884c\u8fc7\u7a0b\u8fdb\u884c\u5904\u7406\u3002\n    //1.\u9996\u5148\u628awebpack\u6267\u884c\u4e0a\u4e0b\u6587compilation\u66b4\u9732\u7ed9HtmlWebpackPlugin\u4f7f\u7528\n    compiler.hooks.compilation.tap('InlineSourcePlugin', (compilation) => {\n      //2.\u4f7f\u7528HtmlWebpackPlugin\u63d0\u4f9b\u7684hooks api\u8fdb\u884c\u5904\u7406\n      //https://github.com/jantimon/html-webpack-plugin#events\n      //\u6b64\u65f6\u6211\u4eec\u7528\u5230\u7684\u662falterAssetTagGroups\uff08\u4fee\u6539\u63d2\u5165\u6807\u7b7e\u7ec4\u5230html\u7684\u65f6\u5019\u7684\u94a9\u5b50\uff09\n      HtmlWebpackPlugin.getHooks(compilation).alterAssetTagGroups.tapAsync(\n        'alterPlugin',\n        (data, end) => {\n          // console.log(data)//\u6253\u5370\u51fa\u6765\u7684\u91cd\u8981\u5185\u5bb9\u662f\uff0c\u5c06\u8981\u7ecfHtmlWebpackPlugin\u5904\u7406\u63d2\u5165html\u7684\u6807\u7b7e\u4fe1\u606f\n          //\u9700\u8981\u5199\u4e00\u4e2a\u65b9\u6cd5\u6765\u5904\u7406\u6807\u7b7e\u5e76\u8fd4\u56de\u5904\u7406\u7ed3\u679c\n          data = this.processTags(data, compilation)\n          //\u6210\u529f\u4e4b\u540e\u628a\u5904\u7406\u7ed3\u679c\uff0c\u4ee5\u56de\u8c03\u7684\u65b9\u5f0f\u8fd4\u56de\u53bb\n          end(null, data)\n        }\n      )\n    })\n  }\n  //\u5916\u94fe\u8d44\u6e90\u7684\u6807\u7b7e\u5904\u7406\u6210\u5185\u8054\u7684\u5f62\u5f0f\uff08\u6807\u7b7e+\u5185\u5bb9\uff09\n  processTags(data, compilation) {\n    let headTags = []\n    let bodyTags = []\n    //\u9700\u8981\u5c06\u8981\u5904\u7406\u7684\u9879\u7684\u8bb0\u8fc7\u5206\u522b\u5b58\u5230\u6570\u7ec4\u4e2d\uff0c\u6700\u540e\u4e00\u8d77\u8fd4\u56de\n    data.headTags.forEach(item => {\n      headTags.push(this.handleTag(item, compilation))\n    })\n    data.bodyTags.forEach(item => {\n      bodyTags.push(this.handleTag(item, compilation))\n    })\n    return { ...data, headTags, bodyTags }//\u5c06\u5904\u7406\u7ed3\u679c\u8fd4\u56de\n  }\n  //\u6b63\u5f0f\u5904\u7406\u6807\u7b7e\n  handleTag(tag, compilation) {\n    /*console.log(tag)//\u6253\u5370\u4e00\u4e0b\u5373\u5c06\u63d2\u5165\u7684\u6807\u7b7e\u5bf9\u8c61\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5f00\u59cb\u5b89\u627e\u81ea\u5df1\u7684\u9700\u6c42\u8fdb\u884c\u5904\u7406\u3002\n    {\n      tagName: 'script',\n      voidTag: false,\n      meta: { plugin: 'html-webpack-plugin' },\n      attributes: { defer: true, src: 'index_d187911761f8039b458f.bundle.js' }\n    }\n    {\n      tagName: 'link',\n      voidTag: true,\n      meta: { plugin: 'html-webpack-plugin' },\n      attributes: { href: 'index.70ae7073.css', rel: 'stylesheet' }\n    }*/\n    let newTag = { ...tag };\n    let url;\n    if (tag.tagName === 'link' && this.regex.test(tag.attributes.href)) {\n      //\u5904\u7406\u5916\u94fe\u6587\u4ef6\u662f.css\u7ed3\u5c3e\u7684link\u6807\u7b7e\n      newTag = {\n        tagName: 'style',\n        voidTag: false,\n        attributes: { type: 'text/css' }\n      }\n      url = tag.attributes.href\n      if (url) {\n        //\u4f7f\u7528compilation\u4e0a\u4e0b\u6587\u7684\u8d44\u6e90\u5bf9\u8c61\u83b7\u53d6\u6253\u5305\u597d\u7684\u6587\u4ef6\uff0c\u7136\u540e\u5199\u5165\u5230style\u6807\u7b7e\u7684innerHTML\u5c5e\u6027\u4e0a\n        newTag.innerHTML = compilation.assets[url].source()\n        delete compilation.assets[url]//\u5c06\u539f\u6765\u5c06\u8981\u6253\u5305\u751f\u6210\u7684\u6587\u4ef6\u5220\u9664\u6389\uff0c\u56e0\u4e3a\u5185\u5bb9\u5df2\u7ecf\u653e\u5230\u4e86html\u7684\u6807\u7b7e\u4e2d\n      }\n    }\n\n    if (tag.tagName === 'script' && this.regex.test(tag.attributes.src)) {\n      //\u5904\u7406\u5916\u94fe\u6587\u4ef6\u662f.js\u7ed3\u5c3e\u7684script\u6807\u7b7e\n      newTag = {\n        tagName: 'script',\n        voidTag: false,\n        attributes: { type: 'application/javascript' }\n      }\n      url = tag.attributes.src\n      if (url) {\n        //\u4f7f\u7528compilation\u4e0a\u4e0b\u6587\u7684\u8d44\u6e90\u5bf9\u8c61\u83b7\u53d6\u6253\u5305\u597d\u7684\u6587\u4ef6\uff0c\u7136\u540e\u5199\u5165\u5230script\u6807\u7b7e\u7684innerHTML\u5c5e\u6027\u4e0a\n        newTag.innerHTML = compilation.assets[url].source()\n        delete compilation.assets[url]//\u5c06\u539f\u6765\u5c06\u8981\u6253\u5305\u751f\u6210\u7684\u6587\u4ef6\u5220\u9664\u6389\uff0c\u56e0\u4e3a\u5185\u5bb9\u5df2\u7ecf\u653e\u5230\u4e86html\u7684\u6807\u7b7e\u4e2d\n      }\n    }\n    return newTag//\u8fd4\u56de\u4fee\u6539\u540e\u7684\u65b0\u6807\u7b7e\n  }\n}\n\nmodule.exports = InlineSourcePlugin\n")),(0,s.kt)("p",null,"\u53ef\u4ee5\u7528\u8fd9\u4e2a\u6765\u5b9e\u73b0\u8d44\u6e90\u6253\u5305\u5230cdn\uff0c\u7136\u540e\u518d\u63d2\u5165\u6807\u7b7e\uff0c\u4f18\u5316\u6253\u5305\u3002"),(0,s.kt)("h3",{id:"uploadplugin"},"UploadPlugin"),(0,s.kt)("p",null,"\u9700\u6c42\uff1a\u4f7f\u7528UploadPlugin\u53ef\u4ee5\u5c06\u6253\u5305\u597d\u7684\u6587\u4ef6\u4e0a\u4f20\u5230cdn\u6216oss\u4e0a\u9762\uff0c\u4ece\u800c\u5b9e\u73b0\u81ea\u52a8\u53d1\u5e03\u3002"),(0,s.kt)("p",null,"\u8fd8\u662f\u5148\u6765\u770b\u770b\u8be5\u600e\u4e48\u4f7f\u7528\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//webpack.config.js\nconst UploadPlugin = require('UploadPlugin')\nmodule.exports = {\n  ...\n  output: { \n    //\u6dfb\u52a0src\u65f6\uff0c\u7684\u6839\u8def\u5f84\u6bd4\u5982\u73b0\u5728\u5c31\u662fsrc='http://cdn.xxx.com/[name].bundle.js'\n    publicPath: 'http://cdn.xxx.com/',\n    ...\n  },\n  plugins:[\n    //\u9700\u8981\u4f20\u5165\u4e00\u4e9boss\u3001cdn\u76f8\u5173\u7684\u5bf9\u8c61\u5b58\u50a8\u914d\u7f6e\u9879\n    new UploadPlugin({\n      region: 'oss-cn-chengdu',\n      accessKeyId: '',\n      accessKeySecret: '',\n      bucket: ''\n    })\n  ],\n  ...\n}\n")),(0,s.kt)("p",null,"\u5b9e\u73b0\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"class UploadPlugin {\n  constructor(options) {\n    this.options = options;\n    /*\n    \u4e00\u822c\u4f1a\u53bb\u6267\u884c\u6ce8\u518c\u4e00\u4e9b\u4e0a\u4f20\u76f8\u5173\u7684sdk\u3002\n    */\n  }\n  apply(compiler) {//compiler\u662fwebpack\u63d0\u4f9b\u7684\u6267\u884c\u4e0a\u4e0b\u6587\uff0c\u91cc\u9762\u6709\u94a9\u5b50\n    compiler.hooks.afterEmit.tapPromise('UploadPlugin', (compilation) => {\n      //\u6211\u4eec\u9700\u8981\u53bb\u62ff\u5230\u6253\u5305\u597d\u7684\u6587\u4ef6\uff0c\u7136\u540e\u624d\u80fd\u53bb\u4e0a\u4f20\n      let assets = compilation.assets\n      /*console.log(assets)\n        {\n          'index.6c0f3869.css': SizeOnlySource { _size: 2045 },\n          'index_026f604ab272c4366956.bundle.js': SizeOnlySource { _size: 13811 },\n          'index.html': SizeOnlySource { _size: 472 }\n        }*/\n      let promises = []\n      Object.keys(assets).forEach(filename => {\n        promises.push(this.Upload(filename))\n      })\n      //\u8fd9\u91cc\u4f7f\u7528Promise.all\u6765\u5904\u7406\u591a\u6587\u4ef6\u4e0a\u4f20\n      return Promise.all(promises)\n    })\n  }\n  Upload(filename) {\n    return new Promise((resolve, reject) => {\n      //\u62ff\u5230\u6253\u5305\u597d\u7684\u672c\u5730\u6587\u4ef6\uff0c\u7136\u540e\u624d\u80fd\u6b63\u5e38\u53bb\u4e0a\u4f20\n      let localFile = path.resolve(__dirname, '../dist', filename)\n      /*\n      ...\u4e0a\u4f20oss\u670d\u52a1\u5668\u7684\u4ee3\u7801,\u8fd9\u91cc\u5c31\u4e3b\u8981\u5b9e\u73b0\u4e00\u4e0b\uff0c\u4ecewebpack\u94a9\u5b50\u4e0a\u4e0b\u6587\u4e2d\u62ff\u6253\u5305\u597d\u7684\u6587\u4ef6\u3002\n      */\n      resolve('upload success!!!')\n    })\n  }\n}\n//\u4e0a\u4f20\u6587\u4ef6\u4e4b\u524d\uff0c\u6211\u4eec\u5728webpack.config.js\u7684output\u9879\u4e2d\u8bbe\u7f6epublicPath\u5230cdn\u5c31\u597d\u4e86\u3002\nmodule.exports = UploadPlugin\n")),(0,s.kt)("h2",{id:"6webpack\u6253\u5305\u4f18\u5316"},"6\u3011webpack\u6253\u5305\u4f18\u5316"),(0,s.kt)("p",null,"webpack\u53ef\u4ee5\u505a\u4ec0\u4e48\uff1f\u4ee3\u7801\u8f6c\u6362\u3001\u6587\u4ef6\u4f18\u5316\u3001\u4ee3\u7801\u5206\u5272\u3001\u6a21\u5757\u5408\u5e76\u3001\u6a21\u5757\u70ed\u66ff\u6362\u3001\u4ee3\u7801\u6821\u9a8c\u3001\u81ea\u52a8\u53d1\u5e03\u3002"),(0,s.kt)("h3",{id:"\u539f\u7406\u5206\u6790"},"\u539f\u7406\u5206\u6790\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'//theory_analysis.js\nconsole.log(\'Hello\');\n\n//dist/bundle.js\u6253\u5305\u51fa\u6765\u7684\u7ed3\u679c\n(() => {\n  var __webpack_modules__ = {\n    "./src/theory_analysis.js": () => { eval("console.log(\'Hello\');"); }\n  };\n  var __webpack_exports__ = {};\n  __webpack_modules__["./src/theory_analysis.js"]();\n})();\n')),(0,s.kt)("h3",{id:"webpack\u81ea\u5e26\u7684\u4f18\u5316"},"webpack\u81ea\u5e26\u7684\u4f18\u5316\uff1a"),(0,s.kt)("h4",{id:"1tree-sharking"},"1\u3001tree-sharking"),(0,s.kt)("p",null,"\u4f9d\u8d56\u5173\u7cfb\u7684\u89e3\u6790\uff08\u4e0d\u7528\u7684\u4ee3\u7801\u4e0d\u6253\u5305\uff09",(0,s.kt)("strong",{parentName:"p"},"webpack\u7684\u751f\u4ea7\u73af\u5883\u624d\u4f1a\u4f7f\u7528tree-sharking"),"\u3002"),(0,s.kt)("h4",{id:"2scope-hoisting"},"2\u3001scope-hoisting"),(0,s.kt)("p",null,"\u4f5c\u7528\u57df\u63d0\u5347\uff08\u5b9a\u4e49\u7684\u53d8\u91cf\u6216\u8005\u5e38\u91cf\uff0c\u5982\u679c\u4e0d\u4f20\u5165\u51fd\u6570\u8ba1\u7b97\uff0c\u90fd\u4e0d\u6253\u5305\u5230\u7ed3\u679c\u4e2d\uff0c\u800c\u662f\u76f4\u63a5\u4f7f\u7528\u5b9a\u4e49\u7684\u5e38\u91cf\uff09"),(0,s.kt)("h3",{id:"\u901f\u5ea6\u7684\u4f18\u5316"},"\u901f\u5ea6\u7684\u4f18\u5316\uff1a"),(0,s.kt)("h4",{id:"1happypack"},"1\u3001happypack"),(0,s.kt)("p",null,"\u591a\u7ebf\u7a0b\u6253\u5305\uff08\u6ce8\u610f\u4f53\u79ef\u6bd4\u8f83\u5c0f\u7684\u65f6\u5019\uff0c\u6253\u5305\u6bd4\u8f83\u6162\uff09"),(0,s.kt)("h4",{id:"2dll\u52a8\u6001\u94fe\u63a5\u5e93"},"2\u3001Dll\u52a8\u6001\u94fe\u63a5\u5e93"),(0,s.kt)("p",null,"\u62c6\u4e00\u4e9b\u516c\u5171\u7684\u6587\u4ef6\uff1areact/react-dom/vue/jQuery\uff0c\u5355\u72ec\u6253\u5305\u5230\u4e00\u4e2a\u6587\u4ef6\u3002\u6700\u540e\u5c06\u8fd9\u4e2a\u6587\u4ef6\u653e\u5728cdn\u4e0a\u3002\uff08\u4e5f\u53ef\u4ee5\u5728\u5f00\u53d1\u65f6\u4f7f\u7528dll\uff0c\u94fe\u63a5\u5e93\u53ea\u9700\u8981\u88ab\u6784\u5efa\u4e00\u6b21\uff0c\u5927\u5927\u63d0\u5347\u9879\u76ee\u6784\u5efa\u6548\u7387\uff09"),(0,s.kt)("p",null,"\u4e3b\u8981\u4f7f\u7528\u4e24\u4e2awebpack\u5185\u7f6e\u7684\u63d2\u4ef6\uff1a",(0,s.kt)("strong",{parentName:"p"},"DllPlugin"),"\u3001",(0,s.kt)("strong",{parentName:"p"},"DllReferencePlugin")),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"DllPlugin\uff1a\u751f\u6210\u52a8\u6001\u94fe\u63a5\u5e93dll\u7684\u63d2\u4ef6\u3002\uff08\u5728\u6253\u5305\u6bd4\u8f83\u5927\u7684\u516c\u5171\u6846\u67b6\uff08\u6bd4\u5982react\u3001vue\u3001jQuery\uff09\u6587\u4ef6\u7684webpack\u6253\u5305\u914d\u7f6e\u6587\u4ef6\u4e2d\u4f7f\u7528\uff09"),(0,s.kt)("li",{parentName:"ul"},"DllReferencePlugin\uff1a\u7528\u6765\u5728\u9879\u76ee\u4e2d\u5f15\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u63d2\u4ef6\uff08\u5728\u6784\u5efa\u9879\u76ee\u7684webpack\u6253\u5305\u914d\u7f6e\u6587\u4ef6\u4e2d\u4f7f\u7528\uff09")),(0,s.kt)("h5",{id:"\u6b65\u9aa4\u4e00-1"},"\u6b65\u9aa4\u4e00\uff1a"),(0,s.kt)("p",null,"\u5355\u72ec\u542fwebpack\u914d\u7f6e\u6587\u4ef6\u6253\u5305\u52a8\u6001\u94fe\u63a5\u5e93\u3002\u6211\u4eec\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a",(0,s.kt)("inlineCode",{parentName:"p"},"webpack_dll.config.js"),"\u6587\u4ef6\uff08\u7528\u4e8e\u6253\u5305\u751f\u6210\u52a8\u6001\u94fe\u63a5\u5e93\uff09\uff0c\u4f1a\u7528\u5230DllPlugin\u63d2\u4ef6"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//webpack_dll.config.js\n//\u5355\u72ec\u6253\u5305react\u7528\u52a8\u6001\u94fe\u63a5\u5e93Dll\nconst path = require('path');\nconst webpack = require('webpack')\nmodule.exports = {\n  mode: 'development',\n  entry: {\n    /*\u628a\u9879\u76ee\u9700\u8981\u6240\u6709\u7684 react \u76f8\u5173\u7684\u653e\u5230\u4e00\u4e2a\u5355\u72ec\u7684\u52a8\u6001\u94fe\u63a5\u5e93\n      \u53c8\u4f8b\u5982\uff1avue: ['vue', 'vuex', 'vue-router'],\n      jquery: ['jQuery']*/\n    react: ['react', 'react-dom']\n  },\n  output: {\n    filename: '[name].dll.js',//\u6253\u5305\u540e\u7684\u6587\u4ef6\u540d\u79f0\n    path: path.resolve(__dirname, 'dll'),//\u8f93\u51fa\u5230\u7684\u6587\u4ef6\u5939\n    library: '_dll_[name]'//\u5b58\u653e\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u5168\u5c40\u53d8\u91cf\u540d\u79f0\uff0c\u52a0\u4e0a_dll_\u662f\u4e3a\u4e86\u9632\u6b62\u5168\u5c40\u53d8\u91cf\u51b2\u7a81\n  },\n  plugins: [\n    //\u4f7f\u7528webpack\u5185\u7f6e\u7684\u751f\u6210\u52a8\u6001\u94fe\u63a5\u5e93dll\u7684\u63d2\u4ef6\uff08\u4f1a\u751f\u6210\u4e24\u4e2a\u6587\u4ef6\uff0c\u4e00\u4e2a\u662f\u6253\u5305\u597d\u7684\u5e93\u4ee3\u7801\uff0c\u53e6\u4e00\u4e2a\u662f\u6620\u5c04\u6587\u4ef6\uff09\n    new webpack.DllPlugin({\n      /*\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u5168\u5c40\u53d8\u91cf\u540d\u79f0\uff0c\u9700\u8981\u548c output.library \u4e2d\u4fdd\u6301\u4e00\u81f4\n        \u8be5\u5b57\u6bb5\u7684\u503c\u4e5f\u5c31\u662f\u8f93\u51fa\u7684 manifest.json \u6587\u4ef6 \u4e2d name \u5b57\u6bb5\u7684\u503c\n        \u4f8b\u5982 react.manifest.json \u4e2d\u5c31\u6709 \"name\": \"_dll_react\"*/\n      name: '_dll_[name]',\n      // \u63cf\u8ff0\u52a8\u6001\u94fe\u63a5\u5e93\u7684 manifest.json \u6587\u4ef6\u8f93\u51fa\u65f6\u7684\u6587\u4ef6\u540d\u79f0\n      path: path.join(__dirname, 'dll', '[name].manifest.json'),\n    })\n  ]\n}\n")),(0,s.kt)("h5",{id:"\u6b65\u9aa4\u4e8c-1"},"\u6b65\u9aa4\u4e8c\uff1a"),(0,s.kt)("p",null,"\u6b64\u65f6\uff0c\u6211\u4eec\u4e3a\u4e86\u65b9\u4fbf\uff0c\u9700\u8981\u5728",(0,s.kt)("inlineCode",{parentName:"p"},"package.json"),"\u4e2d\u521b\u5efa\u6253\u5305\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u811a\u672c\u547d\u4ee4\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "webpacktest",\n  "version": "1.0.0",\n  "description": "",\n  "main": "webpack.config.js",\n  "scripts": {\n        ...\n    "dll": "webpack --mode development --config webpack_dll.config.js"\n  },\n  ...\n}\n')),(0,s.kt)("p",null,"\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u6267\u884c\u547d\u4ee4",(0,s.kt)("inlineCode",{parentName:"p"},"npm run dll"),"\uff0c\u5c06\u52a8\u6001\u94fe\u63a5\u5e93\u6253\u5305\u597d\u4e86\u3002\u5e76\u8f93\u51fa\u5230dll\u6587\u4ef6\u5939\u4e0b\uff0c\u751f\u6210\u4e86\u4e24\u4e2a\u6587\u4ef6",(0,s.kt)("inlineCode",{parentName:"p"},"react.dll.js"),"\uff08\u6253\u5305\u7684\u5e93\u4ee3\u7801\uff09\u548c",(0,s.kt)("inlineCode",{parentName:"p"},"react.manifest.json"),"\uff08\u52a8\u6001\u94fe\u63a5\u6620\u5c04\u6587\u4ef6\uff09\uff08\u8fd9\u4e2a\u6253\u5305\u597d\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u53ef\u4ee5\u653e\u5230cdn\u4e0a\u8fdb\u884c\u4f18\u5316\uff09"),(0,s.kt)("h5",{id:"\u6b65\u9aa4\u4e09"},"\u6b65\u9aa4\u4e09\uff1a"),(0,s.kt)("p",null,"\u5728html\u6587\u4ef6\u4e2d\u4ee5script\u6807\u7b7e\u7684\u5f62\u5f0f",(0,s.kt)("strong",{parentName:"p"},"\u624b\u52a8\u63d2\u5165\u52a8\u6001\u94fe\u63a5\u5e93")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <meta http-equiv="X-UA-Compatible" content="IE=edge">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>webpack\u6d4b\u8bd5\u6253\u5305</title>\n  \x3c!-- \u5e93\u6587\u4ef6\u5fc5\u987b\u8981\u653e\u5728\u6700\u524d\u9762 --\x3e\n  <script defer src="../dll/react.dll.js"><\/script>\n  <script defer src="theory_analysis_38a7916d0fdc58ecb1c9.bundle.js"><\/script>\n</head>\n<body>\n  <h1>\u5934\u50cf</h1>\n  <div id="app"></div>\n</body>\n</html>\n')),(0,s.kt)("p",null,"\u8fd9\u65f6\u5019\u8fd8\u4e0d\u884c\uff0c\u56e0\u4e3a\u867d\u7136\u6211\u4eec\u8fd9\u6837\u5f15\u5165\u4e86\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u4f46\u662fbundle.js\u6253\u5305\u51fa\u6765\u7684\u4ee3\u7801\u8fd8\u4e0d\u77e5\u9053\u8be5\u600e\u4e48\u53bb\u4f7f\u7528\u8fd9\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u6240\u4ee5\u8fd8\u5f97\u5728\u9879\u76ee\u6253\u5305\u7684\u65f6\u5019\u8fdb\u884c\u4f7f\u7528DllReferencePlugin"),(0,s.kt)("h5",{id:"\u6b65\u9aa4\u56db"},"\u6b65\u9aa4\u56db\uff1a"),(0,s.kt)("p",null,"\u9879\u76eewebpack\u914d\u7f6e\u4e2d\u4f7f\u7528DllReferencePlugin\u8fdb\u884c\u5f15\u7528\u5e93\u3002\u4f7f\u7528\u4e86\u8fd9\u4e2a\u63d2\u4ef6\uff0cwebpack\u6253\u5305\u7684\u65f6\u5019\u5c31\u4f18\u5148\u4f1a\u53bb\u4f7f\u7528dll\u52a8\u6001\u94fe\u63a5\u5e93\u4e2d\u7684\u53d8\u91cf\uff0c\u4e0d\u4f1a\u518d\u53bbreact\u8fd9\u4e9b\u6846\u67b6\u4e86\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//webpack.config.js\nconst path = require('path')\nconst webpack = require('webpack')\n//\u751f\u6210\u4e00\u4e2ahtml\u6a21\u677f\nconst HtmlWebpackPlugin = require('html-webpack-plugin')\n//\u542f\u52a8\u65f6\u6e05\u7a7adist\u6587\u4ef6\u5939\nconst { CleanWebpackPlugin } = require('clean-webpack-plugin')\n\nmodule.exports = {\n  entry: {//\u5165\u53e3\n    theory_analysis: './src/theory_analysis.js'\n  },\n  mode: 'development',\n  output: {\n    filename: '[name]_[hash].bundle.js',\n    path: path.join(__dirname, 'dist')//\u6253\u5305\u5230\u7684\u6587\u4ef6\u5939\n  },\n  plugins: [//\u4f7f\u7528\u63d2\u4ef6\n    new CleanWebpackPlugin(),\n    new HtmlWebpackPlugin({\n      template: './src/index.html',\n      filename: 'index.html',\n      cache: false\n    }),\n    //\u5f15\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u63d2\u4ef6(\u544a\u8bc9webpack\u6211\u4eec\u7528\u4e86\u54ea\u4e9b\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u8be5\u600e\u4e48\u4f7f\u7528\u8fd9\u4e9bdll)\n    new webpack.DllReferencePlugin({\n      //\u9700\u8981\u627e\u5230\u751f\u6210\u7684dll\u52a8\u6001\u94fe\u63a5\u5e93\u7684manifest\u6620\u5c04\u6587\u4ef6\n      manifest: path.resolve(__dirname, 'dll', 'react.manifest.json')\n      //manifest: require('./dll/react.manifest.json'),//\u8fd9\u6837\u4e5f\u53ef\u4ee5\n    })\n  ],\n.....\n}\n")),(0,s.kt)("p",null,"\u8fd9\u662f\u6211\u6253\u5305\u7684js\u6587\u4ef6\uff0c\u4f7f\u7528\u4e86react\u548creact-dom"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-jsx"},"//theory_analysis.js\nimport React from 'react'\nimport { render } from 'react-dom'\n\nconst App = () => {\n  return <div>\u8fd9\u662freact-app</div>\n}\n\nrender(<App />, document.getElementById('app'))\n")),(0,s.kt)("h4",{id:"3externals\u914d\u7f6e\u9879\u5ffd\u7565\u6253\u5305"},"3\u3001Externals\u914d\u7f6e\u9879\u5ffd\u7565\u6253\u5305"),(0,s.kt)("p",null,"\u5f53\u5728webpack.config.js\u4e2d\u914d\u7f6eExternals \u9879\u65f6\uff0cExternals \u9879\u7528\u6765\u544a\u8bc9 Webpack \u6784\u5efa\u65f6\u4ee3\u7801\u4e2d\u4f7f\u7528\u4e86\u54ea\u4e9b\u4e0d\u7528\u88ab\u6253\u5305\u7684\u6a21\u5757\u3002Externals\u53ef\u4ee5\u5bf9\u67d0\u4e00\u4e2a\u7b2c\u4e09\u65b9\u6846\u67b6 \u6216\u8005 \u5e93",(0,s.kt)("strong",{parentName:"p"},"\u653e\u5230\u8fd0\u884c\u73af\u5883\u7684\u5168\u5c40\u53d8\u91cf\u4e2d"),"\u3002\u4f8b\u5982\uff1avue\u653e\u5230\u5230\u8fd0\u884c\u73af\u5883\u7684\u5168\u5c40\u53d8\u91cf\u4e2d \u6216\u8005 vuex\u653e\u5230\u5230\u8fd0\u884c\u73af\u5883\u7684\u5168\u5c40\u53d8\u91cf\u4e2d\u3002"),(0,s.kt)("h3",{id:"\u4f53\u79ef\u7684\u4f18\u5316"},"\u4f53\u79ef\u7684\u4f18\u5316\uff1a"),(0,s.kt)("h4",{id:"1webpackignoreplugin"},"1\u3001webpack.IgnorePlugin()"),(0,s.kt)("p",null,"\u5ffd\u7565\u4e0d\u7528\u7684\u56fd\u9645\u5316\u8bed\u8a00\u5305\u3002"),(0,s.kt)("p",null,"\u5178\u578b\uff1amoment.js"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"plugins:[\n  ...\n  new webpack.IgnorePlugin(/\\.\\/locale/,/moment/)\n]\n")),(0,s.kt)("h4",{id:"2\u62bd\u79bb\u516c\u5171\u4ee3\u7801\u5757"},"2\u3001\u62bd\u79bb\u516c\u5171\u4ee3\u7801\u5757"),(0,s.kt)("p",null,"optimization\u914d\u7f6e\u9879\u4e2d\u7684splitChunks\u5206\u5272\u4ee3\u7801\u5757"),(0,s.kt)("p",null,"\u4e00\u822c\u591a\u4e2a\u5165\u53e3\u6253\u5305\u624d\u4f7f\u7528\u62bd\u79bb\u516c\u5171\u4ee3\u7801\u5757\uff08\u5c06\u4ee5\u5df2\u6253\u5305\u597d\u7684\u4ee3\u7801\u8fdb\u884c\u62bd\u79bb\uff09"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//webpack.config.js\nmodule.exports={\n  entry:{\n    index:'./src/index.js'\n    other:'./src/other.js'\n  },\n  ...,\n  optimization:{//\u4f18\u5316\n    splitChunks:{//\u5206\u5272\u4ee3\u7801\u5757\uff08\u5c06\u4ee5\u5df2\u6253\u5305\u597d\u7684\u4ee3\u7801\u8fdb\u884c\u62bd\u79bb\uff09\n        cacheGroup:{//\u7f13\u5b58\u7ec4\n            common:{//\u7f13\u5b58\u7ec4\u7684\u540d\u79f0\u53ebcommon\n                chunks:'initial',//\u5b9a\u4e49\u4ec0\u4e48\u65f6\u5019\u8fdb\u884c\u62bd\u79bb\uff0c\u521a\u5f00\u59cb\u5c31\u5f00\u59cb\u62bd\u79bb\n                minSize:0,//\u4ee3\u7801\u5757\u6700\u5c0f\u591a\u5927\uff0c\u624d\u5f00\u59cb\u63d0\u53d6\n                minChunks:2//\u4ee3\u7801\u5757\u6700\u5c11\u516c\u7528\u8fc7\u591a\u5c11\u6b21\u7684\u4ee3\u7801\u624d\u8fdb\u884c\u63d0\u53d6\n                },\n            vendor:{//\u7b2c\u4e09\u65b9\u5e93\u6587\u4ef6\u5355\u72ec\u8fdb\u884c\u62bd\u79bb\uff0c\u5b9a\u4e49\u540d\u79f0\u53ebvendor\n          priority:1,//\u5b9a\u4e49\u6743\u91cd\uff0c\u5148\u62bd\u79bb\u7b2c\u4e09\u65b9\u5e93\u6587\u4ef6\uff0c\u518d\u53bb\u62bd\u79bb\u5176\u4ed6\u7684\u6587\u4ef6\n          test:/node_modules/,//\u53ea\u53bb\u628anode_module\u4e2d\u4f7f\u7528\u8fc7\u7684\u4ee3\u7801\u62bd\u79bb\u51fa\u6765\n          chunks:'initial',//\u4e5f\u662f\u521a\u5f00\u59cb\u7684\u65f6\u5019\u8fdb\u884c\u62bd\u79bb\n          minSize:0,\n          minChunks:2\n        }\n            }\n        }\n    }\n}\n")),(0,s.kt)("h3",{id:"\u61d2\u52a0\u8f7d\u6a21\u5757\u6309\u9700\u52a0\u8f7d"},"\u61d2\u52a0\u8f7d\u6a21\u5757\uff08\u6309\u9700\u52a0\u8f7d\uff09"),(0,s.kt)("p",null,"webpack\u63d0\u4f9b\u6309\u9700\u52a8\u6001\u52a0\u8f7d\uff0c\u4f7f\u7528import\u8bed\u6cd5\uff08ajax\u6765\u5b9e\u73b0\u7684\uff09\uff08\u6216\u8005",(0,s.kt)("inlineCode",{parentName:"p"},"require.ensure"),"\u4e5f\u53ef\u4ee5\u52a8\u6001\u52a0\u8f7d\uff09"),(0,s.kt)("p",null,"\u4f7f\u7528import\u8bed\u6cd5\u52a8\u6001\u5bfc\u5165\uff0cwebpack\u4f1a\u5c06\u8be5\u6587\u4ef6\u5355\u72ec\u6253\u5305\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//index.js\nimport('./source.js').then(data=>{//es6\u8349\u6848\u4e2d\u7684\u8bed\u6cd5\uff0cajax\u5b9e\u73b0\n  console.log(data.default)\n})\n\n//source.js\nexport default 'Hello'\n")),(0,s.kt)("p",null,"import\u8bed\u6cd5\u61d2\u52a0\u8f7d\u539f\u7406\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"//\u6a21\u5757\uff1afile.js\nfunction getJSON(url, callback) {\n  let xhr = new XMLHttpRequest();\n  xhr.onload = function () {\n    callback(this.responseText)\n  };\n  xhr.open('GET', url, true);\n  xhr.send();\n}\nexport function getUsefulContents(url, callback) {\n  getJSON(url, data => callback(JSON.parse(data)));\n}\n\n//\u4e3b\u7a0b\u5e8f\uff1amain.js\nimport { getUsefulContents } from '/modules/file.js';\ngetUsefulContents('http://www.example.com',\n    data => { doSomethingUseful(data) });\n")),(0,s.kt)("h3",{id:"react\u61d2\u52a0\u8f7d"},"React\u61d2\u52a0\u8f7d"),(0,s.kt)("p",null,"React\u4e2d\u53ef\u4ee5\u4f7f\u7528lazy\u6765\u5b9e\u73b0\u61d2\u52a0\u8f7d\u7ec4\u4ef6\u3002"),(0,s.kt)("p",null,"React.lazy \u51fd\u6570\u8ba9\u4f60\u53ef\u4ee5\u53ef\u4ee5\u50cf\u5bfc\u5165\u5c06\u5e38\u89c4\u7ec4\u4ef6\u4e00\u6837\u7684\u6e32\u67d3\u4e00\u4e2a\u52a8\u6001\u5bfc\u5165\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"import OtherComponent from './OtherComponent';\n// React.lazy\nconst OtherComponent = React.lazy(() => import('./OtherComponent'));\n")),(0,s.kt)("p",null,"\u9996\u6b21\u5448\u73b0\u6b64\u7ec4\u4ef6\u65f6\uff0c\u5b83\u5c06\u81ea\u52a8\u52a0\u8f7d\u5305\u542bOtherComponent\u7684\u6346\u7ed1\u5305\u3002"),(0,s.kt)("p",null,"React.lazy \u91c7\u7528\u4e86\u5fc5\u987b\u8c03\u7528\u52a8\u6001 import\uff08\uff09\u7684\u51fd\u6570\u3002\n\u8fd9\u5fc5\u987b\u8fd4\u56de\u4e00\u4e2a Promise\uff0c\u8be5 Promise \u89e3\u6790\u4e3a\u4e00\u4e2a\u5e26\u6709\u9ed8\u8ba4\u5bfc\u51fa\u7684\u6a21\u5757\uff0c\u8be5\u6a21\u5757\u5305\u542b\u4e00\u4e2a React\u7ec4\u4ef6\u3002"),(0,s.kt)("p",null,"\u7136\u540e\uff0c\u5e94\u8be5\u5c06\u61d2\u60f0\u7684\u7ec4\u4ef6\u5448\u73b0\u5728Suspense\u7ec4\u4ef6\u4e2d\uff0c\u8fd9\u4f7f\u6211\u4eec\u53ef\u4ee5\u5728\u7b49\u5f85\u61d2\u60f0\u7684\u7ec4\u4ef6\u52a0\u8f7d\u65f6\u663e\u793a\u4e00\u4e9b\u540e\u5907\u5185\u5bb9\uff08\u4f8b\u5982\u52a0\u8f7d\u6307\u793a\u7b26\uff09\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"import React, { Suspense } from 'react';\n\nconst OtherComponent = React.lazy(() => import('./OtherComponent'));\n\nfunction MyComponent() {\n  return (\n    <div>\n      <Suspense fallback={<div>Loading...</div>}>\n        <OtherComponent />\n      </Suspense>\n    </div>\n  );\n}\n")),(0,s.kt)("p",null,"fallback prop \u652f\u6301\u5728\u7b49\u5f85\u7ec4\u4ef6\u52a0\u8f7d\u65f6\u63a5\u53d7\u8981\u6e32\u67d3\u7684\u4efb\u4f55React\u5143\u7d20"),(0,s.kt)("p",null,"\u60a8\u53ef\u4ee5\u5c06 Suspense \u7ec4\u4ef6\u653e\u7f6e\u5728 lazy \u7ec4\u4ef6\u4e0a\u65b9\u7684\u4efb\u4f55\u4f4d\u7f6e"),(0,s.kt)("p",null,"\u60a8\u751a\u81f3\u53ef\u4ee5\u7528\u4e00\u4e2a Suspense \u7ec4\u4ef6\u5305\u88c5\u591a\u4e2a\u60f0\u6027\u7ec4\u4ef6\u3002"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"import React, { Suspense } from 'react';\n\nconst OtherComponent = React.lazy(() => import('./OtherComponent'));\n\nconst AnotherComponent = React.lazy(() => import('./AnotherComponent'));\n\nfunction MyComponent() {\n  return (\n    <div>\n      <Suspense fallback={<div>Loading...</div>}>\n        <section>\n          <OtherComponent />\n          <AnotherComponent />\n        </section>\n      </Suspense>\n    </div>\n  );\n}\n")),(0,s.kt)("h2",{id:"7resolve\u914d\u7f6e"},"7\u3011resolve\u914d\u7f6e"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"}," resolve: {\n   extensions: ['.tsx', '.jsx', '.js'],//\u4e0d\u9700\u8981\u5199\u540e\u7f00\u540d\uff0c\u6309\u987a\u5e8f\u53bb\u627e\u6587\u4ef6\n     alias: {//\u522b\u540d\n       '@': path.resolve(__dirname, 'src')\n     },\n       modules: [path.resolve(__dirname, \"./src/\"), \"node_modules\"]\n   //\u544a\u8bc9 webpack \u89e3\u6790\u6a21\u5757\u65f6\u5e94\u8be5\u641c\u7d22\u7684\u76ee\u5f55\uff0c\u5373 require \u6216 import \u6a21\u5757\u7684\u65f6\u5019\uff0c\u53ea\u5199\u6a21\u5757\u540d\u7684\u65f6\u5019\uff0c\u5230\u54ea\u91cc\u53bb\u627e\uff0c\u5176\u5c5e\u6027\u503c\u4e3a\u6570\u7ec4\uff0c\u56e0\u4e3a\u53ef\u914d\u7f6e\u591a\u4e2a\u6a21\u5757\u641c\u7d22\u8def\u5f84\uff0c\u5176\u641c\u7d22\u8def\u5f84\u5fc5\u987b\u4e3a\u7edd\u5bf9\u8def\u5f84\uff0c\n },\n")),(0,s.kt)("h2",{id:"8localstorage\u7f13\u5b58js\u5b9e\u8df5"},"8\u3011localStorage\u7f13\u5b58js\u5b9e\u8df5"),(0,s.kt)("p",null,(0,s.kt)("img",{parentName:"p",src:"https://img-blog.csdnimg.cn/20210502193207855.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTIyMTAzNg==,size_16,color_FFFFFF,t_70",alt:"\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0"})),(0,s.kt)("p",null,"\u601d\u8def:"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"js\u5305\u90fd\u4e0d\u4ee5script\u6807\u7b7e\u7684\u5f62\u5f0f\u63d2\u5165\u5230html\u4e2d\uff0c\u800c\u662f\u9700\u8981\u4ee5dom\u7684\u5f62\u5f0f\u52a8\u6001\u8bbe\u7f6escript\uff0c\u5e76\u5199\u5165\u811a\u672c\u3002"),(0,s.kt)("li",{parentName:"ol"},"\u5224\u65adbundle\u7f13\u5b58\u662f\u5426\u8fc7\u671f\uff1a\u4f7f\u7528htmlwebpackplugin\u6253\u5305\u65f6\u4e0d\u63d2\u5165script\u6807\u7b7e\uff0c\u800c\u662f\u63d2\u5165",(0,s.kt)("div",null,"z89e0af6.bundle.js"),"\u4f46\u662f\u4e0d\u8ba9\u5b83\u663e\u793a\u3002\uff08\u6211\u4eec\u9700\u8981\u624b\u52a8\u5199\u63d2\u4ef6\u8fdb\u884c\u62e6\u622a\uff09"),(0,s.kt)("li",{parentName:"ol"},"\u5728index.html\u4e2d\u5199\u811a\u672c\u8fdb\u884c\u5224\u65ad\u3002")),(0,s.kt)("h3",{id:"dll\u6253\u5305"},"dll\u6253\u5305"),(0,s.kt)("p",null,"dll\u6253\u5305\u8fd9\u91cc\u5c31\u4e0d\u591a\u8bf4\u4e86\u3002"),(0,s.kt)("h3",{id:"bundlenameplugin"},"BundleNamePlugin"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"const HtmlWebpackPlugin = require('html-webpack-plugin')\n\nclass BundleNamePlugin {\n  apply(compiler) {\n    compiler.hooks.compilation.tap('BundleNamePlugin', (compilation) => {\n      HtmlWebpackPlugin.getHooks(compilation).alterAssetTagGroups.tapAsync(\n        'alterPlugin',\n        (data, end) => {\n          data = this.processTags(data, compilation)\n          end(null, data)\n        }\n      )\n    })\n  }\n  processTags(data, compilation) {\n    //data\u662fhtmlwebpackplugin\u8981\u63d2\u5165\uff08\u7b49\u64cd\u4f5c\uff09\u7684\u6807\u7b7e\u4fe1\u606f\n    let bodyTags = data.bodyTags\n    //\u5c06bundlejsName\u63d2\u5165\u5230html\u4e2d\n    let newTag = {\n      tagName: 'div',\n      voidTag: false,\n      attributes: { style: 'display:none', id: \"bundleName\" }\n    }\n    let bundleName\n    data.headTags.forEach(item => {\n      if (item.tagName === 'script') {\n        bundleName = item.attributes.src\n      }\n    })\n    newTag.innerHTML = bundleName\n    bodyTags.push(newTag)\n    return {\n      ...data, bodyTags, headTags: [] //\u672c\u6765\u8981\u63d2\u5165bundlejs\u7684script\u6807\u7b7e,\u8fd9\u91cc\u5c31\u628aheaderTags\u7f6e\u7a7a\uff0c\u4e0d\u63d2\u5165\n    }\n  }\n}\nmodule.exports = BundleNamePlugin\n")),(0,s.kt)("h3",{id:"\u7f13\u5b58\u5224\u65ad\u811a\u672c"},"\u7f13\u5b58\u5224\u65ad\u811a\u672c"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-html"},'<!DOCTYPE html>\n<html lang="en">\n\n<head>\n  <meta charset="UTF-8">\n  <meta http-equiv="X-UA-Compatible" content="IE=edge">\n  <meta name="viewport"\n    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">\n  <title>xxx</title>\n</head>\n\n<body>\n  <div id="app"></div>\n  <div style="display:none" id="bundleName">\n    /z89e0af6.bundle.js\n  </div>\n</body>\n<script>\n  //\u5224\u65ad\u672c\u5730\u662f\u5426\u6709dll\uff08dll\u7684\u90fd\u662f\u4f9d\u8d56\u5305\uff0c\u4e0d\u4f1a\u53d8\u7684\u4e0d\u9700\u8981\u8bbe\u7f6ehash\u540d\uff09\n  var ReactDll = window.localStorage.getItem(\'react.dll.js\')\n  //\u4ecediv\u4e2d\u83b7\u53d6bundle\u7684hash\u6587\u4ef6\u540d\uff08\u9700\u8981\u6253\u5305\u7684\u65f6\u5019\u63d0\u524d\u690d\u5165html\u4e2d\uff09\n  var bundleName = document.getElementById(\'bundleName\').innerText\n  //\u5224\u65ad\u672c\u5730\u662f\u5426\u6709Bundle\n  var Bundle = window.localStorage.getItem(getFilename(bundleName))\n  //bundle\u7684\u7f13\u5b58\u8fc7\u671f\u5219\u79fb\u9664\n  if (hasBundle() !== getFilename(bundleName)) {\n    localStorage.removeItem(hasBundle())\n  }\n  if (ReactDll) {//reactDll\u6709\u7f13\u5b58\n    eval.call(window, ReactDll)//\u6267\u884c\u7f13\u5b58\u51fd\u6570\u5fc5\u987b\u6302\u8f7d\u5230\u5168\u5c40\uff0c\u5426\u5219\u4f1a\u88ab\u5783\u573e\u56de\u6536\n    if (hasBundle() === getFilename(bundleName)) {//Bundle\u6ca1\u8fc7\u671f\n      eval.call(window, Bundle)//\u6267\u884c\u7f13\u5b58\u51fd\u6570\u5fc5\u987b\u6302\u8f7d\u5230\u5168\u5c40\uff0c\u5426\u5219\u4f1a\u88ab\u5783\u573e\u56de\u6536\n    } else {//Bundle\u8fc7\u671f\n      cacheBundle()\n    }\n  } else {//\u5426\u5219\u90fd\u4e0d\u7528\u7f13\u5b58\n    cacheReactDll(cacheBundle)//\u4e00\u5b9a\u8981\u7528\u56de\u8c03\uff0c\u56e0\u4e3aBundle\u4f9d\u8d56\u4e8eDll\uff0c\u5fc5\u987b\u5148\u6267\u884cDll\uff0c\u5426\u5219\u62a5\u9519\n  }\n\n  //\u7b2c\u4e00\u6b21\u83b7\u53d6\u5e76\u7f13\u5b58Dll\n  function cacheReactDll(cb) {\n    FetchFile(\'https://xxx.aliyuncs.com/cdn/react.dll.js\', cb)\n  }\n  //\u7b2c\u4e00\u6b21\u83b7\u53d6\u5e76\u7f13\u5b58Bundle\n  function cacheBundle() {\n    FetchFile(location.href + getFilename(bundleName))\n  }\n\n  //\u9996\u6b21\u83b7\u53d6\u8d44\u6e90js\u6587\u4ef6,\u5e76\u5199\u5165\u5230localstorage\n  function FetchFile(url, cb) {\n    fetch(url)\n      .then(res => res.blob())\n      .then(myBlob => {\n        var reader = new FileReader()\n        reader.onload = () => {\n          var script = document.createElement(\'script\')\n          script.innerHTML = reader.result\n          script.type = \'text/javascript\';\n          document.querySelector(\'head\').appendChild(script)\n          window.localStorage.setItem(getFilename(url), reader.result)\n          cb && cb();\n        }\n        reader.readAsText(myBlob)\n      })\n  }\n  //\u901a\u8fc7url\u83b7\u53d6\u6587\u4ef6\u540d\n  function getFilename(url) {\n    var temp = url.split(\'/\')\n    return temp[temp.length - 1]\n  }\n  //\u5224\u65ad\u672c\u5730\u662f\u6709\u6709bundle\uff0c\u5e76\u8fd4\u56de\u6587\u4ef6\u540d\n  function hasBundle() {\n    return Object.keys(localStorage).find(item => item.includes(\'bundle\'))\n  }\n\n<\/script>\n\n</html>\n')))}u.isMDXComponent=!0}}]);