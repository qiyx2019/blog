"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5941],{3905:function(e,s,r){r.d(s,{Zo:function(){return u},kt:function(){return v}});var t=r(7294);function n(e,s,r){return s in e?Object.defineProperty(e,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[s]=r,e}function b(e,s){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);s&&(t=t.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),r.push.apply(r,t)}return r}function l(e){for(var s=1;s<arguments.length;s++){var r=null!=arguments[s]?arguments[s]:{};s%2?b(Object(r),!0).forEach((function(s){n(e,s,r[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))}))}return e}function a(e,s){if(null==e)return{};var r,t,n=function(e,s){if(null==e)return{};var r,t,n={},b=Object.keys(e);for(t=0;t<b.length;t++)r=b[t],s.indexOf(r)>=0||(n[r]=e[r]);return n}(e,s);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(t=0;t<b.length;t++)r=b[t],s.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var o=t.createContext({}),c=function(e){var s=t.useContext(o),r=s;return e&&(r="function"==typeof e?e(s):l(l({},s),e)),r},u=function(e){var s=c(e.components);return t.createElement(o.Provider,{value:s},e.children)},i={inlineCode:"code",wrapper:function(e){var s=e.children;return t.createElement(t.Fragment,{},s)}},p=t.forwardRef((function(e,s){var r=e.components,n=e.mdxType,b=e.originalType,o=e.parentName,u=a(e,["components","mdxType","originalType","parentName"]),p=c(r),v=n,d=p["".concat(o,".").concat(v)]||p[v]||i[v]||b;return r?t.createElement(d,l(l({ref:s},u),{},{components:r})):t.createElement(d,l({ref:s},u))}));function v(e,s){var r=arguments,n=s&&s.mdxType;if("string"==typeof e||n){var b=r.length,l=new Array(b);l[0]=p;var a={};for(var o in s)hasOwnProperty.call(s,o)&&(a[o]=s[o]);a.originalType=e,a.mdxType="string"==typeof e?e:n,l[1]=a;for(var c=2;c<b;c++)l[c]=r[c];return t.createElement.apply(null,l)}return t.createElement.apply(null,r)}p.displayName="MDXCreateElement"},4112:function(e,s,r){r.r(s),r.d(s,{contentTitle:function(){return o},default:function(){return p},frontMatter:function(){return a},metadata:function(){return c},toc:function(){return u}});var t=r(7462),n=r(3366),b=(r(7294),r(3905)),l=["components"],a={title:"Cold vs Hot Observables",sidebar_position:1},o=void 0,c={unversionedId:"rx/2019-07-12-rxjs-coldhot-observable",id:"rx/2019-07-12-rxjs-coldhot-observable",title:"Cold vs Hot Observables",description:"RxJS \u4e2d Observables \u5206\u4e3a\u4e24\u79cd\uff1aCold Observables \u548c Hot Observables\uff0c\u8fd9\u4e24\u4e2a\u5230\u5e95\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1f\u6211\u4eec\u5148\u6765\u770b\u4e0b\u3010RxJS\u5b98\u65b9\u3011\u7ed9\u51fa\u7684\u89e3\u91ca\uff1a",source:"@site/docs/rx/2019-07-12-rxjs-coldhot-observable.md",sourceDirName:"rx",slug:"/rx/2019-07-12-rxjs-coldhot-observable",permalink:"/blog/docs/rx/2019-07-12-rxjs-coldhot-observable",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Cold vs Hot Observables",sidebar_position:1},sidebar:"rx",previous:{title:"RxJS\u5165\u95e8\u548c\u6982\u89c8",permalink:"/blog/docs/rx/2019-07-05-rxjs-introduce"},next:{title:"\u56db\u79cd Subject \u7684\u7528\u6cd5\u548c\u533a\u522b",permalink:"/blog/docs/rx/2019-07-25-rxjs-subject"}},u=[{value:"Cold Observables",id:"cold-observables",children:[],level:2},{value:"Hot Observables",id:"hot-observables",children:[{value:"Cold Observables\u3000vs\u3000Hot Observables",id:"cold-observablesvshot-observables",children:[],level:3},{value:"\u90a3\u600e\u4e48\u521b\u5efa Hot Observables \u5462\uff1f",id:"\u90a3\u600e\u4e48\u521b\u5efa-hot-observables-\u5462",children:[],level:3}],level:2},{value:"connect vs refCount",id:"connect-vs-refcount",children:[],level:2},{value:"share",id:"share",children:[],level:2},{value:"shareReplay",id:"sharereplay",children:[],level:2},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",children:[],level:2}],i={toc:u};function p(e){var s=e.components,r=(0,n.Z)(e,l);return(0,b.kt)("wrapper",(0,t.Z)({},i,r,{components:s,mdxType:"MDXLayout"}),(0,b.kt)("p",null,"RxJS \u4e2d Observables \u5206\u4e3a\u4e24\u79cd\uff1aCold Observables \u548c Hot Observables\uff0c\u8fd9\u4e24\u4e2a\u5230\u5e95\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1f\u6211\u4eec\u5148\u6765\u770b\u4e0b\u3010",(0,b.kt)("a",{parentName:"p",href:"https://github.com/Reactive-Extensions/RxJS/blob/master/doc/gettingstarted/creating.md#cold-vs-hot-observables"},"RxJS\u5b98\u65b9"),"\u3011\u7ed9\u51fa\u7684\u89e3\u91ca\uff1a"),(0,b.kt)("blockquote",null,(0,b.kt)("p",null,"Cold observables start running upon subscription, i.e., the observable sequence only starts pushing values to the observers when Subscribe is called. (\u2026) This is different from hot observables such as mouse move events or stock tickers which are already producing values even before a subscription is active.")),(0,b.kt)("p",null,"\u7ffb\u8bd1\u8fc7\u6765\u5c31\u662f\uff1a"),(0,b.kt)("ul",null,(0,b.kt)("li",{parentName:"ul"},(0,b.kt)("p",{parentName:"li"},"Cold Observables \u53ea\u6709\u88ab observers \u8ba2\u9605\u7684\u65f6\u5019\uff0c\u624d\u4f1a\u5f00\u59cb\u4ea7\u751f\u503c\u3002\u662f\u5355\u64ad\u7684\uff0c\u6709\u591a\u5c11\u4e2a\u8ba2\u9605\u5c31\u4f1a\u751f\u6210\u591a\u5c11\u4e2a\u8ba2\u9605\u5b9e\u4f8b\uff0c\u6bcf\u4e2a\u8ba2\u9605\u90fd\u662f\u4ece\u7b2c\u4e00\u4e2a\u4ea7\u751f\u7684\u503c\u5f00\u59cb\u63a5\u6536\u503c\uff0c\u6240\u4ee5\u6bcf\u4e2a\u8ba2\u9605\u63a5\u6536\u5230\u7684\u503c\u90fd\u662f\u4e00\u6837\u7684\u3002")),(0,b.kt)("li",{parentName:"ul"},(0,b.kt)("p",{parentName:"li"},"Hot Observables \u4e0d\u7ba1\u6709\u6ca1\u6709\u88ab\u8ba2\u9605\u90fd\u4f1a\u4ea7\u751f\u503c\u3002\u662f\u591a\u64ad\u7684\uff0c\u591a\u4e2a\u8ba2\u9605\u5171\u4eab\u540c\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u662f\u4ece\u8ba2\u9605\u5f00\u59cb\u63a5\u53d7\u5230\u503c\uff0c\u6bcf\u4e2a\u8ba2\u9605\u63a5\u6536\u5230\u7684\u503c\u662f\u4e0d\u540c\u7684\uff0c\u53d6\u51b3\u4e8e\u5b83\u4eec\u662f\u4ece\u4ec0\u4e48\u65f6\u5019\u5f00\u59cb\u8ba2\u9605\u3002"))),(0,b.kt)("h2",{id:"cold-observables"},"Cold Observables"),(0,b.kt)("pre",null,(0,b.kt)("code",{parentName:"pre",className:"language-ts"},'let obs$ = from([1, 2, 3, 4, 5]);\n\nobs$.subscribe(data => { console.log("1st subscriber:" + data) });\nobs$.subscribe(data => { console.log("2nd subscriber:" + data) });\n')),(0,b.kt)("p",null,"\u628a\u4e00\u4e2a\u6570\u7ec4\u8f6c\u6362\u6210 observables\uff0c\u7136\u540e\u5206\u522b\u7528\u4e0d\u540c\u7684 Subscription \u8ba2\u9605\u5b83\uff0c\u5728 console \u91cc\u7ed3\u679c\u5982\u4e0b\uff1a"),(0,b.kt)("pre",null,(0,b.kt)("code",{parentName:"pre"},"1st subscriber:1\n1st subscriber:2\n1st subscriber:3\n1st subscriber:4\n1st subscriber:5\n2nd subscriber:1\n2nd subscriber:2\n2nd subscriber:3\n2nd subscriber:4\n2nd subscriber:5\n")),(0,b.kt)("p",null,"\u6211\u4eec\u628a\u4ee3\u7801\u6539\u4e00\u4e0b\uff0c\u8ba9\u7b2c\u4e8c\u4e2a Subscription \u5ef6\u8fdf1\u79d2\u8ba2\u9605\uff1a"),(0,b.kt)("pre",null,(0,b.kt)("code",{parentName:"pre",className:"language-ts"},'let obs$ = from([1, 2, 3, 4, 5]);\n\nobs$.subscribe(data => { console.log("1st subscriber:" + data) });\nsetTimeout(() => {\n    obs$.subscribe(data => { console.log("2nd subscriber:" + data) });\n}, 1100);\n')),(0,b.kt)("p",null,"\u7ed3\u679c\u8fd8\u662f\u8ddf\u4e0a\u9762\u4e00\u6837\uff0c\u6ca1\u6709\u4efb\u4f55\u533a\u522b\u3002\u8fd9\u4e2a\u662f Cold Observables\uff0c\u4e24\u4e2a\u8ba2\u9605\u5206\u522b\u6709\u4e24\u4e2a\u8ba2\u9605\u5b9e\u4f8b\uff0c\u662f\u5355\u64ad\u7684\uff0c\u5728\u6ca1\u6709\u5f00\u59cb\u8ba2\u9605\u4e4b\u524d\uff0cobs$ \u662f\u4e0d\u53d1\u9001\u503c\uff0c\u4e00\u65e6\u5f00\u59cb\u8ba2\u9605\uff0c\u4e0d\u7ba1\u662f\u4ece\u4ec0\u4e48\u65f6\u5019\u5f00\u59cb\uff0cobs$ \u90fd\u662f\u4ece\u7b2c\u4e00\u4e2a\u503c\u5f00\u59cb\u53d1\u9001\u503c\uff0c\u6240\u4ee5\u4e24\u4e2a\u8ba2\u9605\u63a5\u6536\u5230\u503c\u6ca1\u6709\u533a\u522b\u3002"),(0,b.kt)("h2",{id:"hot-observables"},"Hot Observables"),(0,b.kt)("p",null,"\u6211\u5148\u628a\u524d\u9762 Cold Observables \u6539\u6210 Hot Observables\uff0c\u4ee3\u7801\u5982\u4e0b\uff0c\u5148\u5ffd\u7565 publish\uff0cConnectableObservable\uff0cconnect\uff0c\u7a0d\u540e\u518d\u8be6\u7ec6\u89e3\u91ca\u3002"),(0,b.kt)("pre",null,(0,b.kt)("code",{parentName:"pre"},'let obs$ = from([1, 2, 3, 4, 5]).pipe(\n    publish()\n) as ConnectableObservable<any>;\nobs$.connect();\n\nobs$.subscribe(data => { console.log("1st subscriber:" + data) });\nsetTimeout(() => {\n    obs$.subscribe(data => { console.log("2st subscriber:" + data) });\n}, 2100);\n')),(0,b.kt)("p",null,"\u6839\u636e Hot Observables \u7684\u5b9a\u4e49\uff0c\u671f\u5f85\u7684\u6548\u679c\u662f\u7b2c\u4e00\u4e2a\u8ba2\u9605\u63a5\u6536\u52301\uff0c2\uff0c3\uff0c4\uff0c5\uff1b\u7b2c\u4e8c\u4e2a\u8ba2\u9605\u63a5\u6536\u52303\uff0c4\uff0c5\u3002\u5b9e\u9645\u4e0a\u4e24\u4e2a\u8ba2\u9605\u90fd\u6ca1\u6709\u63a5\u6536\u4efb\u4f55\u503c\uff01\u4ed4\u7ec6\u60f3\u60f3\u5176\u5b9e\u4e5f\u662f\u6b63\u5e38\u7684\uff0c\u56e0\u4e3a Hot Observables \u662f\u4e0d\u7ba1\u6709\u6ca1\u6709\u88ab\u8ba2\u9605\uff0c\u90fd\u4f1a\u53d1\u9001\u503c\uff0c\u6211\u4eec\u6570\u7ec4\u91cc\u6709\u4e94\u4e2a\u503c\uff0c\u7b49\u5230\u5f00\u59cb\u8ba2\u9605\u7684\u65f6\u5019\uff0c\u8fd9\u4e94\u4e2a\u503c\u90fd\u5df2\u7ecf\u53d1\u9001\u5b8c\u4e86\uff0c\u6240\u4ee5\u5728\u8ba2\u9605\u91cc\u63a5\u6536\u4e0d\u5230\u4efb\u4f55\u503c\u4e86\u3002"),(0,b.kt)("p",null,"\u4e3a\u4e86\u770b\u5230\u6548\u679c\uff0c\u6211\u4eec\u628a\u6570\u7ec4\u66ff\u6362\u6210 interval\uff0c\u6bcf\u9694\u4e00\u79d2\u5c31\u53d1\u9001\u4e00\u4e2a\u503c\uff0c\u7b2c\u4e00\u4e2a\u8ba2\u9605\u662f\u7b49\u4e86\u4e00\u79d2\u5f00\u59cb\u63a5\u53d7\u503c\uff0c\u7b2c\u4e8c\u4e2a\u8ba2\u9605\u662f\u7b49\u4e86\u4e24\u79d2\u5f00\u59cb\u63a5\u53d7\u503c\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,b.kt)("pre",null,(0,b.kt)("code",{parentName:"pre"},'let obs$ = interval(1000).pipe(\n    publish()\n) as ConnectableObservable<any>;\nobs$.connect();\nsetTimeout(() => {\n    obs$.subscribe(data => { console.log("1st subscriber:" + data) });\n    setTimeout(() => {\n        obs$.subscribe(data => { console.log("2st subscriber:" + data) });\n    }, 1100);\n}, 2100);\n')),(0,b.kt)("p",null,"\u6548\u679c\u662f\uff0c\u7b2c\u4e00\u4e2a\u8ba2\u9605\u4ece2\u5f00\u59cb\u63a5\u53d7\u503c\uff0c\u7b2c\u4e8c\u4e2a\u8ba2\u9605\u4ece3\u5f00\u59cb\u63a5\u53d7\u503c\uff1a"),(0,b.kt)("pre",null,(0,b.kt)("code",{parentName:"pre"},"1st subscriber:2\n1st subscriber:3\n2st subscriber:3\n1st subscriber:4\n2st subscriber:4\n1st subscriber:5\n2st subscriber:5\n1st subscriber:6\n2st subscriber:6\n\n......\n")),(0,b.kt)("h3",{id:"cold-observablesvshot-observables"},"Cold Observables\u3000vs\u3000Hot Observables"),(0,b.kt)("ul",null,(0,b.kt)("li",{parentName:"ul"},(0,b.kt)("p",{parentName:"li"},"\u6211\u4eec\u53ef\u4ee5\u628a Cold Observables \u7406\u89e3\u4e3a\u5728\u624b\u673a\u7f51\u6613\u4e91\u97f3\u4e50 APP \u4e0a\u542c\u6b4c\uff1aAPP \u91cc\u7684\u6b4c\u66f2\u8d44\u6e90\u662f Cold Observables\uff0c\u542c\u6b4c\u7684\u4eba\u662f observers\u3002\u5982\u679c\u6ca1\u6709\u4eba\u6253\u5f00 APP \u53bb\u64ad\u653e\u8fd9\u9996\u6b4c\uff0c\u8fd9\u9996\u6b4c\u4e0d\u4f1a\u81ea\u5df1\u64ad\u653e\u3002\u6bcf\u4e2a\u4eba\u4ece\u81ea\u5df1 APP \u6253\u5f00\u64ad\u653e\u8fd9\u9996\u6b4c\u7684\u65f6\u5019\uff0c\u5148\u628a\u6b4c\u66f2\u4ece\u7f51\u4e0a\u4e0b\u8f7d\u5230\u672c\u5730\uff0c\u6bcf\u4efd\u90fd\u662f\u5355\u72ec\u7684\u6b4c\u66f2\u5b9e\u4f8b\uff0c\u90fd\u662f\u4ece\u5934\u5f00\u59cb\u542c\uff0c\u4e92\u76f8\u4e0d\u4f1a\u5f71\u54cd\u3002")),(0,b.kt)("li",{parentName:"ul"},(0,b.kt)("p",{parentName:"li"},"\u800c Hot Observables \u53ef\u4ee5\u7406\u89e3\u4e3a\u6f14\u5531\u4f1a\uff1a\u6bd4\u5982\u6211\u4eec\u53bb\u770b\u4e00\u573a\u6f14\u5531\u4f1a\uff0c\u6ca1\u6709\u8fdf\u5230\u7684\u5c0f\u4f19\u4f34\uff08A\uff09\u53ef\u4ee5\u4ece\u7b2c\u4e00\u9996\u6b4c\u5f00\u59cb\u542c\uff0c\u8fdf\u5230\u7684\u5c0f\u4f19\u4f34\u5c31\uff08B\uff09\u53ea\u80fd\u4ece\u7b2c\u4e8c\u9996\u6216\u8005\u66f4\u665a\u7684\u6b4c\u5f00\u59cb\u542c\uff1b\u6f14\u5531\u4f1a\u5c31\u662f Hot Observables\uff0c\u5c0f\u4f19\u4f34 A \u548c B \u5c31\u662f observers\u3002\u5c0f\u4f19\u4f34 A \u548c B \u5171\u4eab\u540c\u4e00\u4e2a\u6f14\u5531\u4f1a\u5b9e\u4f8b\uff0c\u662f\u4ece\u8ba2\u9605\u5f00\u59cb\u63a5\u53d7\u5230\u503c\uff0c\u6bcf\u4e2a\u8ba2\u9605\u63a5\u6536\u5230\u7684\u503c\u662f\u4e0d\u540c\u7684\uff0c\u53d6\u51b3\u4e8e\u5b83\u4eec\u662f\u4ece\u4ec0\u4e48\u65f6\u5019\u5f00\u59cb\u8ba2\u9605\u3002"))),(0,b.kt)("h3",{id:"\u90a3\u600e\u4e48\u521b\u5efa-hot-observables-\u5462"},"\u90a3\u600e\u4e48\u521b\u5efa Hot Observables \u5462\uff1f"),(0,b.kt)("p",null,"\u5728\u4e0a\u9762\u7684 Hot Observables \u4ee3\u7801\u91cc\uff0c\u7528\u5230\u4e86 publish \u64cd\u4f5c\u7b26\uff0cConnectableObservable\uff0c\u4ee5\u53ca connect() \u65b9\u6cd5\u521b\u5efa Hot Observables\uff1b\u6211\u4eec\u6765\u770b\u4e0b\u5b83\u4eec\u5230\u5e95\u662f\u4ec0\u4e48\u610f\u601d\u3002"),(0,b.kt)("blockquote",null,(0,b.kt)("p",null,(0,b.kt)("strong",null,"publish\uff1a"),"\u8fd9\u4e2a\u64cd\u4f5c\u7b26\u628a\u6b63\u5e38\u7684 Observable\uff08Cold Observables \uff09\u8f6c\u6362\u6210 ConnectableObservable\u3002"),(0,b.kt)("p",null,(0,b.kt)("strong",null,"ConnectableObservable\uff1a"),"ConnectableObservable \u662f\u591a\u64ad\u7684\u5171\u4eab Observable\uff0c\u53ef\u4ee5\u540c\u65f6\u88ab\u591a\u4e2a observers\u5171\u4eab\u8ba2\u9605\uff0c\u5b83\u662f Hot Observables\u3002ConnectableObservable \u662f\u8ba2\u9605\u8005\u548c\u771f\u6b63\u7684\u6e90\u5934 Observables\uff08\u4e0a\u9762\u4f8b\u5b50\u4e2d\u7684 interval\uff0c\u6bcf\u9694\u4e00\u79d2\u53d1\u9001\u4e00\u4e2a\u503c\uff0c\u5c31\u662f\u6e90\u5934 Observables\uff09\u7684\u4e2d\u95f4\u4eba\uff0cConnectableObservable \u4ece\u6e90\u5934 Observables \u63a5\u6536\u5230\u503c\u7136\u540e\u518d\u628a\u503c\u8f6c\u53d1\u7ed9\u8ba2\u9605\u8005\u3002"),(0,b.kt)("p",null,(0,b.kt)("strong",null,"connect()\uff1a"),"ConnectableObservable \u5e76\u4e0d\u4f1a\u4e3b\u52a8\u53d1\u9001\u503c\uff0c\u5b83\u6709\u4e2a connect \u65b9\u6cd5\uff0c\u901a\u8fc7\u8c03\u7528 connect \u65b9\u6cd5\uff0c\u53ef\u4ee5\u542f\u52a8\u5171\u4eab ConnectableObservable \u53d1\u9001\u503c\u3002\u5f53\u6211\u4eec\u8c03\u7528 ConnectableObservable.prototype.connect \u65b9\u6cd5\uff0c\u4e0d\u7ba1\u6709\u6ca1\u6709\u88ab\u8ba2\u9605\uff0c\u90fd\u4f1a\u53d1\u9001\u503c\u3002\u8ba2\u9605\u8005\u5171\u4eab\u540c\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u8ba2\u9605\u8005\u63a5\u6536\u5230\u7684\u503c\u53d6\u51b3\u4e8e\u5b83\u4eec\u4f55\u65f6\u5f00\u59cb\u8ba2\u9605\u3002\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u8ba2\u9605\u7b49\u4e86\u4e00\u79d2\u4ece2\u5f00\u59cb\u63a5\u53d7\u503c\uff0c\u7b2c\u4e8c\u4e2a\u8ba2\u9605\u7b49\u4e86\u4e24\u79d2\u4ece3\u5f00\u59cb\u63a5\u53d7\u503c\u3002")),(0,b.kt)("h2",{id:"connect-vs-refcount"},"connect vs refCount"),(0,b.kt)("p",null,"\u9664\u4e86 connect\uff0c\u8fd8\u6709\u4e00\u4e2a refCount \u65b9\u6cd5\uff0c\u5728\u6bd4\u8f83\u8fd9\u4e24\u4e2a\u533a\u522b\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6765\u770b\u4e0b refCount \u7684\u7528\u6cd5\u548c\u6548\u679c\uff1a"),(0,b.kt)("pre",null,(0,b.kt)("code",{parentName:"pre",className:"language-ts"},'let obs$ = interval(1000).pipe(\n    publish(),\n    refCount()\n)\n\nsetTimeout(() => {\n    obs$.subscribe(data => { console.log("1st subscriber:" + data) });\n    setTimeout(() => {\n        obs$.subscribe(data => { console.log("2st subscriber:" + data) });\n\n    }, 1100);\n\n}, 2000);\n')),(0,b.kt)("p",null,"\u6309\u4e4b\u95f4\u5bf9 publish \u4f1a\u751f\u6210\u4e00\u4e2a ConnectableObservable\uff0c\u5b83\u662f\u4e00\u4e2a Hot Observables\uff0c\u90a3\u4e48\u9884\u671f\u7ed3\u679c\u662f\uff1a\u7b2c\u4e00\u4e2a\u8ba2\u9605\u8005\u662f\u4ece2\u5f00\u59cb\u63a5\u6536\u503c\uff0c\u7b2c\u4e8c\u4e2a\u8ba2\u9605\u8005\u662f\u4ece3\u5f00\u59cb\u63a5\u53d7\u503c\uff1f"),(0,b.kt)("p",null,"\u6211\u4eec\u6765\u770b\u4e0b\u5b9e\u9645\u6548\u679c\uff1a"),(0,b.kt)("pre",null,(0,b.kt)("code",{parentName:"pre"},"1st subscriber:0\n1st subscriber:1\n2st subscriber:1\n1st subscriber:2\n2st subscriber:2\n1st subscriber:3\n2st subscriber:3\n1st subscriber:4\n2st subscriber:4\n1st subscriber:5\n2st subscriber:5\n\n......\n")),(0,b.kt)("p",null,"\u8ddf\u9884\u60f3\u7684\u4e0d\u4e00\u6837\uff0c\u7b2c\u4e00\u4e2a\u8ba2\u9605\u8005\u4ece0\u5f00\u59cb\u63a5\u6536\u503c\uff0c\u7b2c\u4e8c\u4e2a\u8ba2\u9605\u8005\u6bd4\u7b2c\u4e00\u4e2a\u8ba2\u9605\u8005\u665a\u4e86\u4e00\u79d2\uff0c\u4ece1\u5f00\u59cb\u63a5\u53d7\u503c\u3002"),(0,b.kt)("p",null,"\u5f53\u4f7f\u7528 refCount\uff0c\u662f\u5f15\u7528\u8ba1\u6570\u7684 observable\u3002\u5b83\u8868\u793a\u5f53\u7b2c\u4e00\u4e2a\u8ba2\u9605\u8005\u5f00\u59cb\u8ba2\u9605\u7684\u65f6\u5019\uff0c\u5f00\u59cb\u53d1\u9001\u548c\u4ea7\u751f\u503c\uff1b\u7b2c\u4e8c\u4e2a\u8ba2\u9605\u8005\uff08\u4e4b\u540e\u7684\u8ba2\u9605\u8005\uff09\u5171\u4eab\u7b2c\u4e00\u4e2a\u8ba2\u9605\u8005\u7684 Observables \u5b9e\u4f8b\uff0c\u6ca1\u6709\u8ba2\u9605\u8005\u7684\u65f6\u5019\uff0c\u4f1a\u81ea\u52a8\u53d6\u6d88\u8ba2\u9605\uff1b\u4e4b\u540e\u518d\u91cd\u65b0\u8ba2\u9605\uff0c\u53c8\u4ece\u5934\u5f00\u59cb\u53d1\u9001\u503c\u3002"),(0,b.kt)("p",null,"\u5b83\u4e0d\u662f Hot Observables \u4e5f\u4e0d\u662f Cold Observables\uff0c\u56e0\u4e3a\u5b83\u662f\u4ece\u6709\u7b2c\u4e00\u4e2a\u8ba2\u9605\u8005\u7684\u65f6\u5019\u624d\u5f00\u59cb\u53d1\u9001\u503c\uff0c\u6ca1\u6709\u8ba2\u9605\u8005\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u53d6\u6d88\u8ba2\u9605\uff0c\u800c\u4e14\u4e4b\u540e\u7684\u8ba2\u9605\u8005\u5171\u4eab\u7b2c\u4e00\u4e2a\u8ba2\u9605\u8005\u7684 Observables \u5b9e\u4f8b\u3002\u5b83\u662f\u57fa\u4e8e Hot Observables \u4e0e Cold Observables \u4e4b\u95f4\u7684 Observables\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a Warm Observables\u3002"),(0,b.kt)("h2",{id:"share"},"share"),(0,b.kt)("p",null,"publish \u548c refCount \u53ef\u4ee5\u751f\u6210\u4e00\u4e2a Warm Observables\uff0c\u5b9e\u9645\u5355\u72ec\u4f7f\u7528 share \u64cd\u4f5c\u7b26\u53ef\u4ee5\u8fbe\u5230\u540c\u6837\u7684\u6548\u679c\uff0cshare \u5b9e\u9645\u5c31\u662f publish().refCount() \u7684\u7b80\u5199\uff0c\u8fd9\u6b21\u628a\u7b2c\u4e8c\u4e2a\u8ba2\u9605\u6bd4\u7b2c\u4e00\u4e2a\u8ba2\u9605\u665a\u4e94\u79d2\u518d\u5f00\u59cb\u8ba2\u9605\uff0c\u5177\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,b.kt)("pre",null,(0,b.kt)("code",{parentName:"pre",className:"language-ts"},'let obs$ = interval(1000).pipe(\n    share()\n)\n\nsetTimeout(() => {\n    obs$.subscribe(data => { console.log("1st subscriber:" + data) });\n    setTimeout(() => {\n        obs$.subscribe(data => { console.log("2st subscriber:" + data) });\n\n    }, 5100);\n\n}, 2000);\n')),(0,b.kt)("p",null,"\u8f93\u51fa\u7ed3\u679c\uff1a"),(0,b.kt)("pre",null,(0,b.kt)("code",{parentName:"pre"},"1st subscriber:0\n1st subscriber:1\n1st subscriber:2\n1st subscriber:3\n1st subscriber:4\n1st subscriber:5\n2st subscriber:5\n1st subscriber:6\n2st subscriber:6\n1st subscriber:7\n2st subscriber:7\n\n......\n")),(0,b.kt)("p",null,"\u548c\u4f7f\u7528 publish().refCount() \u6548\u679c\u5b8c\u5168\u4e00\u6837\u3002"),(0,b.kt)("h2",{id:"sharereplay"},"shareReplay"),(0,b.kt)("p",null,"\u5728\u7528 share() \u7684\u65f6\u5019\uff0c\u7b2c\u4e8c\u4e2a\u6216\u8005\u66f4\u540e\u9762\u7684\u8ba2\u9605\u8005\u5f00\u59cb\u8ba2\u9605\u7684\u65f6\u5019\uff0c\u90fd\u662f\u5171\u4eab\u7b2c\u4e00\u8ba2\u9605\u8005\u7684 Observables\uff0c\u6bd4\u5982\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u7b2c\u4e8c\u4e2a\u8ba2\u9605\u6bd4\u7b2c\u4e00\u4e2a\u8ba2\u9605\u665a\u4e94\u79d2\u518d\u5f00\u59cb\u8ba2\u9605\uff0c\u90a3\u4e48\u7b2c\u4e8c\u4e2a\u8ba2\u9605\u8005\u4ece5\u5f00\u59cb\u63a5\u6536\u503c\u3002\u4f46\u662f\u5b9e\u9645\u60c5\u51b5\u4e2d\uff0c\u5982\u679c\u6211\u60f3\u8ba9\u7b2c\u4e8c\u4e2a\u8ba2\u9605\u8005\u4e5f\u80fd\u62ff\u5230\u524d\u9762\u7684\u503c\uff0c\u90a3\u600e\u4e48\u529e\u5462\uff1f\u7528 shareReplay() \u53ef\u4ee5\u5b9e\u73b0\u3002\u5177\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a"),(0,b.kt)("pre",null,(0,b.kt)("code",{parentName:"pre",className:"language-ts"},'let obs$ = interval(1000).pipe(\n    shareReplay(1)\n)\n\nsetTimeout(() => {\n    obs$.subscribe(data => { console.log("1st subscriber:" + data) });\n    setTimeout(() => {\n        obs$.subscribe(data => { console.log("2st subscriber:" + data) });\n\n    }, 5100);\n\n}, 2000);\n')),(0,b.kt)("p",null,"\u8f93\u51fa\u7ed3\u679c\uff1a"),(0,b.kt)("pre",null,(0,b.kt)("code",{parentName:"pre"},"1st subscriber:0\n1st subscriber:1\n1st subscriber:2\n1st subscriber:3\n1st subscriber:4\n2st subscriber:4\n1st subscriber:5\n2st subscriber:5\n1st subscriber:6\n2st subscriber:6\n1st subscriber:7\n2st subscriber:7\n\n......\n")),(0,b.kt)("p",null," shareReplay(1) \u4e2d\u76841\u8868\u793a\u62ff\u5230\u9519\u8fc7\u7684\u524d\u4e00\u4e2a\u503c\uff0c\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u5c31\u662f\u7b2c\u4e8c\u4e2a\u8ba2\u9605\u4ece4\u5f00\u59cb\u63a5\u53d7\u503c\u3002\u5982\u679c\u6539\u6210 shareReplay(2 )\u5c31\u8868\u793a\u4ece\u9519\u8fc7\u7684\u524d\u4e24\u4e2a\u503c\u5f00\u59cb\u63a5\u53d7\u503c\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e8c\u4e2a\u8ba2\u9605\u4f1a\u4ece3\u5f00\u59cb\u63a5\u53d7\u503c\u3002"),(0,b.kt)("p",null," shareReplay(1) \u5176\u5b9e\u4e5f\u662f",(0,b.kt)("inlineCode",{parentName:"p"},"publishReplay(1).refCount()"),"\u7684\u7b80\u5199\uff0c\u7528",(0,b.kt)("inlineCode",{parentName:"p"},"publishReplay(1).refCount()"),"\u6709\u540c\u6837\u7684\u6548\u679c\u3002"),(0,b.kt)("h2",{id:"\u603b\u7ed3"},"\u603b\u7ed3"),(0,b.kt)("p",null," \u5728\u8fd9\u7bc7\u6587\u7ae0\u4e2d\uff0c\u6211\u4eec\u4ecb\u7ecd\u4e86\uff1a"),(0,b.kt)("ul",null,(0,b.kt)("li",{parentName:"ul"},"\u4ec0\u4e48\u662f Cold Observables \u548c Hot Observables\uff0c\u4ee5\u53ca\u4e24\u8005\u7684\u533a\u522b"),(0,b.kt)("li",{parentName:"ul"},"\u600e\u4e48\u521b\u5efa Hot Observables"),(0,b.kt)("li",{parentName:"ul"},"\u4ec0\u4e48\u662f Warm Observables\uff0c\u4ee5\u53ca\u600e\u4e48\u7528 shareReplay() \u53bb\u62ff\u5230\u8ba2\u9605\u8005\u9519\u8fc7\u7684\u503c")))}p.isMDXComponent=!0}}]);